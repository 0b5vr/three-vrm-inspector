var Ge=Object.defineProperty,Fe=Object.defineProperties;var Oe=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable;var se=(o,e,t)=>e in o?Ge(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,w=(o,e)=>{for(var t in e||(e={}))je.call(e,t)&&se(o,t,e[t]);if(he)for(var t of he(e))We.call(e,t)&&se(o,t,e[t]);return o},v=(o,e)=>Fe(o,Oe(e));var g=(o,e,t)=>(se(o,typeof e!="symbol"?e+"":e,t),t);import{C as me,M as re,S as Ze,a as Ye,b as ue,V as F,Q as O,F as Ke,A as pe,c as ge,d as fe,e as Je,f as Ee,G as X,g as xe,T as Be,h as Xe,R as qe,i as be,j as $e,E as et,O as tt,U as nt,k as ot,l as st,m as Ce,P as rt,n as it,D as At,o as at,p as lt,q as ct,r as dt,s as ht,t as mt,u as ut,v as pt,w as q,x as gt,y as ft,W as Et,z as xt,B as Bt,H as bt,I as Ct,J as wt,K as vt,L as Rt,N as $,X as we,Y as Mt,Z as s,_ as c,$ as M,a0 as I,a1 as z,a2 as yt,a3 as It}from"./vendor.30a142bb.js";const Pt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const A of i.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&n(A)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};Pt();const j={black:"#000000",white:"#ffffff",back1:"#191a1f",fore:"#d0edff",titleBarBg:"#30343b",accent:"#ff0066",gray:"#75848f",uiBackground:"rgba( 25, 26, 31, 0.8 )",error:"#ff0066",warning:"#f7f025",severityInfo:"#53c5ff",constant:"#ff0066",number:"#8a8aff",string:"#f7f025"},kt=new me(j.constant),Qt=new re({color:kt,transparent:!0,wireframe:!0,depthTest:!1,depthWrite:!1}),Lt=new Ze(.2);function ve(o=Lt){const e=new Ye(o,Qt);return e.frustumCulled=!1,e.renderOrder=1e4,e}function zt(o,e,t){const r=o.parser.json.nodes[e].mesh;if(r==null)return null;const A=o.parser.json.meshes[r].primitives.length,a=[];return t.traverse(l=>{a.length<A&&l.isMesh&&a.push(l)}),a}async function ee(o,e){const t=await o.parser.getDependency("node",e);return zt(o,e,t)}const _t=new ue({transparent:!0,depthTest:!1,depthWrite:!1});function W(o,e=_t){const t=new Map;return o.forEach(n=>{Array.isArray(n.material)&&(t.set(n,n.material[0]),n.material[0]=e)}),()=>{for(const[n,r]of t)n.material[0]=r}}function ie(o){const e=new Map;return o.forEach(t=>{const n=ve();t.add(n),e.set(t,n)}),()=>{o.forEach(t=>{const n=e.get(t);t.remove(n)})}}class St extends ue{constructor(e){super(e);g(this,"_skinIndexVisualize");g(this,"_uniforms");this._skinIndexVisualize=0,this.onBeforeCompile=t=>{this._uniforms=t.uniforms,this._uniforms.skinIndexVisualize={value:this._skinIndexVisualize},t.vertexShader=t.vertexShader.replace("#include <common>",`#include <common>

        varying float vWeightVisualize;
        uniform float skinIndexVisualize;`),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`#ifdef USE_SKINNING
          vWeightVisualize = (
            skinIndex.x == skinIndexVisualize ? skinWeight.x : 0.0 +
            skinIndex.y == skinIndexVisualize ? skinWeight.y : 0.0 +
            skinIndex.z == skinIndexVisualize ? skinWeight.z : 0.0 +
            skinIndex.w == skinIndexVisualize ? skinWeight.w : 0.0
          );
        #else
          vWeightVisualize = 0.0;
        #endif

        #include <begin_vertex>`),t.fragmentShader=t.fragmentShader.replace("#include <packing>",`#include <packing>

        varying float vWeightVisualize;`),t.fragmentShader=t.fragmentShader.replace("gl_FragColor = vec4( packNormalToRGB( normal ), opacity );",`gl_FragColor = vec4(
          clamp( 2.0 - abs( vec3( 4.0, 2.0, 0.0 ) - 4.0 * vWeightVisualize ), 0.0, 1.0 ),
          opacity
        );`)}}get skinIndexVisualize(){return this._skinIndexVisualize}set skinIndexVisualize(e){this._uniforms&&(this._uniforms.skinIndexVisualize={value:e}),this._skinIndexVisualize=e}}const Re=new St({transparent:!0,depthTest:!1,depthWrite:!1}),Ht=new me(j.constant);class Dt{constructor(e){g(this,"_inspector");this._inspector=e}highlight(e){const t=this._inspector,n=e.split("/"),r=t.model.gltf,i=r.parser,A=i.json;if(n.length===3&&n[1]==="nodes"){const a=parseInt(n.pop());let l;return i.getDependency("node",a).then(h=>{l=ie([h])}),()=>{l&&l()}}else if(n.length===3&&n[1]==="meshes"){const a=parseInt(n.pop());let l;const h=A.nodes,m=[];return h==null||h.forEach((d,f)=>{d.mesh===a&&m.push(f)}),Promise.all(m.map(d=>ee(r,d))).then(d=>d.flat()).then(d=>{l=W(d)}),()=>{l&&l()}}else if(n.length===5&&n[1]==="meshes"&&n[3]==="primitives"){const a=parseInt(n[2]),l=parseInt(n[4]);let h;return i.getDependency("mesh",a).then(m=>{m.children.length!==0&&(m=m.children[l]),h=W([m])}),()=>{h&&h()}}else if(n.length===7&&n[1]==="meshes"&&n[3]==="primitives"&&n[5]==="targets"){const a=parseInt(n[2]),l=parseInt(n[4]),h=parseInt(n[6]);let m;return i.getDependency("mesh",a).then(u=>{u.children.length!==0&&(u=u.children[l]);const d=u;d.morphTargetInfluences&&(d.morphTargetInfluences[h]=1),m=()=>{d.morphTargetInfluences&&(d.morphTargetInfluences[h]=0)}}),()=>{m&&m()}}else if(n.length===6&&n[1]==="meshes"&&n[3]==="extras"&&n[4]==="targetNames"){const a=parseInt(n[2]),l=parseInt(n[5]);let h;const m=A.nodes,u=[];return m==null||m.forEach((f,E)=>{f.mesh===a&&u.push(E)}),Promise.all(u.map(f=>ee(r,f))).then(f=>f.flat()).then(f=>{f.forEach(E=>{E.morphTargetInfluences&&(E.morphTargetInfluences[l]=1)}),h=()=>{f.forEach(E=>{E.morphTargetInfluences&&(E.morphTargetInfluences[l]=0)})}}),()=>{h&&h()}}else if(n.length===3&&n[1]==="skins"){const a=parseInt(n[2]);let l;const h=A.nodes,m=[];return h==null||h.forEach((d,f)=>{d.skin===a&&m.push(f)}),Promise.all(m.map(d=>ee(r,d))).then(d=>d.flat()).then(d=>{l=W(d)}),()=>{l&&l()}}else if(n.length===5&&n[1]==="skins"&&n[3]==="joints"){const a=parseInt(n[2]),l=parseInt(n[4]),h=[],m=A.skins[a].joints[l];i.getDependency("node",m).then(E=>{h.push(ie([E]))});const u=A.nodes,d=[];return u==null||u.forEach((E,B)=>{E.skin===a&&d.push(B)}),Promise.all(d.map(E=>ee(r,E))).then(E=>E.flat()).then(E=>{h.push(W(E,Re)),Re.skinIndexVisualize=l}),()=>{h.forEach(E=>E())}}else if(n.length===3&&n[1]==="materials"||n.length===5&&n[2]==="VRM"&&n[3]==="materialProperties"){const a=parseInt(n.pop());let l;return i.getDependencies("mesh").then(h=>{const m=[];A.meshes.forEach((u,d)=>{u.primitives.forEach((E,B)=>{if(a===E.material){let x=h[d];x.children.length!==0&&(x=x.children[B]);const b=x;m.push(b)}})}),l=W(m)}),()=>{l&&l()}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="humanoid"&&n[4]==="humanBones"){const a=parseInt(e.split("/").pop()),h=A.extensions.VRM.humanoid.humanBones[a].bone,m=t.model.vrm.humanoid.getBoneNode(h);return ie([m])}else if(n.length===4&&n[2]==="VRM"&&n[3]==="firstPerson"){const a=ve();return t.model.vrm.lookAt.getLookAtWorldPosition(a.position),t.scene.add(a),()=>{t.scene.remove(a)}}else{if(n.length===5&&n[2]==="VRM"&&n[3]==="firstPerson"&&n[4]==="meshAnnotations")return t.layerMode="firstPerson",()=>{t.layerMode="thirdPerson"};if(n.length===6&&n[2]==="VRM"&&n[3]==="blendShapeMaster"&&n[4]==="blendShapeGroups"){const a=parseInt(e.split("/").pop()),m=A.extensions.VRM.blendShapeMaster.blendShapeGroups[a].name,u=t.model.vrm.expressionManager.getValue(m);return t.model.vrm.expressionManager.setValue(m,1),()=>{t.model.vrm.expressionManager.setValue(m,u)}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="secondaryAnimation"&&n[4]==="boneGroups"){const a=parseInt(e.split("/").pop()),h=A.extensions.VRM.secondaryAnimation,m=h==null?void 0:h.boneGroups[a].bones,u=t.model.vrm.springBoneManager,d=new Map;for(const b of u.springBones)d.set(b.bone,b);const f=t.helpersPlugin.springBoneJointHelperRoot,E=new Map;f.children.forEach(b=>{const y=b;E.set(y.springBone,y)});const B=[],x=new Set;return m.forEach(b=>{i.getDependency("node",b).then(y=>{y.traverse(C=>{const R=d.get(C),k=E.get(R);x.add(k);const _=k.children[0].material,S=_.color.clone();_.color.copy(Ht),B.push(()=>{_.color.copy(S)})})})}),()=>{B.forEach(b=>b())}}}}}class Tt{constructor(){g(this,"_eventListeners")}on(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n)),n.push(t)}off(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n));const r=n.indexOf(t);r!==-1&&n.splice(r,1)}_emit(...[e,t]){var n;this._eventListeners=this._eventListeners||new Map,(n=this._eventListeners.get(e))==null||n.forEach(r=>r(t))}}function Me(o,e){const t=[];let n=[],r=0;return Array.from(o).forEach(i=>{r<=0&&(r=e,n=[],t.push(n)),n.push(i),r--}),t}const Ut=new F,Nt=new O;function Vt(o){const e=o.humanoid;if(e==null)return null;const t=e.getPose(),n={};return Object.entries(e.humanBones).map(([r,i])=>{if(i!=null){const A=i.node;n[r]={position:A.getWorldPosition(Ut).toArray(),rotation:A.getWorldQuaternion(Nt).toArray()}}}),e.setPose(t),n}const Gt={mixamorigHips:"hips",mixamorigSpine:"spine",mixamorigSpine1:"chest",mixamorigSpine2:"upperChest",mixamorigNeck:"neck",mixamorigHead:"head",mixamorigLeftShoulder:"leftShoulder",mixamorigLeftArm:"leftUpperArm",mixamorigLeftForeArm:"leftLowerArm",mixamorigLeftHand:"leftHand",mixamorigLeftHandThumb1:"leftThumbProximal",mixamorigLeftHandThumb2:"leftThumbIntermediate",mixamorigLeftHandThumb3:"leftThumbDistal",mixamorigLeftHandIndex1:"leftIndexProximal",mixamorigLeftHandIndex2:"leftIndexIntermediate",mixamorigLeftHandIndex3:"leftIndexDistal",mixamorigLeftHandMiddle1:"leftMiddleProximal",mixamorigLeftHandMiddle2:"leftMiddleIntermediate",mixamorigLeftHandMiddle3:"leftMiddleDistal",mixamorigLeftHandRing1:"leftRingProximal",mixamorigLeftHandRing2:"leftRingIntermediate",mixamorigLeftHandRing3:"leftRingDistal",mixamorigLeftHandPinky1:"leftLittleProximal",mixamorigLeftHandPinky2:"leftLittleIntermediate",mixamorigLeftHandPinky3:"leftLittleDistal",mixamorigRightShoulder:"rightShoulder",mixamorigRightArm:"rightUpperArm",mixamorigRightForeArm:"rightLowerArm",mixamorigRightHand:"rightHand",mixamorigRightHandPinky1:"rightLittleProximal",mixamorigRightHandPinky2:"rightLittleIntermediate",mixamorigRightHandPinky3:"rightLittleDistal",mixamorigRightHandRing1:"rightRingProximal",mixamorigRightHandRing2:"rightRingIntermediate",mixamorigRightHandRing3:"rightRingDistal",mixamorigRightHandMiddle1:"rightMiddleProximal",mixamorigRightHandMiddle2:"rightMiddleIntermediate",mixamorigRightHandMiddle3:"rightMiddleDistal",mixamorigRightHandIndex1:"rightIndexProximal",mixamorigRightHandIndex2:"rightIndexIntermediate",mixamorigRightHandIndex3:"rightIndexDistal",mixamorigRightHandThumb1:"rightThumbProximal",mixamorigRightHandThumb2:"rightThumbIntermediate",mixamorigRightHandThumb3:"rightThumbDistal",mixamorigLeftUpLeg:"leftUpperLeg",mixamorigLeftLeg:"leftLowerLeg",mixamorigLeftFoot:"leftFoot",mixamorigLeftToeBase:"leftToes",mixamorigRightUpLeg:"rightUpperLeg",mixamorigRightLeg:"rightLowerLeg",mixamorigRightFoot:"rightFoot",mixamorigRightToeBase:"rightToes"},Ft=new O,Ot=new O,jt=new O,Wt=new O,Zt=new F,Yt=new F;async function Kt(o,e){const t=e.humanoid;if(t==null)return null;const r=await new Ke().loadAsync(o),i=pe.findByName(r.animations,"mixamo.com"),A=[],a=Vt(e);return i.tracks.forEach(l=>{var d,f,E,B;const h=l.name.split("."),m=h[0],u=Gt[m];if(u!=null){const x=t.restPose[u],b=a==null?void 0:a[u],y=(d=t.getBoneNode(u))==null?void 0:d.name;if(y!=null){const C=h[1],R=(f=x==null?void 0:x.position)!=null?f:[0,0,0],k=Zt.fromArray(R);let T=.01;u==="hips"&&(T*=k.length(),k.multiplyScalar(0));const _=(E=x==null?void 0:x.rotation)!=null?E:[0,0,0,1],S=Ft.fromArray(_),J=(B=b==null?void 0:b.rotation)!=null?B:[0,0,0,1],V=Ot.fromArray(J).multiply(S),G=jt.copy(V).invert();l instanceof ge?A.push(new ge(`${y}.${C}`,l.times,Me(l.values,4).flatMap(U=>Wt.fromArray(U).multiply(V).premultiply(G).multiply(S).toArray()))):l instanceof fe&&A.push(new fe(`${y}.${C}`,l.times,Me(l.values,3).flatMap(U=>Yt.fromArray(U).applyQuaternion(G).multiplyScalar(T).add(k).toArray())))}}}),new pe("vrmAnimation",i.duration,A)}class Jt{constructor(e){g(this,"inspector");g(this,"_currentAnimationMixer");g(this,"_currentAnimationAction");g(this,"_currentAnimationURL");this.inspector=e}handleAfterLoad(e){const t=e.vrm;t!=null&&(this._currentAnimationMixer=new Je(t.scene),this._currentAnimationURL!=null&&this.loadMixamoAnimation(this._currentAnimationURL))}handleAfterUnload(){this._currentAnimationAction=null,this._currentAnimationMixer=null}handleBeforeRender(e){this._currentAnimationMixer!=null&&this._currentAnimationMixer.update(e)}loadMixamoAnimation(e){var r;const t=(r=this.inspector.model)==null?void 0:r.vrm;if(!t)return;const n=this._currentAnimationMixer;!n||(this._currentAnimationAction!=null&&this.clearMixamoAnimation(),Kt(e,t).then(i=>{i&&(this._currentAnimationURL=e,this._currentAnimationAction=n.clipAction(i),this._currentAnimationAction.play())}))}clearMixamoAnimation(){var n,r;const e=(n=this.inspector.model)==null?void 0:n.vrm;if(!e)return;const t=this._currentAnimationAction;!t||(this._currentAnimationURL=null,t.stop(),this._currentAnimationAction=null,(r=e.humanoid)==null||r.resetPose())}}class Xt{constructor(e){g(this,"inspector");g(this,"_controls");this.inspector=e}get controls(){return this._controls}handleAfterSetup(){const{camera:e,canvas:t}=this.inspector;this._controls=new Ee(e,t),this._controls.setTarget(0,1,0)}handleBeforeRender(e){this._controls&&this._controls.update(e)}}class qt{constructor(e){g(this,"inspector");g(this,"humanoidHelperRoot");g(this,"lookAtHelperRoot");g(this,"springBoneJointHelperRoot");g(this,"springBoneColliderHelperRoot");this.inspector=e,this.humanoidHelperRoot=new X,this.humanoidHelperRoot.renderOrder=1e4,e.scene.add(this.humanoidHelperRoot),this.lookAtHelperRoot=new X,this.lookAtHelperRoot.renderOrder=1e4,e.scene.add(this.lookAtHelperRoot),this.springBoneJointHelperRoot=new X,this.springBoneJointHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneJointHelperRoot),this.springBoneColliderHelperRoot=new X,this.springBoneColliderHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneColliderHelperRoot)}handleAfterUnload(){this.humanoidHelperRoot.children.concat().forEach(e=>{this.humanoidHelperRoot.remove(e),e.dispose()}),this.springBoneJointHelperRoot.children.concat().forEach(e=>{this.springBoneJointHelperRoot.remove(e),e.dispose()}),this.springBoneColliderHelperRoot.children.concat().forEach(e=>{this.springBoneColliderHelperRoot.remove(e),e.dispose()}),this.lookAtHelperRoot.children.concat().forEach(e=>{this.lookAtHelperRoot.remove(e),e.dispose()})}}function ye(o,e){let t=!1,n,r={x:0,y:0};const i=()=>{t||(requestAnimationFrame(i),n&&(o(n,r),n=void 0,r={x:0,y:0}))};i();const A=l=>{n=l,r.x+=l.movementX,r.y+=l.movementY},a=l=>{t||(e&&e(l),t=!0),window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",a),window.removeEventListener("mousedown",a)};window.addEventListener("mousemove",A),window.addEventListener("mouseup",a),setTimeout(()=>window.addEventListener("mousedown",a))}var $t="./assets/grab-purple.7ef5ea20.png";const Ie=new xe;class en{constructor(e){g(this,"inspector");g(this,"_sprites");g(this,"_transformControls");g(this,"_spriteMaterial");g(this,"_raycaster");g(this,"_active");this.inspector=e;const n=new Be().load($t,r=>{r.flipY=!1});this._spriteMaterial=new Xe({sizeAttenuation:!1,transparent:!0,depthTest:!1,map:n}),this._raycaster=new qe,this._active=!0}get active(){return this._active}set active(e){var t,n;this._active=e,(t=this._sprites)==null||t.forEach(r=>r.visible=e),e===!1&&((n=this._transformControls)==null||n.detach())}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new be(t,n),this._transformControls.space="local",this._transformControls.mode="rotate",e.add(this._transformControls),this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)}),n!=null&&(n==null||n.addEventListener("mousedown",r=>this.handleMouseDown(r)))}handleAfterLoad(e){var n;const t=(n=e.vrm)==null?void 0:n.humanoid;if(t!=null&&t){this._sprites=[];for(const r of Object.values(t.humanBones)){const i=r.node,A=new $e(this._spriteMaterial);A.scale.setScalar(.01),A.renderOrder=1e4,A.visible=this._active,i.add(A),this._sprites.push(A)}}}handleAfterUnload(){var e;this._sprites=null,(e=this._transformControls)==null||e.detach()}handleMouseDown(e){const{camera:t,canvas:n}=this.inspector;if(n==null)return;const r=this._sprites;if(r==null)return;const i=this._transformControls;if(i==null)return;const A=n.getBoundingClientRect();Ie.set((e.clientX-A.left)/A.width*2-1,-(e.clientY-A.top)/A.height*2+1),this._raycaster.setFromCamera(Ie,t);const l=this._raycaster.intersectObjects(r,!1)[0],h=Date.now();ye(()=>0,()=>{if(!(Date.now()-h>300))if(l!=null){const d=l.object.parent;i.attach(d)}else i.detach()})}}const Pe=new F,tn=new et;class nn{constructor(e){g(this,"inspector");g(this,"_enableLookAt");g(this,"_lookAtTarget");g(this,"_transformControls");this.inspector=e,this._enableLookAt=!1,this._lookAtTarget=new tt,e.scene.add(this._lookAtTarget)}get enableLookAt(){return this._enableLookAt}set enableLookAt(e){this._enableLookAt=e,this._transformControls&&(this._transformControls.enabled=e,this._transformControls.visible=e),e?this._enableLookAtTarget():this._disableLookAtTarget()}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new be(t,n),e.add(this._transformControls),this._transformControls.attach(this._lookAtTarget),this._transformControls.enabled=!1,this._transformControls.visible=!1,this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)})}handleAfterLoad(e){var r;const{vrm:t}=e;if(t==null)return;const n=(r=t.humanoid)==null?void 0:r.getBoneNode("head");n!=null&&(n.getWorldPosition(Pe),this._lookAtTarget.position.set(0,0,5).add(Pe)),this._enableLookAt&&this._enableLookAtTarget()}_enableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=this._lookAtTarget)}_disableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=void 0,e.applier.lookAt(tn.set(0,0,0)))}}class on{constructor(e){g(this,"inspector");g(this,"bloomPass");g(this,"toneMappingPass");this.inspector=e,this.bloomPass=new nt(new xe(4,4),1,.5,1),this.bloomPass.enabled=!1,this.toneMappingPass=new ot(st),this.toneMappingPass.enabled=!1}handleAfterSetup(){const e=this.inspector.composer;e.addPass(this.bloomPass),e.addPass(this.toneMappingPass)}}function sn(o,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(o.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}function rn(o,e){const t=new Set,n=o.material;if(Array.isArray(n))n.forEach(i=>{t.add(i)});else{const r=n;t.add(r)}for(const r of t)e(r)}var An="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQQBBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAH7v5JqzrodJxSqKZUVyCEgj6EZBH0IyCMgjIPPQ8kEZB5IOwqeJbISlsqmFVgVTCEpSE5SuctkJxZCZZCZZCZZGZZCwITDrvqOe5Si6Wznvls57osouLKLiyi4souLKbiym4spuKpvCm4Sq4squLNHQma5ujrlLm6OuUubo65y5mlpnLmaWmcuZpaZy5mlpnLmaWmcubpaZy5ujpnLnaPecudo6Zy5+hpnLwaGmcvB36Zy5bzvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/8QAIBABAQEBAAIABwAAAAAAAAAAABIREwECAwQQFDBQcP/aAAgBAQABBQL39vWPm/Hivb833ftnxPenn9DjGMZ9MYxjGMYxjGMYxjGMYxjEpSlKUpSlKUpSlCEIQhCEIQhCEIcnJxcXFxcXFxcXFxcXJycv4D//xAAbEQEBAAIDAQAAAAAAAAAAAAAAEQEwAhJgcP/aAAgBAwEBPwFy39mc775CIiIiIiIiIifAf//EABwRAQEBAAMAAwAAAAAAAAAAAAATEQESMAJQcP/aAAgBAgEBPwF8Pfo4498Z9/rWt8ta1RRRRRRRRRRRRRRR3/Af/8QAGRAAAgMBAAAAAAAAAAAAAAAAATEAITBw/9oACAEBAAY/AjYUO77h/8QAHhABAQEAAQQDAAAAAAAAAAAAABEBIRAgMEFQUWD/2gAIAQEAAT8hpdhXtxr7YbidIndERnCrru4iIiIiIiIrda3ERERERERERuN7QTxgPvn83m/HAAH/AP2fzcuV1dXV1dXf3P8A/9oADAMBAAIAAwAAABD1v+TzxSRCCCBACADDAiKLNsvk00302/8AvbJpdNFF1BBwgxRRMk0QwyyyyCSf/wD407777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDnDndwzOhLnvM6uXRyzMz2M7szOjOzMzMzPhKUpSlKUpzn6nKcvsSIiIiIiIiIi//EABwRAQEBAQADAQEAAAAAAAAAABEAUQEQIDBAcP/aAAgBAgEBPxDnOt10ufbvMdz1Ij1I8hHg+Z8j5kfJ/IDMzM8nkzz0A2Gw2Gx2Ox2Ox2Ow2Gw2Gw2O/wAB/8QAIBABAQACAgMBAAMAAAAAAAAAAQARUWGREHGhIDAxYP/aAAgBAQABPxASIw/o5ye7N8cZWFfExJ8GLFixY8hE58WNyNVzmOV8TGP8IAJmTsc+FrWv6/KUq58kYx/ZAhCMY+AxjH85IQhHjPG4Zep4zxnjPGz1el6XrHCOMcY4ytStS9S9S9S9S9S9S9WerLULULULULUPU8D5PE+TwJeiVol6JeiXqXo+Weiy0WerPVno+WWi9Szs9tnZ7bke25HtuR7bke25HtuR7bLt7bLt7bLt7bLt7bLt7bLt7bLt7bLt7f8AY//Z",an="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDAgT/2gAMAwEAAhADEAAAAc6XpYoSCEpSEpSMoISCPQ50OdDnQ5IOdDklOSlOSDnQssWKpylc4srmWVzLK5lQmFcwhMITCMwhMIzEjMsjMsjML76Tz3lnm9BZ5ryzz3lnnvK898pRdKUXylF8pTdKU3ylN8pTeFVwVXCe7Rma5ujpnLm6WmcuXp6Zy5enpnLl6eucuXp6Zy5enpnLl6emcuZp98S5ul3nLm6Wmcudo6Zy5+hpnL4NDTOXwe/TOXLed6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITMFBw/9oACAEBAAEFAvRTzRERERERERERERERERERERGWWWWWWWWWWWWWWWWHNzc3Nzc3NzYYYYYYYcnFxcXBwcHBwcHFxcXFycvgP//EABcRAQEBAQAAAAAAAAAAAAAAABEAYHD/2gAIAQMBAT8B2BERERERERERwH//xAAbEQEBAQEAAwEAAAAAAAAAAAAAExEBEjBgcP/aAAgBAgEBPwH6DWt9etaoooooopxTinFOKKKKKPP8B//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEABj8CAH//xAAcEAEBAQADAAMAAAAAAAAAAAARAAEQMEBQYHH/2gAIAQEAAT8hIiOkjgiIiIiIiIiIiI4ERERERERHwYAAf/8A++DwAt8wD9YfjoZOzs7Ozs7O/ev/2gAMAwEAAgADAAAAEBAOuj73333736qgkCm3XVdBNNNBNNRXX8QYcQQqmqqmqqoAEemjrrgkssqz7z0w07777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABsRAQEBAAIDAAAAAAAAAAAAABEAIEBREDBg/9oACAEDAQE/EJ4b6HTlmds+WdM4cM7Z2zPKU5SlKc5zn1PqU5S+xIiIiIiIiIiL/8QAHREBAQEAAgMBAQAAAAAAAAAAEQBRMGEBECBAcP/aAAgBAgEBPxD8B8HOcRxERHIfJH5gTM+J8TMzM+g9BsNhsdjsdu67rsuyOw2Gw2Gx3+A//8QAHRABAQADAQEBAQEAAAAAAAAAAQARUWGRIHFgof/aAAgBAQABPxBjGMSxYsWLFixEIERrGsY/ICEIQhGtY1r9flKUpWtaxjH5AQhCEa1rWMfkBCEIR4ni4TxPErU835s9Wer8xzHMcxzHMvUrUmpWpWpWpWpWrLVnqz1D1D1C1C1D1fknklaP8l6JWiVol6JeiVpK0WerLRZ6LLRZavyXR9bo+t0fW6PrdH1uj63R9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9f7H/9k=",ln="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAasKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQABBQIAf//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8BAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/AQB//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQAGPwIAf//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEAAT8hAH//2gAMAwEAAgADAAAAEM8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8QAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/EAB//8QAFhABAQEAAAAAAAAAAAAAAAAAABFw/9oACAEBAAE/ENwiIiIiIiIiIj//2Q==",cn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAQEBAQEAAAAAAAAAAAAAAQACAwQG/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAAB+6+NdXO8q2eY0ywUAEBCCWEWCAgICBrIaA0WHo5qb5y2OJSEIsICAcggICCoQgaAQNAdCiAhCAgICBYBAQEBAYEJdBGgN1BQEABAsBSEWFBQUCA1g1CBqI1AQEBARRIEFBQUFBQME0SDEagICAiwiilBgIKCgoJCVKBiGDSGYBDKGUsIoQGUGUGUEKCRJCQkFUywZQygIZQEsEszosEsEBCQkJCg/8QAHRAAAQQCAwAAAAAAAAAAAAAAAgADERIBMAQUcP/aAAgBAQABBQIzCnLixbu2UOOWWd1lPr//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQMBAT8BJb2G+3//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQIBAT8BIb0Eu3//xAAZEAACAwEAAAAAAAAAAAAAAAABMQAhMHD/2gAIAQEABj8CNhQ7vuH/xAAgEAEAAgEDBQEAAAAAAAAAAAABABEQIDBgITFAQVBR/9oACAEBAAE/Ib+sK9k7F+4Om9Fy8nRWwHHeMrHduXF4c8AfAfof/9oADAMBAAIAAwAAABC0w8HDHUfe8+/9+8colvcc/wDf/LKL/P8A38MRzzz2sAAAEIMm34b7/wBrCRSyyxyQBAP+++sATwwwwxwyCAM888EBixwxxyyhBP8Av/vnhQgIIIgQxnvvrPv/AD9xQYRV9/zz3//EABwRAAEDBQAAAAAAAAAAAAAAAAEQEUAAITBQcP/aAAgBAwEBPxAmyDABVsb0+gEATxxD/8QAGxEAAwADAQEAAAAAAAAAAAAAAAERECAwUGD/2gAIAQIBAT8QSdGcFvdKXEUgLtCfUXK6P0J7H//EAB0QAQEBAQACAwEAAAAAAAAAAAEAERAgMSFBUWH/2gAIAQEAAT8QAAo+E3T+MW/rq9mUsssvGtra9Nhl75Z+zpV23WUsstttttttsMNr9nfu3lLLLbbbbbbbDbMeBZZZZbbbbbYYYZZZZZZZZbbbbbYYYlllllllttttthhhiWWWWWWW223mxERLMyyyz5ERHDMzM93hERE+5mZmeMcIiImZmZ8iIiJmZmZ5llkEEEEcMzMlllllkEEEEEJmSSSyyyyyCCCCCZJJJLLLLLLIIIIIJJJJLLLLLLLIIIIIL//Z",dn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQEEBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAHOl6WKEgjII9CMgjIIyDnQ5IOdDkg5IEglKDSo466n3HyWGuueJPRwrsCuZZXMshMshMshMshNbIzlIylIzCNgRmCUtnUtnUtkbhKLiyi4sovKouCm4Sm4spuLKriyq4squLKriyq9bKrpbKrpSq+Cfvma5+hpnLnaGmcudo6Zy52jpnLnaOucudpaZy5ulpnLnaWmcudpaZy52lpnLnaWmcufo6Zy5+jplLn6OuUvg0NM5cN53oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/EACEQAQEBAQABAgcAAAAAAAAAAAASERMCATADBBAUIEBw/9oACAEBAAEFAvd8Xynp6V4eXjHu+j4fnL7vyz9DGMYxjPpjGMZ+GMYxjGMYxjGMYxKUpSlKUpSlKUpQhCEIQhCEIQhCHJycnFxcXFxcXFxcXFxcnL+A/wD/xAAcEQEBAAICAwAAAAAAAAAAAAARAAFAAhIwYHD/2gAIAQMBAT8B83HQxm7aD6CREREREREREfAf/8QAHREBAQEAAgIDAAAAAAAAAAAAABMRATACEkBQcP/aAAgBAgEBPwHu8/gc8PTvxn2Otb1a1rXuoooooooooooooop+A//EABoQAAICAwAAAAAAAAAAAAAAAAExACEwQHD/2gAIAQEABj8CzCCwtB9h/8QAHxABAQEAAQMFAAAAAAAAAAAAABEBIRAgMEBBUFFg/9oACAEBAAE/IYid0TpGYw519qXIR7oiIiIiIiMzr28KkRERERERGYxmr4AE7QwzETy+z56HwAGfFh//ANn87q6urq6uuXP7H//aAAwDAQACAAMAAAAQAgAQgggQkU88k/b9/vN9NNN5LbziiIwwRRxgwBB1FFNdpJbvTj//AH0gsssssENJDL777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDDM4d+MOO7iDJ0curPYZmZ1Zmd2cszMzM7M+CpynP1OcpSlKUpS+xIiIiIiIiIiL//xAAcEQEBAQEBAQADAAAAAAAAAAARAFEBMCAQQHD/2gAIAQIBAT8Q9e3XS7zrEfJEfPZ7nPmfgjwDyPIj9V+A8meTyZmZ+QOw2Gw2Gw2Ox2Ox2Ox2Gw2Gw3+A/wD/xAAgEAEBAAICAwEAAwAAAAAAAAABABFRYZEQcaEgMDFg/9oACAEBAAE/EHyMWLFix4ECPCypZvjjCUCEP6GMHuf4QAQh4RwkjEcYg48WNzWv6/KUp4pxOWbMY/sEQh5CQcxjH8pKQh4BCEeM8Z4zwvW9L0hajjHGOMcYerhjjHGXqVqVqVqVqy1Z6h6h6h6h6h6h6h6hahavUstFno+WerPVlos9EPR8h6h6IeiFoh6I4EcT5HA+WXb22Xb22Xb22Xb22Xb22Xb22Xb22Xb23I9tyPbcj23I9tyPbcj22dnts7Pb/sf/2Q==",hn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAc7vSxRkEJSkJSkewRkEehzoc6HOhyQckEZKclKckHJBKZFcyyuZZXMsrmVCYVzCEwhMIzCEwjMSMyyMyyM1I2Sk7hKLivPeHnvlPPfKUXSlF8pRfKU3SlN8pTeFN4lN5ZT6Cym8spvLL/fM1z9DTOXO0NM5c7R0zlzdLTOXN0tM5czT08S5mnpnLm6emcubp6Zy5unpnLm6fvOXN09M5c7S0zlztHTOXP0dM5cVzugAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITEFBw/9oACAEBAAEFAvWzzEREREREREREREREREREREZZZZZZZZZZZZZZZZYYYYYYYc3Nzc3Nzc3NhycnFxcXFwcHBwcHBxcXFy+A/wD/xAAXEQEBAQEAAAAAAAAAAAAAAAARAGBw/9oACAEDAQE/AdgREREREREREcB//8QAGxEBAQEBAAMBAAAAAAAAAAAAABMRARIwYHD/2gAIAQIBAT8B+g1rfXrWvNRRRRRTinFOKcUUUUUU/Af/xAAUEAEAAAAAAAAAAAAAAAAAAACA/9oACAEBAAY/AgB//8QAHBABAQEAAwADAAAAAAAAAAAAEQABEDBAUGBx/9oACAEBAAE/ITgjpIiIiIiIiIiIiIiIiIiIiIjgR8cAAH//AIAfPB34GdRTfjxBrs7Ozs7Ozv3H/9oADAMBAAIAAwAAABBAKqp+9999+8/roAR90XXQTTTQTRV11spECCqpqqpqoIHGEHFMNM+8+vLJIK645rq+++++++++++++++888888888888888888888888888888888888888888888888//xAAbEQEBAAIDAQAAAAAAAAAAAAARACAwEEBRYP/aAAgBAwEBPxDc4uh1szi5M5M8s8s5s4OpmeqpTlPyfk5znKUpTl9iREREREREREX/xAAdEQEBAQABBQEAAAAAAAAAAAARAFFhARAgMEBw/9oACAECAQE/EPrPA7nqPSREesjxPoDsZmZmek9JmHcOw2Gw2Gx25Lkua5o7HY7DYbDfwH//xAAdEAEBAAMBAQEBAQAAAAAAAAABABFRYZEgcWCh/9oACAEBAAE/EGJMZixYsWLFiCIQhGMYxj8gIQhSFa1rX6/KUpClYxjH5AQhCFKVjGMfkBCEKUpXmeZ5nmeb82erPV+Y5hajiOLhHEcS9StStS9S9WerPVlqFqFqFqFqFqTULUPV+Sy1ZaLPRZaLPULRC0h6IeiFohaIeiFo/wAjkvyWXb62Xb62Xb62Xb62Xb62Xb62Xb62Xb62Xb63R9bo+t0fW6PrdH1uj63R9f7H/9k=";const mn=new F;Ee.install({THREE:Ce});class te{constructor(){g(this,"animationPlugin");g(this,"cameraControlsPlugin");g(this,"helpersPlugin");g(this,"humanoidTransformPlugin");g(this,"lookAtPlugin");g(this,"postProcessingPlugin");g(this,"_scene");g(this,"_camera");g(this,"_renderer");g(this,"_composer");g(this,"_model");g(this,"_stats",null);g(this,"_webglMemory",null);g(this,"_webglMemoryInfo",null);g(this,"_dracoLoader");g(this,"_loader");g(this,"_canvas");g(this,"_layerMode","thirdPerson");g(this,"_handleResize");g(this,"_ongoingRequestEnvMap");g(this,"_plugins");this._camera=new rt(30,window.innerWidth/window.innerHeight,.1,20),this._camera.position.set(0,1,5),this._scene=new it;const e=new At(16777215);e.position.set(1,1,1).normalize(),this._scene.add(e);const t=new at(10,10);this._scene.add(t);const n=new lt(5);this._scene.add(n),this.helpersPlugin=new qt(this),this._dracoLoader=new ct,this._dracoLoader.setDecoderPath("./draco/"),this._loader=new dt,this._loader.setDRACOLoader(this._dracoLoader),this._loader.register(r=>new ht(r,{humanoidPlugin:new mt(r,{helperRoot:this.helpersPlugin.humanoidHelperRoot}),lookAtPlugin:new ut(r,{helperRoot:this.helpersPlugin.lookAtHelperRoot}),springBonePlugin:new pt(r,{jointHelperRoot:this.helpersPlugin.springBoneJointHelperRoot,colliderHelperRoot:this.helpersPlugin.springBoneColliderHelperRoot})})),this.animationPlugin=new Jt(this),this.cameraControlsPlugin=new Xt(this),this.humanoidTransformPlugin=new en(this),this.lookAtPlugin=new nn(this),this.postProcessingPlugin=new on(this),this._plugins=[this.animationPlugin,this.cameraControlsPlugin,this.helpersPlugin,this.humanoidTransformPlugin,this.lookAtPlugin,this.postProcessingPlugin]}static get VALIDATOR_MAX_ISSUES(){return 100}get scene(){return this._scene}get camera(){return this._camera}get renderer(){return this._renderer}get composer(){return this._composer}get model(){var e;return(e=this._model)!=null?e:null}get stats(){return this._stats}get webglMemoryInfo(){return this._webglMemoryInfo}get canvas(){return this._canvas}get layerMode(){return this._layerMode}set layerMode(e){this._layerMode=e,this._updateLayerMode()}unloadVRM(){const e=this._model;e&&(this._scene.remove(e.scene),q.deepDispose(e.scene),this._emit("unload")),this._plugins.forEach(t=>{var n;return(n=t.handleAfterUnload)==null?void 0:n.call(t)}),this._model=null}async loadVRM(e){var m,u,d,f,E;const t=await fetch(e).then(B=>B.arrayBuffer()),n=await gt(new Uint8Array(t),{maxIssues:te.VALIDATOR_MAX_ISSUES}).catch(B=>console.error("Validation failed: ",B));this._emit("validate",n),this.unloadVRM();const i=new ft({credentials:"include"}).binaryToJSON(t).json,A=await new Promise((B,x)=>{this._loader.crossOrigin="anonymous",this._loader.load(e,b=>{B(b)},b=>{this._emit("progress",b)},b=>{this._emit("error",b),x(b)})});q.removeUnnecessaryVertices(A.scene),q.removeUnnecessaryJoints(A.scene);const a=(m=A.userData.vrm)!=null?m:null;a==null&&console.warn("Failed to load the model as a VRM. Fallback to treat the model as a mere GLTF"),this._stats=await this._prepareStats(A,a);const l=(u=a==null?void 0:a.scene)!=null?u:A.scene;this._scene.add(l);const h={gltf:A,validationReport:n,originalGLTFJSON:i,vrm:a,scene:l};return this._model=h,this._plugins.forEach(B=>{var x;return(x=B.handleAfterLoad)==null?void 0:x.call(B,h)}),a&&((d=a.firstPerson)==null||d.setup(),this._updateLayerMode(),a.scene.traverse(B=>{"isMesh"in B&&rn(B,async x=>{"isMeshStandardMaterial"in x&&(x.envMap=await this._requestEnvMap())})}),q.rotateVRM0(a),(f=a.springBoneManager)==null||f.setInitState(),(E=a.nodeConstraintManager)==null||E.setInitState()),this._emit("load",h),h}async exportBufferView(e){var a;const t=(a=this._model)==null?void 0:a.gltf;if(t==null)return;const n=await t.parser.getDependency("bufferView",e),r=new Blob([n]),i=URL.createObjectURL(r),A=document.createElement("a");A.href=i,A.download=`${e}.bin`,A.click(),URL.revokeObjectURL(i)}setup(e){this._canvas=e;const t=window.innerWidth,n=window.innerHeight,r=window.devicePixelRatio;this._renderer=new Et({canvas:this._canvas}),this._renderer.outputEncoding=xt,this._renderer.setSize(t,n),this._renderer.setPixelRatio(r),this._composer=new Bt(this._renderer,new bt(t,n,{type:Ct})),this._composer.setPixelRatio(window.devicePixelRatio);const i=new wt(this._scene,this._camera);this._composer.addPass(i),this._handleResize&&window.removeEventListener("resize",this._handleResize),this._handleResize=()=>{this._camera.aspect=window.innerWidth/window.innerHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(window.innerWidth,window.innerHeight),this._composer.setSize(window.innerWidth,window.innerHeight)},window.addEventListener("resize",this._handleResize),this._webglMemory=this._renderer.getContext().getExtension("GMAN_webgl_memory"),this._plugins.forEach(A=>{var a;return(a=A.handleAfterSetup)==null?void 0:a.call(A)})}registerDnD(e){const t=r=>{r.preventDefault()},n=r=>{r.preventDefault();const i=r.dataTransfer.files;if(!i)return;const A=i[0];if(!A)return;const a=new Blob([A],{type:"application/octet-stream"}),l=URL.createObjectURL(a);this.loadVRM(l)};return e.addEventListener("dragover",t),e.addEventListener("drop",n),()=>{e.removeEventListener("dragover",t),e.removeEventListener("drop",n)}}update(e){var t;((t=this._model)==null?void 0:t.vrm)&&this._model.vrm.update(e),this._plugins.forEach(n=>{var r;return(r=n.handleBeforeRender)==null?void 0:r.call(n,e)}),this._composer&&this._composer.render(e),this._webglMemory&&(this._webglMemoryInfo=this._webglMemory.getMemoryInfo())}async _prepareStats(e,t){var f,E,B;const n=new vt,r=new Set;let i=0,A=0,a=0;const l=x=>{var C,R;A++;const b=x.geometry;n.expandByObject(x);const y=b.getAttribute("position");r.add(y),a+=((R=(C=b.index)==null?void 0:C.count)!=null?R:y.count)/3};(await e.parser.getDependencies("mesh")).forEach(x=>{i++,x.isMesh?l(x):x.children.forEach(y=>{l(y)})});let m=0;for(const x of r)m+=x.count;const u=await e.parser.getDependencies("material"),d=(B=(E=(f=t==null?void 0:t.springBoneManager)==null?void 0:f.springBones)==null?void 0:E.size)!=null?B:0;return{dimension:n.getSize(mn).toArray(),vertices:m,polygons:a,meshes:i,primitives:A,materials:u.length,springBones:d}}_requestEnvMap(){const e=[an,An,cn,ln,hn,dn];if(!this._ongoingRequestEnvMap){const t=new Rt;this._ongoingRequestEnvMap=new Promise((n,r)=>{t.load(e,i=>n(i),void 0,i=>r(i))})}return this._ongoingRequestEnvMap}_updateLayerMode(){var t,n;const e=(n=(t=this._model)==null?void 0:t.vrm)==null?void 0:n.firstPerson;!e||(this._layerMode==="firstPerson"?(this._camera.layers.enable(e.firstPersonOnlyLayer),this._camera.layers.disable(e.thirdPersonOnlyLayer)):(this._camera.layers.disable(e.firstPersonOnlyLayer),this._camera.layers.enable(e.thirdPersonOnlyLayer)))}}sn(te,[Tt]);var un="./assets/uv-grid.cfc47a74.png",H;(function(o){o[o.None=0]="None",o[o.GLTFFallback=1]="GLTFFallback",o[o.MToonNormal=2]="MToonNormal",o[o.MToonLitShadeRate=3]="MToonLitShadeRate",o[o.MToonUV=4]="MToonUV",o[o.UVGrid=5]="UVGrid"})(H||(H={}));const ke=new re({visible:!1}),pn=new Promise(o=>{new Be().load(un,t=>{t.flipY=!1,o(t)})});function Qe(){const o=new re({color:16711935});return pn.then(e=>{o.map=e,o.color.set(16777215)}),o}function Le(o,e){if("isMToonMaterial"in o){const t=o;t.debugMode=e}}function ze(o){return"isMToonMaterial"in o?o.isOutline:!1}class gn{constructor(e){g(this,"_currentMode",0);g(this,"_vrmMaterialsByMesh",new Map);g(this,"_inspector");this._inspector=e,this._inspector.on("load",()=>this._handleLoad()),this._inspector.on("unload",()=>this._handleUnload())}applyMode(e){e===0?this._applyModeMToon($.None):e===2?this._applyModeMToon($.Normal):e===3?this._applyModeMToon($.LitShadeRate):e===4?this._applyModeMToon($.UV):e===5&&this._applyModeUVGrid(),this._currentMode=e}_applyModeMToon(e){for(const[t,n]of this._vrmMaterialsByMesh.entries())Array.isArray(n)?n.forEach((r,i)=>{Le(r,e),t.material[i]=r}):(Le(n,e),t.material=n)}_applyModeUVGrid(){for(const[e,t]of this._vrmMaterialsByMesh.entries())Array.isArray(t)?t.forEach((n,r)=>{ze(n)?e.material[r]=ke:e.material[r]=Qe()}):ze(t)?e.material=ke:e.material=Qe()}async _handleLoad(){(await this._inspector.model.gltf.parser.getDependencies("mesh")).forEach(t=>{if("isGroup"in t)t.children.forEach(r=>{const i=r;this._addManagedMesh(i)});else{const n=t;this._addManagedMesh(n)}}),this.applyMode(this._currentMode)}_addManagedMesh(e){Array.isArray(e.material)?this._vrmMaterialsByMesh.set(e,e.material.concat()):this._vrmMaterialsByMesh.set(e,e.material)}_handleUnload(){this._vrmMaterialsByMesh.clear()}}var _e="./assets/three-vrm-girl-vrm0.0.e6e179de.vrm";function fn(o){console.error(o)}const D=new te;D.loadVRM(_e).catch(fn);D.registerDnD(document.body);const En=new Dt(D),xn=new gn(D);console.info(D);const Bn=new Mt;function Se(){requestAnimationFrame(Se);const o=Bn.getDelta();D.update(o)}Se();const P=we.createContext({inspector:D,highlighter:En,materialDebugger:xn}),He=({href:o,widthClass:e})=>o==null?null:s("a",{href:o,target:"_blank",rel:"noreferrer",className:`font-bold truncate inline-block align-top underline text-sky-500 ${e!=null?e:"w-64"}`,children:o});function bn(){const o=c.exports.useRef(-1/0);return c.exports.useCallback(t=>{const n=performance.now();n-o.current<250?(t(),o.current=-1/0):o.current=n},[o])}const Q=o=>{var h,m,u;const[e,t]=c.exports.useState((h=o.initPosition)!=null?h:{left:0,top:0}),[n,r]=c.exports.useState((m=o.initOpening)!=null?m:!1),i=bn(),A=c.exports.useCallback(d=>{var f;(f=o.onClick)==null||f.call(o,d,o.paneKey)},[o.onClick,o.paneKey]),a=c.exports.useCallback(d=>{d.preventDefault();let f=e.left,E=e.top;ye((B,x)=>{B.preventDefault(),B.stopPropagation(),f+=x.x,E+=x.y,t({left:f,top:E})}),i(()=>{r(!n)})},[n,e]),l=c.exports.useCallback(d=>{var f;d.preventDefault(),d.stopPropagation(),(f=o.onClick)==null||f.call(o,d,o.paneKey),r(!n)},[n,o.onClick,o.paneKey]);return M("div",{style:{left:e.left,top:e.top,minWidth:"15rem",boxShadow:"0 0 10px rgba(0, 0, 0, 1.0)"},className:`absolute shadow ${o.className}`,onMouseDown:A,children:[M("div",{className:"h-5 leading-5 w-full bg-gray-700 cursor-move",onMouseDown:a,children:[s("div",{className:"inline-block w-5 h-5 text-center cursor-pointer hover:text-sky-500",onMouseDown:l,children:n?"-":"+"}),o.title]}),n&&((u=o.children)!=null?u:null)]})},L=({className:o,paddingClass:e,children:t})=>s("div",{className:`bg-gray-900/80 backdrop-blur ${e!=null?e:"p-2"} ${o}`,children:t}),Cn=o=>s(Q,v(w({},o),{children:M(L,{children:[s("div",{children:"three-vrm-inspector"}),s("div",{children:"Three.js based VRM inspector"}),M("div",{children:["Source: ",s(He,{widthClass:"w-min",href:"https://github.com/0b5vr/three-vrm-inspector"})]})]})})),Z=({label:o,onChange:e,defaultValue:t,disabled:n})=>{const r=c.exports.useCallback(i=>{const A=parseFloat(i.currentTarget.value);e(A)},[]);return M("div",{className:"flex items-center",children:[s("input",{className:"mr-2",type:"range",min:"0",max:"1",step:"0.001",defaultValue:t!=null?t:0,disabled:n,onChange:r}),n?s("span",{className:"text-gray-500",children:o}):o]})},De=({name:o,isAvailable:e})=>{const{inspector:t}=c.exports.useContext(P),n=c.exports.useCallback(r=>{var i,A,a;(a=(A=(i=t.model)==null?void 0:i.vrm)==null?void 0:A.expressionManager)==null||a.setValue(o,r)},[]);return s(Z,{label:o,disabled:!e,onChange:n})},Y=()=>s("div",{className:"w-full h-0.5 my-2 bg-gray-500"}),Te=[I.Neutral,I.Happy,I.Angry,I.Sad,I.Relaxed,I.Surprised,I.Blink,I.BlinkLeft,I.BlinkRight,I.Aa,I.Ee,I.Ih,I.Oh,I.Ou,I.LookLeft,I.LookRight,I.LookDown,I.LookUp],wn=new Set(Te),vn=o=>{var A,a,l;const{inspector:e}=c.exports.useContext(P),t=(a=(A=e.model)==null?void 0:A.vrm)==null?void 0:a.expressionManager,n=t==null?void 0:t.expressionMap,r=[];n&&Array.from(Object.keys(n)).forEach(h=>{wn.has(h)||r.push(h)});const i=((l=r==null?void 0:r.length)!=null?l:0)>=1;return s(Q,v(w({},o),{children:s(L,{children:t?M(z,{children:[Te.map(h=>s(De,{name:h,isAvailable:(t==null?void 0:t.getExpression(h))!=null},h)),s(Y,{}),r==null?void 0:r.map(h=>s(De,{name:h,isAvailable:!0},h)),!i&&s("span",{className:"text-gray-500",children:"(No custom expressions)"})]}):"No blendShapeProxy detected."})}))},Rn=o=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useRef(null),n=c.exports.useCallback(r=>{var A;r.preventDefault();const i=(A=t.current)==null?void 0:A.value;if(i!=null&&i!==""){const a=parseInt(i,10);e.exportBufferView(a)}},[e]);return s(Q,v(w({},o),{children:s(L,{children:M("form",{onSubmit:n,children:[s("input",{type:"number",ref:t,defaultValue:0,className:"w-24 px-1 bg-gray-800 border border-gray-500",required:!0}),s("input",{type:"submit",className:"ml-1 px-1 bg-gray-800 border border-gray-500",value:"Export"})]})})}))},N=({callback:o,label:e,checked:t})=>{const n=c.exports.useCallback(({target:r})=>{o(r.checked)},[o]);return M("div",{children:[s("input",{type:"checkbox",checked:t,onChange:n}),e]})},Mn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!0),[r,i]=c.exports.useState(!0),[A,a]=c.exports.useState(!0),[l,h]=c.exports.useState(!0),[m,u]=c.exports.useState(!0),d=c.exports.useCallback(()=>{n(!0),i(!0),a(!0),h(!0),u(!0)},[]),f=c.exports.useCallback(()=>{n(!1),i(!1),a(!1),h(!1),u(!1)},[]),E=c.exports.useCallback(C=>{n(C)},[e]),B=c.exports.useCallback(C=>{i(C)},[e]),x=c.exports.useCallback(C=>{a(C)},[e]),b=c.exports.useCallback(C=>{h(C)},[e]),y=c.exports.useCallback(C=>{u(C)},[e]);return c.exports.useEffect(()=>{e.helpersPlugin.humanoidHelperRoot.visible=t},[e,t]),c.exports.useEffect(()=>{e.humanoidTransformPlugin.active=r},[e,r]),c.exports.useEffect(()=>{e.helpersPlugin.lookAtHelperRoot.visible=A},[e,A]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneJointHelperRoot.visible=l},[e,l]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneColliderHelperRoot.visible=m},[e,m]),s(Q,v(w({},o),{children:M(L,{children:[s("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:d,children:"Enable All"}),s("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:f,children:"Disable All"}),s(Y,{}),s(N,{callback:E,label:"Humanoid",checked:t}),s(N,{callback:B,label:"Humanoid Transform",checked:r}),s(N,{callback:x,label:"LookAt",checked:A}),s(N,{callback:b,label:"Spring Bones",checked:l}),s(N,{callback:y,label:"Spring Bone Colliders",checked:m})]})}))},yn="modulepreload",Ue={},In="./",Pn=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${In}${n}`,n in Ue)return;Ue[n]=!0;const r=n.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const A=document.createElement("link");if(A.rel=r?"stylesheet":yn,r||(A.as="script",A.crossOrigin=""),A.href=n,document.head.appendChild(A),r)return new Promise((a,l)=>{A.addEventListener("load",a),A.addEventListener("error",l)})})).then(()=>e())};const kn=`// Press Ctrl+S or Ctrl+R to apply
// The api will be changed without notice! Use at your own risk

export default ( { inspector, THREE } ) => {
  let isUnmounted = false;

  const vrm = inspector.model.vrm;

  // update
  const beginTime = Date.now();

  function update() {
    if ( isUnmounted ) { return; }

    const time = 0.001 * ( Date.now() - beginTime );

    const leftUpperArm = vrm.humanoid?.getBoneNode( 'leftUpperArm' );
    if ( leftUpperArm != null ) {
      leftUpperArm.rotation.z = Math.sin( time );
    }

    requestAnimationFrame( update );
  }
  requestAnimationFrame( update );

  // uninit
  return () => {
    isUnmounted = true;
  };
}
`,Qn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(kn),[r,i]=c.exports.useState(!1),A=c.exports.useRef();c.exports.useEffect(()=>{window.addEventListener("beforeunload",u=>{if(r){const d="You will lose all of your changes on the editor!";return u.returnValue=d,d}})},[r]);const a=c.exports.useCallback(u=>{var E;(E=A.current)==null||E.call(A);const d=new Blob([u],{type:"text/javascript"}),f=URL.createObjectURL(d);Pn(()=>import(f),[]).then(B=>{A.current=B.default({inspector:e,THREE:Ce}),URL.revokeObjectURL(f)})},[e]),l=c.exports.useCallback(u=>{u.addKeyMap({"Ctrl-S":()=>{a(u.getValue())},"Ctrl-R":()=>{a(u.getValue())}})},[a]),h=c.exports.useCallback((u,d,f)=>{n(f),i(!0)},[]),m=c.exports.useCallback(()=>{},[]);return s(Q,v(w({},o),{children:s(L,{className:"w-120 h-80",paddingClass:"p-0",children:s(yt,{value:t,options:{mode:"text/javascript",keyMap:"sublime",theme:"monokai-sharp",lineNumbers:!0},editorDidMount:l,onBeforeChange:h,onChange:m,className:"h-full leading-tight"})})}))},ne=({children:o,onClick:e,onMouseEnter:t,onMouseLeave:n})=>s("span",{className:"select-none cursor-pointer",onClick:e,onMouseEnter:t,onMouseLeave:n,children:o}),Ne=({children:o})=>s("div",{style:{marginLeft:"1.13em"},children:o}),Ae=({name:o,value:e,fullPath:t=""})=>{const{highlighter:n}=c.exports.useContext(P),[r,i]=c.exports.useState(!1),[A,a]=c.exports.useState(!1),[l,h]=c.exports.useState([void 0]),m=c.exports.useCallback(R=>{R.stopPropagation(),i(!r)},[i,r]),u=c.exports.useCallback(()=>{a(!0),h([n.highlight(t)])},[a,h,n,t]),d=c.exports.useCallback(()=>{var R;a(!1),(R=l[0])==null||R.call(l)},[a,l]),f=Array.isArray(e),E=e==null,B=typeof e=="number",x=typeof e=="boolean",b=typeof e=="string",y=!f&&!E&&!B&&!x&&!b,C={onClick:m,onMouseEnter:u,onMouseLeave:d,isHovering:A};return M("div",{className:"select-auto",children:[s("span",v(w({className:`cursor-pointer ${A&&"text-sky-500"}`},C),{children:o?`${o}: `:""})),f&&M(z,{children:[s(ne,v(w({},C),{children:"["})),r&&s(Ne,{children:e.map((R,k)=>s("div",{children:s(Ae,{name:k.toString()+((R==null?void 0:R.name)?` (${R.name})`:""),value:R,fullPath:`${t}/${k}`})},k))}),s(ne,v(w({},C),{children:` ${r?"":e.length} ]`}))]}),y&&M(z,{children:[s(ne,v(w({},C),{children:"{"})),r&&s(Ne,{children:Object.keys(e).map((R,k)=>s("div",{children:s(Ae,{name:R,value:e[R],fullPath:`${t}/${R}`})},k))}),s(ne,v(w({},C),{children:` ${r?"":Object.keys(e).join(", ")} }`}))]}),E&&s(z,{children:s("span",v(w({className:"text-pink-500"},C),{children:e}))}),B&&s(z,{children:s("span",v(w({className:"text-indigo-400"},C),{children:e}))}),x&&s(z,{children:s("span",v(w({className:"text-indigo-400"},C),{children:String(e)}))}),b&&s(z,{children:M("span",v(w({className:"text-yellow-300"},C),{children:['"',e,'"']}))})]})},Ln=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(void 0);return c.exports.useEffect(()=>{const r=()=>{var i;n((i=e.model)==null?void 0:i.originalGLTFJSON)};return e.on("load",r),()=>{e.off("load",r)}},[e]),s(Q,v(w({},o),{children:s(L,{className:"w-120 h-80 overflow-scroll whitespace-nowrap resize font-mono text-xs leading-tight",paddingClass:"p-0",children:s(Ae,{value:t})})}))},zn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!0),r=c.exports.useCallback(i=>{n(i),e.lookAtPlugin.enableLookAt=i},[e]);return s(Q,v(w({},o),{children:s(L,{children:s(N,{callback:r,label:"Enable LookAt",checked:t})})}))},_n=o=>{const{materialDebugger:e}=c.exports.useContext(P),t=c.exports.useCallback(n=>{const r=parseInt(n.target.value);e.applyMode(r)},[e]);return s(Q,v(w({},o),{children:s(L,{children:M("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:[s("option",{value:H.None,children:"None"}),s("option",{value:H.MToonNormal,children:"MToon Normal"}),s("option",{value:H.MToonLitShadeRate,children:"MToon LitShadeRate"}),s("option",{value:H.MToonUV,children:"MToon UV"}),s("option",{value:H.UVGrid,children:"UV Grid"})]})})}))},p=({name:o,value:e,href:t})=>M("div",{children:[o,":"," ",e!=null&&s("span",{className:"font-bold",children:e}),t&&s(He,{href:t})]}),Sn=({meta:o})=>M(z,{children:[s(p,{name:"Title",value:o.title}),s(p,{name:"Author",value:o.author}),s(p,{name:"Version",value:o.version}),s(p,{name:"Reference",value:o.reference}),s(p,{name:"Contact Information",value:o.contactInformation}),s(p,{name:"Allowed User Name",value:o.allowedUserName}),s(p,{name:"Violent Ussage Name",value:o.violentUssageName}),s(p,{name:"Sexual Ussage Name",value:o.sexualUssageName}),s(p,{name:"Commercial Ussage Name",value:o.commercialUssageName}),s(p,{name:"Other Permission URL",href:o.otherPermissionUrl}),s(p,{name:"License Name",value:o.licenseName}),s(p,{name:"Other License URL",href:o.otherLicenseUrl})]}),Hn=({meta:o})=>{var e;return M(z,{children:[s(p,{name:"Name",value:o.name}),s(p,{name:"Version",value:o.version}),s(p,{name:"Authors",value:o.authors.join(", ")}),s(p,{name:"Copyright Information",value:o.copyrightInformation}),s(p,{name:"Contact Information",value:o.contactInformation}),s(p,{name:"References",value:(e=o.references)==null?void 0:e.join(", ")}),s(p,{name:"Third Party Licenses",value:o.thirdPartyLicenses}),s(p,{name:"License URL",href:o.licenseUrl}),s(p,{name:"Avatar Permission",value:o.avatarPermission}),s(p,{name:"Allow Excessively Violent Usage",value:String(o.allowExcessivelyViolentUsage)}),s(p,{name:"Allow Excessively Sexual Usage",value:String(o.allowExcessivelySexualUsage)}),s(p,{name:"Commercial Usage Name",value:o.commercialUsage}),s(p,{name:"Allow Political or Religious Usage",value:String(o.allowPoliticalOrReligiousUsage)}),s(p,{name:"Allow Antisocial or Hate Usage",value:String(o.allowAntisocialOrHateUsage)}),s(p,{name:"Credit Notation",value:o.creditNotation}),s(p,{name:"Allow Redistribution",value:String(o.allowRedistribution)}),s(p,{name:"Modification",value:o.modification}),s(p,{name:"Other License URL",href:o.otherLicenseUrl})]})},Dn=o=>{var r,i;const{inspector:e}=c.exports.useContext(P),t=(i=(r=e.model)==null?void 0:r.vrm)==null?void 0:i.meta;let n=s(z,{children:"No meta detected."});return(t==null?void 0:t.metaVersion)==="1"?n=s(Hn,{meta:t}):(t==null?void 0:t.metaVersion)==="0"&&(n=s(Sn,{meta:t})),s(Q,v(w({},o),{children:s(L,{children:n})}))};var Tn="./assets/dancing.2665f039.fbx",Un="./assets/gangnam-style.119f68a4.fbx",Nn="./assets/jump.a8a08f02.fbx",Vn="./assets/running.c854d669.fbx",Gn="./assets/standing-clap.9fc941e1.fbx",Fn="./assets/walking.ed38b4d6.fbx";const On=[{name:"(No Animation)",url:"-"},{name:"Walking",url:Fn},{name:"Running",url:Vn},{name:"Jump",url:Nn},{name:"Dancing",url:Tn},{name:"Standing Clap",url:Gn},{name:"Gangnam Style",url:Un}],jn=o=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useCallback(n=>{const r=n.target.value;r==="-"?e.animationPlugin.clearMixamoAnimation():e.animationPlugin.loadMixamoAnimation(r)},[e]);return s(Q,v(w({},o),{children:s(L,{children:s("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:On.map(({name:n,url:r})=>s("option",{value:r,children:n},r))})})}))},Ve=({label:o,onChange:e,defaultChecked:t,disabled:n})=>{const r=c.exports.useCallback(i=>{const A=i.currentTarget.checked;e(A)},[]);return M("div",{className:"flex items-center",children:[s("input",{className:"mr-2",type:"checkbox",disabled:n,defaultChecked:t,onChange:r}),n?s("span",{className:"text-gray-500",children:o}):o]})},Wn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!1),r=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.enabled=d,n(d)},[e]),i=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.strength=4*d},[e]),A=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.radius=d},[e]),a=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.threshold=4*d},[e]),[l,h]=c.exports.useState(!1),m=c.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.enabled=d,h(d)},[e]),u=c.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.uniforms.exposure.value=2*d},[e]);return s(Q,v(w({},o),{children:M(L,{children:[s("h3",{className:"text-lg font-bold",children:"Bloom"}),s(Ve,{label:"Enabled",defaultChecked:!1,onChange:r}),s(Z,{label:"Strength",defaultValue:.25,disabled:!t,onChange:i}),s(Z,{label:"Radius",defaultValue:.5,disabled:!t,onChange:A}),s(Z,{label:"Threshold",defaultValue:.25,disabled:!t,onChange:a}),s(Y,{}),s("h3",{className:"text-lg font-bold",children:"ACES Tone Mapping"}),s(Ve,{label:"Enabled",defaultChecked:!1,onChange:m}),s(Z,{label:"Exposure",defaultValue:.5,disabled:!l,onChange:u})]})}))},Zn=({name:o,url:e})=>{const{inspector:t}=c.exports.useContext(P),n=c.exports.useCallback(()=>{t.loadVRM(e)},[t]);return s("button",{value:o,className:"bg-gray-800 border border-gray-500 px-1 py-0 block",onClick:n,children:o})};var Yn="./assets/three-vrm-girl.2076a024.vrm";const Kn=[{name:"three-vrm-girl (VRM0.X)",url:_e},{name:"three-vrm-girl (VRM1.0-beta)",url:Yn}],Jn=o=>s(Q,v(w({},o),{children:s(L,{children:Kn.map(({name:e,url:t})=>s(Zn,{name:e,url:t},e))})})),Xn=o=>{var r,i,A,a,l,h,m,u,d,f;const{inspector:e}=c.exports.useContext(P),t=(r=e.stats)==null?void 0:r.dimension.map(E=>E.toFixed(3)),n=`( ${(i=t==null?void 0:t[0])!=null?i:0}, ${(A=t==null?void 0:t[1])!=null?A:0}, ${(a=t==null?void 0:t[2])!=null?a:0} )`;return s(Q,v(w({},o),{children:M(L,{children:[s(p,{name:"Dimension",value:n}),s(p,{name:"Vertices",value:(l=e.stats)==null?void 0:l.vertices}),s(p,{name:"Polygons",value:(h=e.stats)==null?void 0:h.polygons}),s(p,{name:"Meshes",value:(m=e.stats)==null?void 0:m.meshes}),s(p,{name:"Primitives",value:(u=e.stats)==null?void 0:u.primitives}),s(p,{name:"Materials",value:(d=e.stats)==null?void 0:d.materials}),s(p,{name:"Spring Bones",value:(f=e.stats)==null?void 0:f.springBones})]})}))},qn=({children:o})=>s("div",{style:{marginLeft:"1.13em"},children:o}),$n=o=>{const[e,t]=c.exports.useState(!1),n=o.severity===0?j.error:o.severity===1?j.warning:j.severityInfo,r=c.exports.useCallback(()=>{t(!e)},[e]);return M("div",{className:"group cursor-pointer",onClick:r,children:[s("span",{className:"group-hover:text-sky-500",children:e?"- ":"+ "}),s("span",{style:{color:n},children:o.code}),s("span",{className:"text-gray-500",children:" - "+o.pointer}),e&&s(qn,{children:o.message})]})},oe=({count:o,colorClass:e})=>s("span",{className:o?e:"text-gray-500",children:o}),eo=o=>{var n,r,i,A;const{inspector:e}=c.exports.useContext(P),t=(r=(n=e.model)==null?void 0:n.validationReport)==null?void 0:r.issues;return s(Q,v(w({},o),{children:M(L,{className:"w-120 h-80 resize overflow-y-scroll",children:[s(p,{name:"Validator Version",value:(A=(i=e.model)==null?void 0:i.validationReport)==null?void 0:A.validatorVersion}),s(p,{name:"Errors",value:s(oe,{count:t==null?void 0:t.numErrors,colorClass:"text-red-500"})}),s(p,{name:"Warnings",value:s(oe,{count:t==null?void 0:t.numWarnings,colorClass:"text-yellow-300"})}),s(p,{name:"Infos",value:s(oe,{count:t==null?void 0:t.numInfos,colorClass:"text-sky-500"})}),s(p,{name:"Hints",value:s(oe,{count:t==null?void 0:t.numHints,colorClass:"text-sky-500"})}),s(Y,{}),(t==null?void 0:t.truncated)&&s("div",{className:"m-1 font-bold",children:"There are too many issues! Showing only 100 entries."}),s("div",{className:"w-full font-mono leading-tight text-xs",children:t==null?void 0:t.messages.map((a,l)=>s($n,{code:a.code,message:a.message,severity:a.severity,pointer:a.pointer},l))})]})}))},K=o=>(o/1048576).toFixed(3)+" MB",to=o=>{var n,r,i,A,a,l,h,m,u,d,f,E,B,x,b,y,C,R,k,T,_,S,J,V,G,U,ae,le,ce,de;const{inspector:e}=c.exports.useContext(P),t=e.webglMemoryInfo;return s(Q,v(w({},o),{children:M(L,{children:[s(p,{name:"Buffer",value:K((r=(n=t==null?void 0:t.memory)==null?void 0:n.buffer)!=null?r:0)}),s(p,{name:"Texture",value:K((A=(i=t==null?void 0:t.memory)==null?void 0:i.texture)!=null?A:0)}),s(p,{name:"Render Buffer",value:K((l=(a=t==null?void 0:t.memory)==null?void 0:a.renderbuffer)!=null?l:0)}),s(p,{name:"Drawing Buffer",value:K((m=(h=t==null?void 0:t.memory)==null?void 0:h.drawingbuffer)!=null?m:0)}),s(p,{name:"Total",value:K((d=(u=t==null?void 0:t.memory)==null?void 0:u.total)!=null?d:0)}),s(Y,{}),s(p,{name:"Buffer",value:(E=(f=t==null?void 0:t.resources)==null?void 0:f.buffer)!=null?E:0}),s(p,{name:"Render Buffer",value:(x=(B=t==null?void 0:t.resources)==null?void 0:B.renderbuffer)!=null?x:0}),s(p,{name:"Program",value:(y=(b=t==null?void 0:t.resources)==null?void 0:b.program)!=null?y:0}),s(p,{name:"Query",value:(R=(C=t==null?void 0:t.resources)==null?void 0:C.query)!=null?R:0}),s(p,{name:"Sampler",value:(T=(k=t==null?void 0:t.resources)==null?void 0:k.sampler)!=null?T:0}),s(p,{name:"Shader",value:(S=(_=t==null?void 0:t.resources)==null?void 0:_.shader)!=null?S:0}),s(p,{name:"Sync",value:(V=(J=t==null?void 0:t.resources)==null?void 0:J.sync)!=null?V:0}),s(p,{name:"Texture",value:(U=(G=t==null?void 0:t.resources)==null?void 0:G.texture)!=null?U:0}),s(p,{name:"Transform Feedback",value:(le=(ae=t==null?void 0:t.resources)==null?void 0:ae.transformFeedback)!=null?le:0}),s(p,{name:"Vertex Array",value:(de=(ce=t==null?void 0:t.resources)==null?void 0:ce.vertexArray)!=null?de:0})]})}))},no=()=>{const[o,e]=c.exports.useState(["jsonTree","materialDebugger","meta","stats","webglMemory","blendShape","lookAt","validationReport","sampleModels","helpers","exportBufferView","mixamoAnimations","postProcessing","jsEditor","about"]),t=c.exports.useCallback((A,a)=>{const l=o.concat();l.splice(o.indexOf(a),1),l.push(a),e(l)},[o]);let n=0;const r=()=>{const A=0,a=n;return n+=20,{left:A,top:a}},i={jsonTree:s(Ln,{paneKey:"jsonTree",title:"JSON Tree",onClick:t,initPosition:r()},"jsonTree"),materialDebugger:s(_n,{paneKey:"materialDebugger",title:"MToon Material Debugger",onClick:t,initPosition:r()},"materialDebugger"),meta:s(Dn,{paneKey:"meta",title:"Meta",onClick:t,initPosition:r()},"meta"),stats:s(Xn,{paneKey:"stats",title:"Stats",onClick:t,initPosition:r()},"stats"),webglMemory:s(to,{paneKey:"webglMemory",title:"WebGL Memory",onClick:t,initPosition:r()},"webglMemory"),blendShape:s(vn,{paneKey:"blendShape",title:"Blend Shape Proxy",onClick:t,initPosition:r()},"blendShape"),lookAt:s(zn,{paneKey:"lookAt",title:"Look At",onClick:t,initPosition:r()},"lookAt"),validationReport:s(eo,{paneKey:"validationReport",title:"Validation Report",onClick:t,initPosition:r()},"validationReport"),sampleModels:s(Jn,{paneKey:"sampleModels",title:"Sample Models",onClick:t,initPosition:r()},"sampleModels"),helpers:s(Mn,{paneKey:"helpers",title:"Helpers",onClick:t,initPosition:r()},"helpers"),exportBufferView:s(Rn,{paneKey:"exportBufferView",title:"Export Buffer View",onClick:t,initPosition:r()},"exportBufferView"),mixamoAnimations:s(jn,{paneKey:"mixamoAnimations",title:"Mixamo Animations",onClick:t,initPosition:r()},"mixamoAnimations"),postProcessing:s(Wn,{paneKey:"postProcessing",title:"Post Processing",onClick:t,initPosition:r()},"postProcessing"),jsEditor:s(Qn,{paneKey:"jsEditor",title:"JavaScript Editor",onClick:t,initPosition:r()},"jsEditor"),about:s(Cn,{paneKey:"about",title:"About",onClick:t,initPosition:r()},"about")};return s(z,{children:o.map(A=>i[A])})},oo=()=>{const{inspector:o}=c.exports.useContext(P),[e,t]=c.exports.useState(null);c.exports.useEffect(()=>{const r=()=>{t(null)},i=A=>{t(A)};return o.on("load",r),o.on("progress",i),()=>{o.off("load",r),o.off("progress",i)}});const n=c.exports.useMemo(()=>e?e.loaded/e.total:null,[e]);return s(z,{children:s("div",{className:"w-full h-full absolute text-center pointer-events-none",children:s("div",{children:n?(100*n).toFixed(2):"yay"})})})},so=()=>{const{inspector:o}=c.exports.useContext(P),e=c.exports.useCallback(t=>{t&&o.setup(t)},[]);return s(z,{children:M("div",{className:"w-full h-full text-sm absolute overflow-hidden text-gray-100",children:[s("canvas",{ref:e,className:"w-full h-full absolute"}),s(no,{}),s(oo,{})]})})},ro=()=>s(z,{children:s(so,{})});It.render(s(we.StrictMode,{children:s(ro,{})}),document.getElementById("root"));
