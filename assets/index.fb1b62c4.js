var Ye=Object.defineProperty,Ze=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var ne=(n,e,t)=>e in n?Ye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,w=(n,e)=>{for(var t in e||(e={}))Ke.call(e,t)&&ne(n,t,e[t]);if(me)for(var t of me(e))Xe.call(e,t)&&ne(n,t,e[t]);return n},v=(n,e)=>Ze(n,Je(e));var m=(n,e,t)=>(ne(n,typeof e!="symbol"?e+"":e,t),t);import{M as ue,C as oe,a as K,S as se,b as re,F as qe,A as pe,Q as ge,V as fe,c as $e,d as xe,v as et,G as tt,e as nt,f as V,g as Ee,T as Be,h as ot,R as st,i as be,j as rt,k as it,E as at,l as Ce,O as At,U as lt,m as ct,n as ht,o as dt,p as mt,q as ut,r as we,P as pt,s as gt,D as ft,t as xt,u as Et,w as Bt,x as bt,y as Ct,z as wt,B as ie,H as vt,W as Mt,I as Rt,J as It,K as yt,L as kt,N as Pt,X as Lt,Y as Qt,Z as X,_ as ve,$ as zt,a0 as r,a1 as c,a2 as M,a3 as k,a4 as _,a5 as _t,a6 as St}from"./vendor.218d4b61.js";const Ht=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}};Ht();const Tt=new ue({transparent:!0,depthTest:!1,depthWrite:!1});function U(n,e=Tt){const t=new Map;return n.forEach(o=>{Array.isArray(o.material)&&(t.set(o,o.material[0]),o.material[0]=e)}),()=>{for(const[o,s]of t)o.material[0]=s}}const Me=({index:n},{json:e,parser:t})=>{const o=parseInt(n,10);let s;return t.getDependencies("mesh").then(a=>{const i=[];e.meshes.forEach((l,A)=>{l.primitives.forEach((x,p)=>{if(o===x.material){let h=a[A];h.children.length!==0&&(h=h.children[p]);const g=h;i.push(g)}})}),s=U(i)}),()=>{s&&s()}};function Dt(n,e,t){const s=n.parser.json.nodes[e].mesh;if(s==null)return null;const i=n.parser.json.meshes[s].primitives.length,l=[];return t.traverse(A=>{l.length<i&&A.isMesh&&l.push(A)}),l}async function q(n,e){const t=await n.parser.getDependency("node",e);return Dt(n,e,t)}const Nt=({index:n},{gltf:e,json:t})=>{const o=parseInt(n,10);let s;const a=t.nodes,i=[];return a==null||a.forEach((A,d)=>{A.mesh===o&&i.push(d)}),Promise.all(i.map(A=>q(e,A))).then(A=>A.flat()).then(A=>{s=U(A)}),()=>{s&&s()}},Vt=({meshIndex:n,targetIndex:e},{gltf:t,json:o})=>{const s=parseInt(n,10),a=parseInt(e,10);let i;const l=o.nodes,A=[];return l==null||l.forEach((x,p)=>{x.mesh===s&&A.push(p)}),Promise.all(A.map(x=>q(t,x))).then(x=>x.flat()).then(x=>{x.forEach(p=>{p.morphTargetInfluences&&(p.morphTargetInfluences[a]=1)}),i=()=>{x.forEach(p=>{p.morphTargetInfluences&&(p.morphTargetInfluences[a]=0)})}}),()=>{i&&i()}},N={black:"#000000",white:"#ffffff",back1:"#191a1f",fore:"#d0edff",titleBarBg:"#30343b",accent:"#ff0066",gray:"#75848f",uiBackground:"rgba( 25, 26, 31, 0.8 )",error:"#ff0066",warning:"#f7f025",severityInfo:"#53c5ff",constant:"#ff0066",number:"#8a8aff",string:"#f7f025"},Ut=new oe(N.constant),Gt=new K({color:Ut,transparent:!0,wireframe:!0,depthTest:!1,depthWrite:!1}),Ft=new se(.2);function Re(n=Ft){const e=new re(n,Gt);return e.frustumCulled=!1,e.renderOrder=1e4,e}function $(n){const e=new Map;return n.forEach(t=>{const o=Re();t.add(o),e.set(t,o)}),()=>{n.forEach(t=>{const o=e.get(t);t.remove(o)})}}const Ot=({index:n},{parser:e})=>{const t=parseInt(n,10);let o;return e.getDependency("node",t).then(s=>{o=$([s])}),()=>{o&&o()}},jt=({meshIndex:n,primIndex:e},{parser:t})=>{const o=parseInt(n,10),s=parseInt(e,10);let a;return t.getDependency("mesh",o).then(i=>{i.children.length!==0&&(i=i.children[s]),a=U([i])}),()=>{a&&a()}},Ie=({meshIndex:n,primIndex:e,targetIndex:t},{parser:o})=>{const s=parseInt(n,10),a=parseInt(e,10),i=parseInt(t,10);let l;return o.getDependency("mesh",s).then(A=>{A.children.length!==0&&(A=A.children[a]);const d=A;d.morphTargetInfluences&&(d.morphTargetInfluences[i]=1),l=()=>{d.morphTargetInfluences&&(d.morphTargetInfluences[i]=0)}}),()=>{l&&l()}},Wt=({index:n},{gltf:e,json:t})=>{const o=parseInt(n,10);let s;const a=t.nodes,i=[];return a==null||a.forEach((A,d)=>{A.skin===o&&i.push(d)}),Promise.all(i.map(A=>q(e,A))).then(A=>A.flat()).then(A=>{s=U(A)}),()=>{s&&s()}},Yt=({skinIndex:n,jointIndex:e},{inspector:t,gltf:o,json:s,parser:a})=>{const i=parseInt(n,10),l=parseInt(e,10),A=[],d=s.skins[i].joints[l];a.getDependency("node",d).then(g=>{A.push($([g]))});const x=s.nodes,p=[];return x==null||x.forEach((g,u)=>{g.skin===i&&p.push(u)}),Promise.all(p.map(g=>q(o,g))).then(g=>g.flat()).then(g=>{g.forEach(u=>{A.push(t.visualizeWeightPlugin.visualize(u,l))})}),()=>{A.forEach(g=>g())}},Zt={neutral:"neutral",joy:"happy",sorrow:"sad",angry:"angry",fun:"relaxed",a:"aa",e:"ee",i:"ih",o:"oh",u:"ou",blink:"blink",blink_l:"blinkLeft",blink_r:"blinkRight",lookdown:"lookDown",lookleft:"lookLeft",lookright:"lookRight",lookup:"lookUp"},Jt=({index:n},{json:e,inspector:t})=>{var p;const o=parseInt(n,10),i=e.extensions.VRM.blendShapeMaster.blendShapeGroups[o],l=i.presetName,A=i.name,d=l!=null&&(p=Zt[l])!=null?p:A,x=t.model.vrm.expressionManager.getValue(d);return t.model.vrm.expressionManager.setValue(d,1),()=>{t.model.vrm.expressionManager.setValue(d,x)}},Kt={leftThumbProximal:"leftThumbMetacarpal",leftThumbIntermediate:"leftThumbProximal",rightThumbProximal:"rightThumbMetacarpal",rightThumbIntermediate:"rightThumbProximal"},Xt=({index:n},{inspector:e,json:t})=>{var d;const o=parseInt(n,10),a=t.extensions.VRM.humanoid.humanBones[o].bone,i=(d=Kt[a])!=null?d:a,A=e.model.vrm.humanoid.getRawBoneNode(i);return $([A])},qt=new oe(N.constant),$t=({index:n},{json:e,inspector:t,parser:o})=>{const s=parseInt(n,10),i=e.extensions.VRM.secondaryAnimation,l=i==null?void 0:i.boneGroups[s].bones,A=t.model.vrm.springBoneManager,d=new Map;for(const u of A.joints)d.set(u.bone,u);const x=t.helpersPlugin.springBoneJointHelperRoot,p=new Map;x.children.forEach(u=>{const E=u;p.set(E.springBone,E)});const h=[],g=new Set;return l.forEach(u=>{o.getDependency("node",u).then(E=>{E.traverse(B=>{const R=d.get(B),I=p.get(R);g.add(I);const b=I.children[0].material,L=b.color.clone();b.color.copy(qt),h.push(()=>{b.color.copy(L)})})})}),()=>{h.forEach(u=>u())}},ye=({expressionName:n},{inspector:e})=>{const t=e.model.vrm.expressionManager.getValue(n);return e.model.vrm.expressionManager.setValue(n,1),()=>{e.model.vrm.expressionManager.setValue(n,t)}},en=({boneName:n},{inspector:e})=>{const o=e.model.vrm.humanoid.getRawBoneNode(n);return $([o])},tn=new oe(N.constant),nn=({index:n},{json:e,inspector:t,parser:o})=>{const s=parseInt(n,10),a=t.model.vrm.springBoneManager,i=new Map;for(const u of a.joints)i.set(u.bone,u);const l=t.helpersPlugin.springBoneJointHelperRoot,A=new Map;l.children.forEach(u=>{const E=u;A.set(E.springBone,E)});const d=[],h=e.extensions.VRMC_springBone.springs[s].joints.map(u=>u.node),g=new Set;return h.map(u=>{o.getDependency("node",u).then(E=>{const B=i.get(E);if(B==null)return;const R=A.get(B);if(R==null)return;g.add(R);const C=R.children[0].material,b=C.color.clone();C.color.copy(tn),d.push(()=>{C.color.copy(b)})})}),()=>{d.forEach(u=>u())}},ke=(n,{inspector:e})=>(e.layerMode="firstPerson",()=>{e.layerMode="thirdPerson"}),Pe=(n,{inspector:e})=>{const t=Re();return e.model.vrm.lookAt.getLookAtWorldPosition(t.position),e.scene.add(t),()=>{e.scene.remove(t)}};class on{constructor(e){m(this,"_inspector");m(this,"_rules");this._inspector=e,this._rules=[["/nodes/:index",Ot],["/meshes/:index",Nt],["/meshes/:meshIndex/primitives/:primIndex",jt],["/meshes/:meshIndex/primitives/:primIndex/targets/:targetIndex",Ie],["/meshes/:meshIndex/primitives/:primIndex/extras/targetNames/:targetIndex",Ie],["/meshes/:meshIndex/extras/targetNames/:targetIndex",Vt],["/skins/:index",Wt],["/skins/:skinIndex/joints/:jointIndex",Yt],["/materials/:index",Me],["/extensions/VRM/materialProperties/:index",Me],["/extensions/VRM/humanoid/humanBones/:index",Xt],["/extensions/VRM/firstPerson/firstPersonBoneOffset",Pe],["/extensions/VRM/firstPerson/meshAnnotations",ke],["/extensions/VRM/blendShapeMaster/blendShapeGroups/:index",Jt],["/extensions/VRM/secondaryAnimation/boneGroups/:index",$t],["/extensions/VRMC_vrm/humanoid/humanBones/:boneName",en],["/extensions/VRMC_vrm/expressions/preset/:expressionName",ye],["/extensions/VRMC_vrm/expressions/custom/:expressionName",ye],["/extensions/VRMC_vrm/firstPerson/meshAnnotations",ke],["/extensions/VRMC_vrm/lookAt/offsetFromHeadBone",Pe],["/extensions/VRMC_springBone/springs/:index",nn]]}highlight(e){const t=this._inspector,o=e.split("/"),s=t.model.gltf,a=s.parser,i=a.json,l={inspector:t,gltf:s,parser:a,json:i};let A={};const d=this._rules.find(([x])=>{const p=x.split("/");return o.length!==p.length?!1:(A={},o.every((h,g)=>{const u=p[g];if(u.startsWith(":")){const E=u.substring(1);return A[E]=h,!0}else return h===u}))});if(d!=null)return d[1](A,l)}}class sn{constructor(){m(this,"_eventListeners")}on(e,t){this._eventListeners=this._eventListeners||new Map;let o=this._eventListeners.get(e);o||(o=[],this._eventListeners.set(e,o)),o.push(t)}off(e,t){this._eventListeners=this._eventListeners||new Map;let o=this._eventListeners.get(e);o||(o=[],this._eventListeners.set(e,o));const s=o.indexOf(t);s!==-1&&o.splice(s,1)}_emit(...[e,t]){var o;this._eventListeners=this._eventListeners||new Map,(o=this._eventListeners.get(e))==null||o.forEach(s=>s(t))}}const rn={mixamorigHips:"hips",mixamorigSpine:"spine",mixamorigSpine1:"chest",mixamorigSpine2:"upperChest",mixamorigNeck:"neck",mixamorigHead:"head",mixamorigLeftShoulder:"leftShoulder",mixamorigLeftArm:"leftUpperArm",mixamorigLeftForeArm:"leftLowerArm",mixamorigLeftHand:"leftHand",mixamorigLeftHandThumb1:"leftThumbMetacarpal",mixamorigLeftHandThumb2:"leftThumbProximal",mixamorigLeftHandThumb3:"leftThumbDistal",mixamorigLeftHandIndex1:"leftIndexProximal",mixamorigLeftHandIndex2:"leftIndexIntermediate",mixamorigLeftHandIndex3:"leftIndexDistal",mixamorigLeftHandMiddle1:"leftMiddleProximal",mixamorigLeftHandMiddle2:"leftMiddleIntermediate",mixamorigLeftHandMiddle3:"leftMiddleDistal",mixamorigLeftHandRing1:"leftRingProximal",mixamorigLeftHandRing2:"leftRingIntermediate",mixamorigLeftHandRing3:"leftRingDistal",mixamorigLeftHandPinky1:"leftLittleProximal",mixamorigLeftHandPinky2:"leftLittleIntermediate",mixamorigLeftHandPinky3:"leftLittleDistal",mixamorigRightShoulder:"rightShoulder",mixamorigRightArm:"rightUpperArm",mixamorigRightForeArm:"rightLowerArm",mixamorigRightHand:"rightHand",mixamorigRightHandPinky1:"rightLittleProximal",mixamorigRightHandPinky2:"rightLittleIntermediate",mixamorigRightHandPinky3:"rightLittleDistal",mixamorigRightHandRing1:"rightRingProximal",mixamorigRightHandRing2:"rightRingIntermediate",mixamorigRightHandRing3:"rightRingDistal",mixamorigRightHandMiddle1:"rightMiddleProximal",mixamorigRightHandMiddle2:"rightMiddleIntermediate",mixamorigRightHandMiddle3:"rightMiddleDistal",mixamorigRightHandIndex1:"rightIndexProximal",mixamorigRightHandIndex2:"rightIndexIntermediate",mixamorigRightHandIndex3:"rightIndexDistal",mixamorigRightHandThumb1:"rightThumbMetacarpal",mixamorigRightHandThumb2:"rightThumbProximal",mixamorigRightHandThumb3:"rightThumbDistal",mixamorigLeftUpLeg:"leftUpperLeg",mixamorigLeftLeg:"leftLowerLeg",mixamorigLeftFoot:"leftFoot",mixamorigLeftToeBase:"leftToes",mixamorigRightUpLeg:"rightUpperLeg",mixamorigRightLeg:"rightLowerLeg",mixamorigRightFoot:"rightFoot",mixamorigRightToeBase:"rightToes"};async function an(n,e){const t=e.humanoid;if(t==null)return null;const s=await new qe().loadAsync(n),i=s.children[0].position.y,d=t.normalizedRestPose.hips.position[1]/i,x=pe.findByName(s.animations,"mixamo.com"),p=[];return x.tracks.forEach(h=>{var B;const g=h.name.split("."),u=g[0],E=rn[u];if(E!=null){const R=(B=t.getNormalizedBoneNode(E))==null?void 0:B.name;if(R!=null){const I=g[1];if(h instanceof ge){const C=h.values.map((b,L)=>{var S;return((S=e.meta)==null?void 0:S.metaVersion)==="0"&&L%2==0?-b:b});p.push(new ge(`${R}.${I}`,h.times,C))}else if(E==="hips"&&h instanceof fe){const C=h.values.map((b,L)=>{var S;return(((S=e.meta)==null?void 0:S.metaVersion)==="0"&&L%3!=1?-b:b)*d});p.push(new fe(`${R}.${I}`,h.times,C))}}}}),new pe("vrmAnimation",x.duration,p)}class An{constructor(e){m(this,"inspector");m(this,"_currentAnimationMixer");m(this,"_currentAnimationAction");m(this,"_currentAnimationURL");this.inspector=e}handleAfterLoad(e){const t=e.vrm;t!=null&&(this._currentAnimationMixer=new $e(t.humanoid.normalizedHumanBonesRoot),this._currentAnimationURL!=null&&this.loadMixamoAnimation(this._currentAnimationURL))}handleAfterUnload(){this._currentAnimationAction=null,this._currentAnimationMixer=null}handleBeforeRender(e){this._currentAnimationMixer!=null&&this._currentAnimationMixer.update(e)}loadMixamoAnimation(e){var s;const t=(s=this.inspector.model)==null?void 0:s.vrm;if(!t)return;const o=this._currentAnimationMixer;!o||(this._currentAnimationAction!=null&&this.clearMixamoAnimation(),an(e,t).then(a=>{a&&(this._currentAnimationURL=e,this._currentAnimationAction=o.clipAction(a),this._currentAnimationAction.play())}))}clearMixamoAnimation(){var o;const e=(o=this.inspector.model)==null?void 0:o.vrm;if(!e)return;const t=this._currentAnimationAction;!t||(this._currentAnimationURL=null,t.stop(),this._currentAnimationAction=null,e.humanoid.resetNormalizedPose())}}class ln{constructor(e){m(this,"inspector");m(this,"_controls");this.inspector=e}get controls(){return this._controls}handleAfterSetup(){const{camera:e,canvas:t}=this.inspector;this._controls=new xe(e,t),this._controls.setTarget(0,1,0)}handleBeforeRender(e){this._controls&&this._controls.update(e)}}class ae{constructor(e){m(this,"inspector");m(this,"__validationReport");this.inspector=e,this.__validationReport=null}static get VALIDATOR_MAX_ISSUES(){return 100}get validationReport(){return this.__validationReport}async validate(e=ae.VALIDATOR_MAX_ISSUES){var s;const t=(s=this.inspector.model)==null?void 0:s.buffer;if(!t)return null;const o=await et(new Uint8Array(t),{maxIssues:e}).catch(a=>console.error("Validation failed: ",a));return this.__validationReport=o,o}handleAfterLoad(){this.validate()}handleAfterUnload(){this.__validationReport=null}}class cn{constructor(e){m(this,"inspector");m(this,"gridHelper");m(this,"axesHelper");m(this,"humanoidHelperRoot");m(this,"lookAtHelperRoot");m(this,"springBoneJointHelperRoot");m(this,"springBoneColliderHelperRoot");this.inspector=e,this.gridHelper=new tt(10,10),e.scene.add(this.gridHelper),this.axesHelper=new nt(5),e.scene.add(this.axesHelper),this.humanoidHelperRoot=new V,this.humanoidHelperRoot.renderOrder=1e4,e.scene.add(this.humanoidHelperRoot),this.lookAtHelperRoot=new V,this.lookAtHelperRoot.renderOrder=1e4,e.scene.add(this.lookAtHelperRoot),this.springBoneJointHelperRoot=new V,this.springBoneJointHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneJointHelperRoot),this.springBoneColliderHelperRoot=new V,this.springBoneColliderHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneColliderHelperRoot)}handleAfterUnload(){this.humanoidHelperRoot.children.concat().forEach(e=>{this.humanoidHelperRoot.remove(e),e.dispose()}),this.springBoneJointHelperRoot.children.concat().forEach(e=>{this.springBoneJointHelperRoot.remove(e),e.dispose()}),this.springBoneColliderHelperRoot.children.concat().forEach(e=>{this.springBoneColliderHelperRoot.remove(e),e.dispose()}),this.lookAtHelperRoot.children.concat().forEach(e=>{this.lookAtHelperRoot.remove(e),e.dispose()})}}function Le(n,e){let t=!1,o,s={x:0,y:0};const a=()=>{t||(requestAnimationFrame(a),o&&(n(o,s),o=void 0,s={x:0,y:0}))};a();const i=A=>{o=A,s.x+=A.movementX,s.y+=A.movementY},l=A=>{t||(e&&e(A),t=!0),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",l),window.removeEventListener("mousedown",l)};window.addEventListener("mousemove",i),window.addEventListener("mouseup",l),setTimeout(()=>window.addEventListener("mousedown",l))}var hn="./assets/grab-purple.7ef5ea20.png";const Qe=new Ee;class dn{constructor(e){m(this,"inspector");m(this,"_sprites");m(this,"_transformControls");m(this,"_spriteMaterial");m(this,"_raycaster");m(this,"_active");this.inspector=e;const o=new Be().load(hn,s=>{s.flipY=!1});this._spriteMaterial=new ot({sizeAttenuation:!1,transparent:!0,depthTest:!1,map:o}),this._raycaster=new st,this._active=!0}get active(){return this._active}set active(e){var t,o;this._active=e,(t=this._sprites)==null||t.forEach(s=>s.visible=e),e===!1&&((o=this._transformControls)==null||o.detach())}handleAfterSetup(){const{scene:e,camera:t,canvas:o}=this.inspector;this._transformControls=new be(t,o),this._transformControls.space="local",this._transformControls.mode="rotate",e.add(this._transformControls),this._transformControls.addEventListener("dragging-changed",s=>{const a=this.inspector.cameraControlsPlugin.controls;a&&(a.enabled=!s.value)}),o!=null&&(o==null||o.addEventListener("mousedown",s=>this.handleMouseDown(s)))}handleAfterLoad(e){var o;const t=(o=e.vrm)==null?void 0:o.humanoid;if(t!=null){this._sprites=[];for(const s of Object.values(t.normalizedHumanBones)){const a=s.node,i=new rt(this._spriteMaterial);i.scale.setScalar(.01),i.renderOrder=1e4,i.visible=this._active,a.add(i),this._sprites.push(i)}}}handleAfterUnload(){var e;this._sprites=null,(e=this._transformControls)==null||e.detach()}handleMouseDown(e){const{camera:t,canvas:o}=this.inspector;if(o==null)return;const s=this._sprites;if(s==null)return;const a=this._transformControls;if(a==null)return;const i=o.getBoundingClientRect();Qe.set((e.clientX-i.left)/i.width*2-1,-(e.clientY-i.top)/i.height*2+1),this._raycaster.setFromCamera(Qe,t);const A=this._raycaster.intersectObjects(s,!1)[0],d=Date.now();Le(()=>0,()=>{if(!(Date.now()-d>300))if(A!=null){const h=A.object.parent;a.attach(h)}else a.detach()})}}class mn{constructor(e){m(this,"inspector");m(this,"root");m(this,"ballOutside");m(this,"ballInside");m(this,"isActive");this.inspector=e,this.root=new V,e.scene.add(this.root),this.ballInside=new re(new se(.01),new K({color:4456584,depthTest:!1,depthWrite:!1})),this.ballInside.renderOrder=10001,this.root.add(this.ballInside),this.ballOutside=new re(new se(.01),new it({color:16777215})),this.ballOutside.renderOrder=10001,this.root.add(this.ballOutside),this.isActive=!0}handleBeforeRender(){if(!this.isActive){this.root.visible=!1;return}const{model:e}=this.inspector,t=e==null?void 0:e.vrm,o=t==null?void 0:t.lookAt;if(o==null){this.root.visible=!1;return}this.root.visible=!0,o==null||o.getLookAtWorldPosition(this.root.position)}}const ze=new Ce,un=new at;class pn{constructor(e){m(this,"inspector");m(this,"_enableLookAt");m(this,"_lookAtTarget");m(this,"_transformControls");this.inspector=e,this._enableLookAt=!1,this._lookAtTarget=new At,e.scene.add(this._lookAtTarget)}get enableLookAt(){return this._enableLookAt}set enableLookAt(e){this._enableLookAt=e,this._transformControls&&(this._transformControls.enabled=e,this._transformControls.visible=e),e?this._enableLookAtTarget():this._disableLookAtTarget()}handleAfterSetup(){const{scene:e,camera:t,canvas:o}=this.inspector;this._transformControls=new be(t,o),e.add(this._transformControls),this._transformControls.attach(this._lookAtTarget),this._transformControls.enabled=!1,this._transformControls.visible=!1,this._transformControls.addEventListener("dragging-changed",s=>{const a=this.inspector.cameraControlsPlugin.controls;a&&(a.enabled=!s.value)})}handleAfterLoad(e){var s;const{vrm:t}=e;if(t==null)return;const o=(s=t.humanoid)==null?void 0:s.getNormalizedBoneNode("head");o!=null&&(o.getWorldPosition(ze),this._lookAtTarget.position.set(0,0,5).add(ze)),this._enableLookAt&&this._enableLookAtTarget()}_enableLookAtTarget(){var t,o;const e=(o=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:o.lookAt;!e||(e.target=this._lookAtTarget)}_disableLookAtTarget(){var t,o;const e=(o=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:o.lookAt;!e||(e.target=void 0,e.applier.lookAt(un.set(0,0,0)))}}class gn{constructor(e){m(this,"inspector");m(this,"bloomPass");m(this,"toneMappingPass");this.inspector=e,this.bloomPass=new lt(new Ee(4,4),1,.5,1),this.bloomPass.enabled=!1,this.toneMappingPass=new ct(ht),this.toneMappingPass.enabled=!1}handleAfterSetup(){const e=this.inspector.composer;e.addPass(this.bloomPass),e.addPass(this.toneMappingPass)}}class fn extends ue{constructor(e){super(e);m(this,"_skinIndexVisualize");m(this,"_uniforms");this._skinIndexVisualize=0,this.onBeforeCompile=t=>{this._uniforms=t.uniforms,this._uniforms.skinIndexVisualize={value:this._skinIndexVisualize},t.vertexShader=t.vertexShader.replace("#include <common>",`#include <common>

        varying float vWeightVisualize;
        uniform float skinIndexVisualize;`),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`#ifdef USE_SKINNING
          vWeightVisualize = (
            skinIndex.x == skinIndexVisualize ? skinWeight.x : 0.0 +
            skinIndex.y == skinIndexVisualize ? skinWeight.y : 0.0 +
            skinIndex.z == skinIndexVisualize ? skinWeight.z : 0.0 +
            skinIndex.w == skinIndexVisualize ? skinWeight.w : 0.0
          );
        #else
          vWeightVisualize = 0.0;
        #endif

        #include <begin_vertex>`),t.fragmentShader=t.fragmentShader.replace("#include <packing>",`#include <packing>

        varying float vWeightVisualize;`),t.fragmentShader=t.fragmentShader.replace("gl_FragColor = vec4( packNormalToRGB( normal ), opacity );",`gl_FragColor = vec4(
          clamp( 2.0 - abs( vec3( 4.0, 2.0, 0.0 ) - 4.0 * vWeightVisualize ), 0.0, 1.0 ),
          opacity
        );`)}}get skinIndexVisualize(){return this._skinIndexVisualize}set skinIndexVisualize(e){this._uniforms&&(this._uniforms.skinIndexVisualize={value:e}),this._skinIndexVisualize=e}}class xn{constructor(e){m(this,"inspector");m(this,"boneIndexMap");this.inspector=e}visualize(e,t){if(!(e instanceof dt))return()=>0;const s=this.boneIndexMap.get(e.skeleton).get(t),a=new fn({transparent:!0,depthTest:!1,depthWrite:!1});a.skinIndexVisualize=s;const i=U([e],a);return()=>{i(),a.dispose()}}}function En(n,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(o=>{Object.defineProperty(n.prototype,o,Object.getOwnPropertyDescriptor(t.prototype,o))})})}function Bn(n,e){const t=new Set,o=n.material;if(Array.isArray(o))o.forEach(a=>{t.add(a)});else{const s=o;t.add(s)}for(const s of t)e(s)}function bn(n){const e=new Map,t=new Map;return n.traverse(o=>{if(o.type!=="SkinnedMesh")return;const s=o,i=s.geometry.getAttribute("skinIndex");let l=t.get(i);if(!l){const A=[],d=[],x=new Map,p=i.array;for(let h=0;h<p.length;h++){const g=p[h];let u=x.get(g);u==null&&(u=A.length,x.set(g,u),A.push(s.skeleton.bones[g]),d.push(s.skeleton.boneInverses[g])),p[h]=u}i.copyArray(p),i.needsUpdate=!0,l=new mt(A,d),t.set(i,l),e.set(l,x)}s.bind(l,new ut)}),e}var Cn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQQBBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAH7v5JqzrodJxSqKZUVyCEgj6EZBH0IyCMgjIPPQ8kEZB5IOwqeJbISlsqmFVgVTCEpSE5SuctkJxZCZZCZZCZZGZZCwITDrvqOe5Si6Wznvls57osouLKLiyi4souLKbiym4spuKpvCm4Sq4squLNHQma5ujrlLm6OuUubo65y5mlpnLmaWmcuZpaZy5mlpnLmaWmcubpaZy5ujpnLnaPecudo6Zy5+hpnLwaGmcvB36Zy5bzvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/8QAIBABAQEBAAIABwAAAAAAAAAAABIREwECAwQQFDBQcP/aAAgBAQABBQL39vWPm/Hivb833ftnxPenn9DjGMZ9MYxjGMYxjGMYxjGMYxjEpSlKUpSlKUpSlCEIQhCEIQhCEIcnJxcXFxcXFxcXFxcXJycv4D//xAAbEQEBAAIDAQAAAAAAAAAAAAAAEQEwAhJgcP/aAAgBAwEBPwFy39mc775CIiIiIiIiIifAf//EABwRAQEBAAMAAwAAAAAAAAAAAAATEQESMAJQcP/aAAgBAgEBPwF8Pfo4498Z9/rWt8ta1RRRRRRRRRRRRRRR3/Af/8QAGRAAAgMBAAAAAAAAAAAAAAAAATEAITBw/9oACAEBAAY/AjYUO77h/8QAHhABAQEAAQQDAAAAAAAAAAAAABEBIRAgMEFQUWD/2gAIAQEAAT8hpdhXtxr7YbidIndERnCrru4iIiIiIiIrda3ERERERERERuN7QTxgPvn83m/HAAH/AP2fzcuV1dXV1dXf3P8A/9oADAMBAAIAAwAAABD1v+TzxSRCCCBACADDAiKLNsvk00302/8AvbJpdNFF1BBwgxRRMk0QwyyyyCSf/wD407777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDnDndwzOhLnvM6uXRyzMz2M7szOjOzMzMzPhKUpSlKUpzn6nKcvsSIiIiIiIiIi//EABwRAQEBAQADAQEAAAAAAAAAABEAUQEQIDBAcP/aAAgBAgEBPxDnOt10ufbvMdz1Ij1I8hHg+Z8j5kfJ/IDMzM8nkzz0A2Gw2Gx2Ox2Ox2Ow2Gw2Gw2O/wAB/8QAIBABAQACAgMBAAMAAAAAAAAAAQARUWGREHGhIDAxYP/aAAgBAQABPxASIw/o5ye7N8cZWFfExJ8GLFixY8hE58WNyNVzmOV8TGP8IAJmTsc+FrWv6/KUq58kYx/ZAhCMY+AxjH85IQhHjPG4Zep4zxnjPGz1el6XrHCOMcY4ytStS9S9S9S9S9S9S9WerLULULULULUPU8D5PE+TwJeiVol6JeiXqXo+Weiy0WerPVno+WWi9Szs9tnZ7bke25HtuR7bke25HtuR7bLt7bLt7bLt7bLt7bLt7bLt7bLt7bLt7f8AY//Z",wn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDAgT/2gAMAwEAAhADEAAAAc6XpYoSCEpSEpSMoISCPQ50OdDnQ5IOdDklOSlOSDnQssWKpylc4srmWVzLK5lQmFcwhMITCMwhMIzEjMsjMsjML76Tz3lnm9BZ5ryzz3lnnvK898pRdKUXylF8pTdKU3ylN8pTeFVwVXCe7Rma5ujpnLm6WmcuXp6Zy5enpnLl6eucuXp6Zy5enpnLl6emcuZp98S5ul3nLm6Wmcudo6Zy5+hpnL4NDTOXwe/TOXLed6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITMFBw/9oACAEBAAEFAvRTzRERERERERERERERERERERGWWWWWWWWWWWWWWWWHNzc3Nzc3NzYYYYYYYcnFxcXBwcHBwcHFxcXFycvgP//EABcRAQEBAQAAAAAAAAAAAAAAABEAYHD/2gAIAQMBAT8B2BERERERERERwH//xAAbEQEBAQEAAwEAAAAAAAAAAAAAExEBEjBgcP/aAAgBAgEBPwH6DWt9etaoooooopxTinFOKKKKKPP8B//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEABj8CAH//xAAcEAEBAQADAAMAAAAAAAAAAAARAAEQMEBQYHH/2gAIAQEAAT8hIiOkjgiIiIiIiIiIiI4ERERERERHwYAAf/8A++DwAt8wD9YfjoZOzs7Ozs7O/ev/2gAMAwEAAgADAAAAEBAOuj73333736qgkCm3XVdBNNNBNNRXX8QYcQQqmqqmqqoAEemjrrgkssqz7z0w07777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABsRAQEBAAIDAAAAAAAAAAAAABEAIEBREDBg/9oACAEDAQE/EJ4b6HTlmds+WdM4cM7Z2zPKU5SlKc5zn1PqU5S+xIiIiIiIiIiL/8QAHREBAQEAAgMBAQAAAAAAAAAAEQBRMGEBECBAcP/aAAgBAgEBPxD8B8HOcRxERHIfJH5gTM+J8TMzM+g9BsNhsdjsdu67rsuyOw2Gw2Gx3+A//8QAHRABAQADAQEBAQEAAAAAAAAAAQARUWGRIHFgof/aAAgBAQABPxBjGMSxYsWLFixEIERrGsY/ICEIQhGtY1r9flKUpWtaxjH5AQhCEa1rWMfkBCEIR4ni4TxPErU835s9Wer8xzHMcxzHMvUrUmpWpWpWpWpWrLVnqz1D1D1C1C1D1fknklaP8l6JWiVol6JeiVpK0WerLRZ6LLRZavyXR9bo+t0fW6PrdH1uj63R9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9f7H/9k=",vn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAasKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQABBQIAf//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8BAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/AQB//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQAGPwIAf//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEAAT8hAH//2gAMAwEAAgADAAAAEM8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8QAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/EAB//8QAFhABAQEAAAAAAAAAAAAAAAAAABFw/9oACAEBAAE/ENwiIiIiIiIiIj//2Q==",Mn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAQEBAQEAAAAAAAAAAAAAAQACAwQG/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAAB+6+NdXO8q2eY0ywUAEBCCWEWCAgICBrIaA0WHo5qb5y2OJSEIsICAcggICCoQgaAQNAdCiAhCAgICBYBAQEBAYEJdBGgN1BQEABAsBSEWFBQUCA1g1CBqI1AQEBARRIEFBQUFBQME0SDEagICAiwiilBgIKCgoJCVKBiGDSGYBDKGUsIoQGUGUGUEKCRJCQkFUywZQygIZQEsEszosEsEBCQkJCg/8QAHRAAAQQCAwAAAAAAAAAAAAAAAgADERIBMAQUcP/aAAgBAQABBQIzCnLixbu2UOOWWd1lPr//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQMBAT8BJb2G+3//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQIBAT8BIb0Eu3//xAAZEAACAwEAAAAAAAAAAAAAAAABMQAhMHD/2gAIAQEABj8CNhQ7vuH/xAAgEAEAAgEDBQEAAAAAAAAAAAABABEQIDBgITFAQVBR/9oACAEBAAE/Ib+sK9k7F+4Om9Fy8nRWwHHeMrHduXF4c8AfAfof/9oADAMBAAIAAwAAABC0w8HDHUfe8+/9+8colvcc/wDf/LKL/P8A38MRzzz2sAAAEIMm34b7/wBrCRSyyxyQBAP+++sATwwwwxwyCAM888EBixwxxyyhBP8Av/vnhQgIIIgQxnvvrPv/AD9xQYRV9/zz3//EABwRAAEDBQAAAAAAAAAAAAAAAAEQEUAAITBQcP/aAAgBAwEBPxAmyDABVsb0+gEATxxD/8QAGxEAAwADAQEAAAAAAAAAAAAAAAERECAwUGD/2gAIAQIBAT8QSdGcFvdKXEUgLtCfUXK6P0J7H//EAB0QAQEBAQACAwEAAAAAAAAAAAEAERAgMSFBUWH/2gAIAQEAAT8QAAo+E3T+MW/rq9mUsssvGtra9Nhl75Z+zpV23WUsstttttttsMNr9nfu3lLLLbbbbbbbDbMeBZZZZbbbbbYYYZZZZZZZZbbbbbYYYlllllllttttthhhiWWWWWWW223mxERLMyyyz5ERHDMzM93hERE+5mZmeMcIiImZmZ8iIiJmZmZ5llkEEEEcMzMlllllkEEEEEJmSSSyyyyyCCCCCZJJJLLLLLLIIIIIJJJJLLLLLLLIIIIIL//Z",Rn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQEEBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAHOl6WKEgjII9CMgjIIyDnQ5IOdDkg5IEglKDSo466n3HyWGuueJPRwrsCuZZXMshMshMshMshNbIzlIylIzCNgRmCUtnUtnUtkbhKLiyi4sovKouCm4Sm4spuLKriyq4squLKriyq9bKrpbKrpSq+Cfvma5+hpnLnaGmcudo6Zy52jpnLnaOucudpaZy5ulpnLnaWmcudpaZy52lpnLnaWmcufo6Zy5+jplLn6OuUvg0NM5cN53oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/EACEQAQEBAQABAgcAAAAAAAAAAAASERMCATADBBAUIEBw/9oACAEBAAEFAvd8Xynp6V4eXjHu+j4fnL7vyz9DGMYxjPpjGMZ+GMYxjGMYxjGMYxKUpSlKUpSlKUpQhCEIQhCEIQhCHJycnFxcXFxcXFxcXFxcnL+A/wD/xAAcEQEBAAICAwAAAAAAAAAAAAARAAFAAhIwYHD/2gAIAQMBAT8B83HQxm7aD6CREREREREREfAf/8QAHREBAQEAAgIDAAAAAAAAAAAAABMRATACEkBQcP/aAAgBAgEBPwHu8/gc8PTvxn2Otb1a1rXuoooooooooooooop+A//EABoQAAICAwAAAAAAAAAAAAAAAAExACEwQHD/2gAIAQEABj8CzCCwtB9h/8QAHxABAQEAAQMFAAAAAAAAAAAAABEBIRAgMEBBUFFg/9oACAEBAAE/IYid0TpGYw519qXIR7oiIiIiIiMzr28KkRERERERGYxmr4AE7QwzETy+z56HwAGfFh//ANn87q6urq6uuXP7H//aAAwDAQACAAMAAAAQAgAQgggQkU88k/b9/vN9NNN5LbziiIwwRRxgwBB1FFNdpJbvTj//AH0gsssssENJDL777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDDM4d+MOO7iDJ0curPYZmZ1Zmd2cszMzM7M+CpynP1OcpSlKUpS+xIiIiIiIiIiL//xAAcEQEBAQEBAQADAAAAAAAAAAARAFEBMCAQQHD/2gAIAQIBAT8Q9e3XS7zrEfJEfPZ7nPmfgjwDyPIj9V+A8meTyZmZ+QOw2Gw2Gw2Ox2Ox2Ox2Gw2Gw3+A/wD/xAAgEAEBAAICAwEAAwAAAAAAAAABABFRYZEQcaEgMDFg/9oACAEBAAE/EHyMWLFix4ECPCypZvjjCUCEP6GMHuf4QAQh4RwkjEcYg48WNzWv6/KUp4pxOWbMY/sEQh5CQcxjH8pKQh4BCEeM8Z4zwvW9L0hajjHGOMcYerhjjHGXqVqVqVqVqy1Z6h6h6h6h6h6h6h6hahavUstFno+WerPVlos9EPR8h6h6IeiFoh6I4EcT5HA+WXb22Xb22Xb22Xb22Xb22Xb22Xb22Xb23I9tyPbcj23I9tyPbcj22dnts7Pb/sf/2Q==",In="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAc7vSxRkEJSkJSkewRkEehzoc6HOhyQckEZKclKckHJBKZFcyyuZZXMsrmVCYVzCEwhMIzCEwjMSMyyMyyM1I2Sk7hKLivPeHnvlPPfKUXSlF8pRfKU3SlN8pTeFN4lN5ZT6Cym8spvLL/fM1z9DTOXO0NM5c7R0zlzdLTOXN0tM5czT08S5mnpnLm6emcubp6Zy5unpnLm6fvOXN09M5c7S0zlztHTOXP0dM5cVzugAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITEFBw/9oACAEBAAEFAvWzzEREREREREREREREREREREZZZZZZZZZZZZZZZZYYYYYYYc3Nzc3Nzc3NhycnFxcXFwcHBwcHBxcXFy+A/wD/xAAXEQEBAQEAAAAAAAAAAAAAAAARAGBw/9oACAEDAQE/AdgREREREREREcB//8QAGxEBAQEBAAMBAAAAAAAAAAAAABMRARIwYHD/2gAIAQIBAT8B+g1rfXrWvNRRRRRTinFOKcUUUUUU/Af/xAAUEAEAAAAAAAAAAAAAAAAAAACA/9oACAEBAAY/AgB//8QAHBABAQEAAwADAAAAAAAAAAAAEQABEDBAUGBx/9oACAEBAAE/ITgjpIiIiIiIiIiIiIiIiIiIiIjgR8cAAH//AIAfPB34GdRTfjxBrs7Ozs7Ozv3H/9oADAMBAAIAAwAAABBAKqp+9999+8/roAR90XXQTTTQTRV11spECCqpqqpqoIHGEHFMNM+8+vLJIK645rq+++++++++++++++888888888888888888888888888888888888888888888888//xAAbEQEBAAIDAQAAAAAAAAAAAAARACAwEEBRYP/aAAgBAwEBPxDc4uh1szi5M5M8s8s5s4OpmeqpTlPyfk5znKUpTl9iREREREREREX/xAAdEQEBAQABBQEAAAAAAAAAAAARAFFhARAgMEBw/9oACAECAQE/EPrPA7nqPSREesjxPoDsZmZmek9JmHcOw2Gw2Gx25Lkua5o7HY7DYbDfwH//xAAdEAEBAAMBAQEBAQAAAAAAAAABABFRYZEgcWCh/9oACAEBAAE/EGJMZixYsWLFiCIQhGMYxj8gIQhSFa1rX6/KUpClYxjH5AQhCFKVjGMfkBCEKUpXmeZ5nmeb82erPV+Y5hajiOLhHEcS9StStS9S9WerPVlqFqFqFqFqFqTULUPV+Sy1ZaLPRZaLPULRC0h6IeiFohaIeiFo/wAjkvyWXb62Xb62Xb62Xb62Xb62Xb62Xb62Xb62Xb63R9bo+t0fW6PrdH1uj63R9f7H/9k=";const yn=new Ce;xe.install({THREE:we});class _e{constructor(){m(this,"animationPlugin");m(this,"cameraControlsPlugin");m(this,"gltfValidatorPlugin");m(this,"helpersPlugin");m(this,"humanoidTransformPlugin");m(this,"lookAtPlugin");m(this,"lookAtBallPlugin");m(this,"postProcessingPlugin");m(this,"visualizeWeightPlugin");m(this,"_scene");m(this,"_camera");m(this,"_renderer");m(this,"_composer");m(this,"_model");m(this,"_stats",null);m(this,"_webglMemory",null);m(this,"_webglMemoryInfo",null);m(this,"_dracoLoader");m(this,"_loader");m(this,"_canvas");m(this,"_layerMode","thirdPerson");m(this,"_handleResize");m(this,"_ongoingRequestEnvMap");m(this,"_plugins");this._camera=new pt(30,window.innerWidth/window.innerHeight,.1,20),this._camera.position.set(0,1,5),this._scene=new gt;const e=new ft(16777215);e.position.set(1,1,1).normalize(),this._scene.add(e),this.helpersPlugin=new cn(this),this._dracoLoader=new xt,this._dracoLoader.setDecoderPath("./draco/"),this._loader=new Et,this._loader.setDRACOLoader(this._dracoLoader),this._loader.register(t=>new Bt(t,{humanoidPlugin:new bt(t,{helperRoot:this.helpersPlugin.humanoidHelperRoot}),lookAtPlugin:new Ct(t,{helperRoot:this.helpersPlugin.lookAtHelperRoot}),springBonePlugin:new wt(t,{jointHelperRoot:this.helpersPlugin.springBoneJointHelperRoot,colliderHelperRoot:this.helpersPlugin.springBoneColliderHelperRoot})})),this.animationPlugin=new An(this),this.cameraControlsPlugin=new ln(this),this.gltfValidatorPlugin=new ae(this),this.humanoidTransformPlugin=new dn(this),this.lookAtPlugin=new pn(this),this.lookAtBallPlugin=new mn(this),this.postProcessingPlugin=new gn(this),this.visualizeWeightPlugin=new xn(this),this._plugins=[this.animationPlugin,this.cameraControlsPlugin,this.gltfValidatorPlugin,this.helpersPlugin,this.humanoidTransformPlugin,this.lookAtPlugin,this.lookAtBallPlugin,this.postProcessingPlugin,this.visualizeWeightPlugin]}get scene(){return this._scene}get camera(){return this._camera}get renderer(){return this._renderer}get composer(){return this._composer}get model(){var e;return(e=this._model)!=null?e:null}get stats(){return this._stats}get webglMemoryInfo(){return this._webglMemoryInfo}get canvas(){return this._canvas}get layerMode(){return this._layerMode}set layerMode(e){this._layerMode=e,this._updateLayerMode()}unloadVRM(){const e=this._model;e&&(this._scene.remove(e.scene),ie.deepDispose(e.scene),this._emit("unload")),this._plugins.forEach(t=>{var o;return(o=t.handleAfterUnload)==null?void 0:o.call(t)}),this._model=null}async loadVRM(e){var d,x,p,h,g;const t=await fetch(e).then(u=>u.arrayBuffer());this.unloadVRM();const s=new vt({credentials:"include"}).binaryToJSON(t).json,a=await new Promise((u,E)=>{this._loader.crossOrigin="anonymous",this._loader.load(e,B=>{u(B)},B=>{this._emit("progress",B)},B=>{this._emit("error",B),E(B)})});ie.removeUnnecessaryVertices(a.scene),this.visualizeWeightPlugin.boneIndexMap=bn(a.scene);let i=(d=a.userData.vrm)!=null?d:null;(i==null?void 0:i.humanoid)==null&&(i=null),i==null&&console.warn("Failed to load the model as a VRM. Fallback to treat the model as a mere GLTF"),this._stats=await this._prepareStats(a,i);const l=(x=i==null?void 0:i.scene)!=null?x:a.scene;this._scene.add(l);const A={buffer:t,gltf:a,originalGLTFJSON:s,vrm:i,scene:l};return this._model=A,this._plugins.forEach(u=>{var E;return(E=u.handleAfterLoad)==null?void 0:E.call(u,A)}),i&&((p=i.firstPerson)==null||p.setup(),this._updateLayerMode(),i.scene.traverse(u=>{"isMesh"in u&&Bn(u,async E=>{"isMeshStandardMaterial"in E&&(E.envMap=await this._requestEnvMap())})}),ie.rotateVRM0(i),(h=i.springBoneManager)==null||h.setInitState(),(g=i.nodeConstraintManager)==null||g.setInitState()),this._emit("load",A),A}async exportBufferView(e){var l;const t=(l=this._model)==null?void 0:l.gltf;if(t==null)return;const o=await t.parser.getDependency("bufferView",e),s=new Blob([o]),a=URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=`${e}.bin`,i.click(),URL.revokeObjectURL(a)}setup(e){this._canvas=e;const t=window.innerWidth,o=window.innerHeight,s=window.devicePixelRatio;this._renderer=new Mt({canvas:this._canvas}),this._renderer.outputEncoding=Rt,this._renderer.setSize(t,o),this._renderer.setPixelRatio(s),this._composer=new It(this._renderer,new yt(t,o,{type:kt})),this._composer.setPixelRatio(window.devicePixelRatio);const a=new Pt(this._scene,this._camera);this._composer.addPass(a),this._handleResize&&window.removeEventListener("resize",this._handleResize),this._handleResize=()=>{this._camera.aspect=window.innerWidth/window.innerHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(window.innerWidth,window.innerHeight),this._composer.setSize(window.innerWidth,window.innerHeight)},window.addEventListener("resize",this._handleResize),this._webglMemory=this._renderer.getContext().getExtension("GMAN_webgl_memory"),this._plugins.forEach(i=>{var l;return(l=i.handleAfterSetup)==null?void 0:l.call(i)})}registerDnD(e){const t=s=>{s.preventDefault()},o=s=>{s.preventDefault();const a=s.dataTransfer.files;if(!a)return;const i=a[0];if(!i)return;const l=new Blob([i],{type:"application/octet-stream"}),A=URL.createObjectURL(l);this.loadVRM(A)};return e.addEventListener("dragover",t),e.addEventListener("drop",o),()=>{e.removeEventListener("dragover",t),e.removeEventListener("drop",o)}}update(e){var t;((t=this._model)==null?void 0:t.vrm)&&this._model.vrm.update(e),this._plugins.forEach(o=>{var s;return(s=o.handleBeforeRender)==null?void 0:s.call(o,e)}),this._composer&&this._composer.render(e),this._webglMemory&&(this._webglMemoryInfo=this._webglMemory.getMemoryInfo())}async _prepareStats(e,t){var g,u,E;const o=new Lt,s=new Set;let a=0,i=0,l=0;const A=B=>{var C,b;i++;const R=B.geometry;o.expandByObject(B);const I=R.getAttribute("position");s.add(I),l+=((b=(C=R.index)==null?void 0:C.count)!=null?b:I.count)/3};(await e.parser.getDependencies("mesh")).forEach(B=>{a++,B.isMesh?A(B):B.children.forEach(I=>{A(I)})});let x=0;for(const B of s)x+=B.count;const p=await e.parser.getDependencies("material"),h=(E=(u=(g=t==null?void 0:t.springBoneManager)==null?void 0:g.joints)==null?void 0:u.size)!=null?E:0;return{dimension:o.getSize(yn).toArray(),vertices:x,polygons:l,meshes:a,primitives:i,materials:p.length,joints:h}}_requestEnvMap(){const e=[wn,Cn,Mn,vn,In,Rn];if(!this._ongoingRequestEnvMap){const t=new Qt;this._ongoingRequestEnvMap=new Promise((o,s)=>{t.load(e,a=>o(a),void 0,a=>s(a))})}return this._ongoingRequestEnvMap}_updateLayerMode(){var t,o;const e=(o=(t=this._model)==null?void 0:t.vrm)==null?void 0:o.firstPerson;!e||(this._layerMode==="firstPerson"?(this._camera.layers.enable(e.firstPersonOnlyLayer),this._camera.layers.disable(e.thirdPersonOnlyLayer)):(this._camera.layers.disable(e.firstPersonOnlyLayer),this._camera.layers.enable(e.thirdPersonOnlyLayer)))}}En(_e,[sn]);var kn="./assets/uv-grid.cfc47a74.png",T;(function(n){n[n.None=0]="None",n[n.GLTFFallback=1]="GLTFFallback",n[n.MToonNormal=2]="MToonNormal",n[n.MToonLitShadeRate=3]="MToonLitShadeRate",n[n.MToonUV=4]="MToonUV",n[n.UVGrid=5]="UVGrid"})(T||(T={}));const Se=new K({visible:!1}),Pn=new Promise(n=>{new Be().load(kn,t=>{t.flipY=!1,n(t)})});function He(){const n=new K({color:16711935});return Pn.then(e=>{n.map=e,n.color.set(16777215)}),n}function Te(n,e){if("isMToonMaterial"in n){const t=n;t.debugMode=e}}function De(n){return"isMToonMaterial"in n?n.isOutline:!1}class Ln{constructor(e){m(this,"_currentMode",0);m(this,"_vrmMaterialsByMesh",new Map);m(this,"_inspector");this._inspector=e,this._inspector.on("load",()=>this._handleLoad()),this._inspector.on("unload",()=>this._handleUnload())}applyMode(e){e===0?this._applyModeMToon(X.None):e===2?this._applyModeMToon(X.Normal):e===3?this._applyModeMToon(X.LitShadeRate):e===4?this._applyModeMToon(X.UV):e===5&&this._applyModeUVGrid(),this._currentMode=e}_applyModeMToon(e){for(const[t,o]of this._vrmMaterialsByMesh.entries())Array.isArray(o)?o.forEach((s,a)=>{Te(s,e),t.material[a]=s}):(Te(o,e),t.material=o)}_applyModeUVGrid(){for(const[e,t]of this._vrmMaterialsByMesh.entries())Array.isArray(t)?t.forEach((o,s)=>{De(o)?e.material[s]=Se:e.material[s]=He()}):De(t)?e.material=Se:e.material=He()}async _handleLoad(){(await this._inspector.model.gltf.parser.getDependencies("mesh")).forEach(t=>{if("isGroup"in t)t.children.forEach(s=>{const a=s;this._addManagedMesh(a)});else{const o=t;this._addManagedMesh(o)}}),this.applyMode(this._currentMode)}_addManagedMesh(e){Array.isArray(e.material)?this._vrmMaterialsByMesh.set(e,e.material.concat()):this._vrmMaterialsByMesh.set(e,e.material)}_handleUnload(){this._vrmMaterialsByMesh.clear()}}var Ne="./assets/VRM1_Constraint_Twist_Sample.859297e7.vrm";function Qn(n){console.error(n)}const D=new _e;D.loadVRM(Ne).catch(Qn);D.registerDnD(document.body);const zn=new on(D),_n=new Ln(D);console.info(D);const Sn=new zt;function Ve(){requestAnimationFrame(Ve);const n=Sn.getDelta();D.update(n)}Ve();const P=ve.createContext({inspector:D,highlighter:zn,materialDebugger:_n}),Ue=({href:n,widthClass:e})=>n==null?null:r("a",{href:n,target:"_blank",rel:"noreferrer",className:`font-bold truncate inline-block align-top underline text-sky-500 ${e!=null?e:"w-64"}`,children:n});function Hn(){const n=c.exports.useRef(-1/0);return c.exports.useCallback(t=>{const o=performance.now();o-n.current<250?(t(),n.current=-1/0):n.current=o},[n])}const Q=n=>{var d,x,p;const[e,t]=c.exports.useState((d=n.initPosition)!=null?d:{left:0,top:0}),[o,s]=c.exports.useState((x=n.initOpening)!=null?x:!1),a=Hn(),i=c.exports.useCallback(h=>{var g;(g=n.onClick)==null||g.call(n,h,n.paneKey)},[n.onClick,n.paneKey]),l=c.exports.useCallback(h=>{h.preventDefault();let g=e.left,u=e.top;Le((E,B)=>{E.preventDefault(),E.stopPropagation(),g+=B.x,u+=B.y,t({left:g,top:u})}),a(()=>{s(!o)})},[o,e]),A=c.exports.useCallback(h=>{var g;h.preventDefault(),h.stopPropagation(),(g=n.onClick)==null||g.call(n,h,n.paneKey),s(!o)},[o,n.onClick,n.paneKey]);return M("div",{style:{left:e.left,top:e.top,minWidth:"15rem",boxShadow:"0 0 10px rgba(0, 0, 0, 1.0)"},className:`absolute shadow ${n.className}`,onMouseDown:i,children:[M("div",{className:"h-5 leading-5 w-full bg-gray-700 cursor-move",onMouseDown:l,children:[r("div",{className:"inline-block w-5 h-5 text-center cursor-pointer hover:text-sky-500",onMouseDown:A,children:o?"-":"+"}),n.title]}),o&&((p=n.children)!=null?p:null)]})},z=({className:n,paddingClass:e,children:t})=>r("div",{className:`bg-gray-900/80 backdrop-blur ${e!=null?e:"p-2"} ${n}`,children:t}),Tn=n=>r(Q,v(w({},n),{children:M(z,{children:[r("div",{children:"three-vrm-inspector"}),r("div",{children:"Three.js based VRM inspector"}),M("div",{children:["Source: ",r(Ue,{widthClass:"w-min",href:"https://github.com/0b5vr/three-vrm-inspector"})]})]})})),G=({label:n,onChange:e,defaultValue:t,disabled:o})=>{const s=c.exports.useCallback(a=>{const i=parseFloat(a.currentTarget.value);e(i)},[]);return M("div",{className:"flex items-center",children:[r("input",{className:"mr-2",type:"range",min:"0",max:"1",step:"0.001",defaultValue:t!=null?t:0,disabled:o,onChange:s}),o?r("span",{className:"text-gray-500",children:n}):n]})},Ge=({name:n,isAvailable:e})=>{const{inspector:t}=c.exports.useContext(P),o=c.exports.useCallback(s=>{var a,i,l;(l=(i=(a=t.model)==null?void 0:a.vrm)==null?void 0:i.expressionManager)==null||l.setValue(n,s)},[]);return r(G,{label:n,disabled:!e,onChange:o})},F=()=>r("div",{className:"w-full h-0.5 my-2 bg-gray-500"}),Fe=[k.Neutral,k.Happy,k.Angry,k.Sad,k.Relaxed,k.Surprised,k.Blink,k.BlinkLeft,k.BlinkRight,k.Aa,k.Ee,k.Ih,k.Oh,k.Ou,k.LookLeft,k.LookRight,k.LookDown,k.LookUp],Dn=new Set(Fe),Nn=n=>{var i,l,A;const{inspector:e}=c.exports.useContext(P),t=(l=(i=e.model)==null?void 0:i.vrm)==null?void 0:l.expressionManager,o=t==null?void 0:t.expressionMap,s=[];o&&Array.from(Object.keys(o)).forEach(d=>{Dn.has(d)||s.push(d)});const a=((A=s==null?void 0:s.length)!=null?A:0)>=1;return r(Q,v(w({},n),{children:r(z,{children:t?M(_,{children:[Fe.map(d=>r(Ge,{name:d,isAvailable:(t==null?void 0:t.getExpression(d))!=null},d)),r(F,{}),s==null?void 0:s.map(d=>r(Ge,{name:d,isAvailable:!0},d)),!a&&r("span",{className:"text-gray-500",children:"(No custom expressions)"})]}):"No blendShapeProxy detected."})}))},Vn=n=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useRef(null),o=c.exports.useCallback(s=>{var i;s.preventDefault();const a=(i=t.current)==null?void 0:i.value;if(a!=null&&a!==""){const l=parseInt(a,10);e.exportBufferView(l)}},[e]);return r(Q,v(w({},n),{children:r(z,{children:M("form",{onSubmit:o,children:[r("input",{type:"number",ref:t,defaultValue:0,className:"w-24 px-1 bg-gray-800 border border-gray-500",required:!0}),r("input",{type:"submit",className:"ml-1 px-1 bg-gray-800 border border-gray-500",value:"Export"})]})})}))},H=({callback:n,label:e,checked:t})=>{const o=c.exports.useCallback(({target:s})=>{n(s.checked)},[n]);return M("div",{children:[r("input",{type:"checkbox",checked:t,onChange:o}),r("label",{className:"ml-1",children:e})]})},Un=n=>{const{inspector:e}=c.exports.useContext(P),[t,o]=c.exports.useState(!0),[s,a]=c.exports.useState(!0),[i,l]=c.exports.useState(!0),[A,d]=c.exports.useState(!0),[x,p]=c.exports.useState(!0),[h,g]=c.exports.useState(!0),[u,E]=c.exports.useState(!0),[B,R]=c.exports.useState(!0),I=c.exports.useCallback(()=>{o(!0),a(!0),l(!0),d(!0),p(!0),g(!0),E(!0),R(!0)},[]),C=c.exports.useCallback(()=>{o(!1),a(!1),l(!1),d(!1),p(!1),g(!1),E(!1),R(!1)},[]),b=c.exports.useCallback(y=>{o(y)},[e]),L=c.exports.useCallback(y=>{a(y)},[e]),S=c.exports.useCallback(y=>{l(y)},[e]),j=c.exports.useCallback(y=>{d(y)},[e]),W=c.exports.useCallback(y=>{p(y)},[e]),Y=c.exports.useCallback(y=>{g(y)},[e]),Z=c.exports.useCallback(y=>{E(y)},[e]),J=c.exports.useCallback(y=>{R(y)},[e]);return c.exports.useEffect(()=>{e.helpersPlugin.gridHelper.visible=t},[e,t]),c.exports.useEffect(()=>{e.helpersPlugin.axesHelper.visible=s},[e,s]),c.exports.useEffect(()=>{e.helpersPlugin.humanoidHelperRoot.visible=i},[e,i]),c.exports.useEffect(()=>{e.humanoidTransformPlugin.active=A},[e,A]),c.exports.useEffect(()=>{e.helpersPlugin.lookAtHelperRoot.visible=x},[e,x]),c.exports.useEffect(()=>{e.lookAtBallPlugin.isActive=h},[e,h]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneJointHelperRoot.visible=u},[e,u]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneColliderHelperRoot.visible=B},[e,B]),r(Q,v(w({},n),{children:M(z,{children:[r("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:I,children:"Enable All"}),r("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:C,children:"Disable All"}),r(F,{}),r(H,{callback:b,label:"Grid",checked:t}),r(H,{callback:L,label:"Axes",checked:s}),r(H,{callback:S,label:"Humanoid",checked:i}),r(H,{callback:j,label:"Humanoid Transform",checked:A}),r(H,{callback:W,label:"LookAt",checked:x}),r(H,{callback:Y,label:"LookAt Ball",checked:h}),r(H,{callback:Z,label:"Spring Bones",checked:u}),r(H,{callback:J,label:"Spring Bone Colliders",checked:B})]})}))},Gn="modulepreload",Oe={},Fn="./",On=function(e,t){return!t||t.length===0?e():Promise.all(t.map(o=>{if(o=`${Fn}${o}`,o in Oe)return;Oe[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${a}`))return;const i=document.createElement("link");if(i.rel=s?"stylesheet":Gn,s||(i.as="script",i.crossOrigin=""),i.href=o,document.head.appendChild(i),s)return new Promise((l,A)=>{i.addEventListener("load",l),i.addEventListener("error",A)})})).then(()=>e())};const jn=`// Press Ctrl+S or Ctrl+R to apply
// The api will be changed without notice! Use at your own risk

export default ( { inspector, THREE } ) => {
  let isUnmounted = false;

  const vrm = inspector.model.vrm;

  // update
  const beginTime = Date.now();

  function update() {
    if ( isUnmounted ) { return; }

    const time = 0.001 * ( Date.now() - beginTime );

    const leftUpperArm = vrm.humanoid?.getNormalizedBoneNode( 'leftUpperArm' );
    if ( leftUpperArm != null ) {
      leftUpperArm.rotation.z = Math.sin( time );
    }

    requestAnimationFrame( update );
  }
  requestAnimationFrame( update );

  // uninit
  return () => {
    isUnmounted = true;
  };
}
`,Wn=n=>{const{inspector:e}=c.exports.useContext(P),[t,o]=c.exports.useState(jn),[s,a]=c.exports.useState(!1),i=c.exports.useRef();c.exports.useEffect(()=>{window.addEventListener("beforeunload",p=>{if(s){const h="You will lose all of your changes on the editor!";return p.returnValue=h,h}})},[s]);const l=c.exports.useCallback(p=>{var u;(u=i.current)==null||u.call(i);const h=new Blob([p],{type:"text/javascript"}),g=URL.createObjectURL(h);On(()=>import(g),[]).then(E=>{i.current=E.default({inspector:e,THREE:we}),URL.revokeObjectURL(g)})},[e]),A=c.exports.useCallback(p=>{p.addKeyMap({"Ctrl-S":()=>{l(p.getValue())},"Ctrl-R":()=>{l(p.getValue())}})},[l]),d=c.exports.useCallback((p,h,g)=>{o(g),a(!0)},[]),x=c.exports.useCallback(()=>{},[]);return r(Q,v(w({},n),{children:r(z,{className:"w-120 h-80",paddingClass:"p-0",children:r(_t,{value:t,options:{mode:"text/javascript",keyMap:"sublime",theme:"monokai-sharp",lineNumbers:!0},editorDidMount:A,onBeforeChange:d,onChange:x,className:"h-full leading-tight"})})}))},ee=({children:n,onClick:e,onMouseEnter:t,onMouseLeave:o})=>r("span",{className:"select-none cursor-pointer",onClick:e,onMouseEnter:t,onMouseLeave:o,children:n}),je=({children:n})=>r("div",{style:{marginLeft:"1.13em"},children:n}),Ae=({name:n,value:e,fullPath:t=""})=>{const{highlighter:o}=c.exports.useContext(P),[s,a]=c.exports.useState(!1),[i,l]=c.exports.useState(!1),[A,d]=c.exports.useState([void 0]),x=c.exports.useCallback(b=>{b.stopPropagation(),a(!s)},[a,s]),p=c.exports.useCallback(()=>{l(!0),d([o.highlight(t)])},[l,d,o,t]),h=c.exports.useCallback(()=>{var b;l(!1),(b=A[0])==null||b.call(A)},[l,A]),g=Array.isArray(e),u=e==null,E=typeof e=="number",B=typeof e=="boolean",R=typeof e=="string",I=!g&&!u&&!E&&!B&&!R,C={onClick:x,onMouseEnter:p,onMouseLeave:h,isHovering:i};return M("div",{className:"select-auto",children:[r("span",v(w({className:`cursor-pointer ${i&&"text-sky-500"}`},C),{children:n?`${n}: `:""})),g&&M(_,{children:[r(ee,v(w({},C),{children:"["})),s&&r(je,{children:e.map((b,L)=>r("div",{children:r(Ae,{name:L.toString()+((b==null?void 0:b.name)?` (${b.name})`:""),value:b,fullPath:`${t}/${L}`})},L))}),r(ee,v(w({},C),{children:` ${s?"":e.length} ]`}))]}),I&&M(_,{children:[r(ee,v(w({},C),{children:"{"})),s&&r(je,{children:Object.keys(e).map((b,L)=>r("div",{children:r(Ae,{name:b,value:e[b],fullPath:`${t}/${b}`})},L))}),r(ee,v(w({},C),{children:` ${s?"":Object.keys(e).join(", ")} }`}))]}),u&&r(_,{children:r("span",v(w({className:"text-pink-500"},C),{children:e}))}),E&&r(_,{children:r("span",v(w({className:"text-indigo-400"},C),{children:e}))}),B&&r(_,{children:r("span",v(w({className:"text-indigo-400"},C),{children:String(e)}))}),R&&r(_,{children:M("span",v(w({className:"text-yellow-300"},C),{children:['"',e,'"']}))})]})},Yn=n=>{const{inspector:e}=c.exports.useContext(P),[t,o]=c.exports.useState(void 0);return c.exports.useEffect(()=>{const s=()=>{var a;o((a=e.model)==null?void 0:a.originalGLTFJSON)};return e.on("load",s),()=>{e.off("load",s)}},[e]),r(Q,v(w({},n),{children:r(z,{className:"w-120 h-80 overflow-scroll whitespace-nowrap resize font-mono text-xs leading-tight",paddingClass:"p-0",children:r(Ae,{value:t})})}))},Zn=n=>{const{inspector:e}=c.exports.useContext(P),[t,o]=c.exports.useState(!0),s=c.exports.useCallback(a=>{o(a),e.lookAtPlugin.enableLookAt=a},[e]);return r(Q,v(w({},n),{children:r(z,{children:r(H,{callback:s,label:"Enable LookAt",checked:t})})}))},Jn=n=>{const{materialDebugger:e}=c.exports.useContext(P),t=c.exports.useCallback(o=>{const s=parseInt(o.target.value);e.applyMode(s)},[e]);return r(Q,v(w({},n),{children:r(z,{children:M("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:[r("option",{value:T.None,children:"None"}),r("option",{value:T.MToonNormal,children:"MToon Normal"}),r("option",{value:T.MToonLitShadeRate,children:"MToon LitShadeRate"}),r("option",{value:T.MToonUV,children:"MToon UV"}),r("option",{value:T.UVGrid,children:"UV Grid"})]})})}))},f=({name:n,value:e,href:t})=>M("div",{children:[n,":"," ",e!=null&&r("span",{className:"font-bold",children:e}),t&&r(Ue,{href:t})]}),Kn=({meta:n})=>M(_,{children:[r(f,{name:"Title",value:n.title}),r(f,{name:"Author",value:n.author}),r(f,{name:"Version",value:n.version}),r(f,{name:"Reference",value:n.reference}),r(f,{name:"Contact Information",value:n.contactInformation}),r(f,{name:"Allowed User Name",value:n.allowedUserName}),r(f,{name:"Violent Ussage Name",value:n.violentUssageName}),r(f,{name:"Sexual Ussage Name",value:n.sexualUssageName}),r(f,{name:"Commercial Ussage Name",value:n.commercialUssageName}),r(f,{name:"Other Permission URL",href:n.otherPermissionUrl}),r(f,{name:"License Name",value:n.licenseName}),r(f,{name:"Other License URL",href:n.otherLicenseUrl})]}),Xn=({meta:n})=>{var e;return M(_,{children:[r(f,{name:"Name",value:n.name}),r(f,{name:"Version",value:n.version}),r(f,{name:"Authors",value:n.authors.join(", ")}),r(f,{name:"Copyright Information",value:n.copyrightInformation}),r(f,{name:"Contact Information",value:n.contactInformation}),r(f,{name:"References",value:(e=n.references)==null?void 0:e.join(", ")}),r(f,{name:"Third Party Licenses",value:n.thirdPartyLicenses}),r(f,{name:"License URL",href:n.licenseUrl}),r(f,{name:"Avatar Permission",value:n.avatarPermission}),r(f,{name:"Allow Excessively Violent Usage",value:String(n.allowExcessivelyViolentUsage)}),r(f,{name:"Allow Excessively Sexual Usage",value:String(n.allowExcessivelySexualUsage)}),r(f,{name:"Commercial Usage Name",value:n.commercialUsage}),r(f,{name:"Allow Political or Religious Usage",value:String(n.allowPoliticalOrReligiousUsage)}),r(f,{name:"Allow Antisocial or Hate Usage",value:String(n.allowAntisocialOrHateUsage)}),r(f,{name:"Credit Notation",value:n.creditNotation}),r(f,{name:"Allow Redistribution",value:String(n.allowRedistribution)}),r(f,{name:"Modification",value:n.modification}),r(f,{name:"Other License URL",href:n.otherLicenseUrl})]})},qn=n=>{var s,a;const{inspector:e}=c.exports.useContext(P),t=(a=(s=e.model)==null?void 0:s.vrm)==null?void 0:a.meta;let o=r(_,{children:"No meta detected."});return(t==null?void 0:t.metaVersion)==="1"?o=r(Xn,{meta:t}):(t==null?void 0:t.metaVersion)==="0"&&(o=r(Kn,{meta:t})),r(Q,v(w({},n),{children:r(z,{children:o})}))};var $n="./assets/dancing.2665f039.fbx",eo="./assets/gangnam-style.119f68a4.fbx",to="./assets/jump.a8a08f02.fbx",no="./assets/running.c854d669.fbx",oo="./assets/standing-clap.9fc941e1.fbx",so="./assets/walking.ed38b4d6.fbx";const ro=[{name:"(No Animation)",url:"-"},{name:"Walking",url:so},{name:"Running",url:no},{name:"Jump",url:to},{name:"Dancing",url:$n},{name:"Standing Clap",url:oo},{name:"Gangnam Style",url:eo}],io=n=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useCallback(o=>{const s=o.target.value;s==="-"?e.animationPlugin.clearMixamoAnimation():e.animationPlugin.loadMixamoAnimation(s)},[e]);return r(Q,v(w({},n),{children:r(z,{children:r("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:ro.map(({name:o,url:s})=>r("option",{value:s,children:o},s))})})}))},We=({label:n,onChange:e,defaultChecked:t,disabled:o})=>{const s=c.exports.useCallback(a=>{const i=a.currentTarget.checked;e(i)},[]);return M("div",{className:"flex items-center",children:[r("input",{className:"mr-2",type:"checkbox",disabled:o,defaultChecked:t,onChange:s}),o?r("span",{className:"text-gray-500",children:n}):n]})},ao=n=>{const{inspector:e}=c.exports.useContext(P),[t,o]=c.exports.useState(!1),s=c.exports.useCallback(h=>{e.postProcessingPlugin.bloomPass.enabled=h,o(h)},[e]),a=c.exports.useCallback(h=>{e.postProcessingPlugin.bloomPass.strength=4*h},[e]),i=c.exports.useCallback(h=>{e.postProcessingPlugin.bloomPass.radius=h},[e]),l=c.exports.useCallback(h=>{e.postProcessingPlugin.bloomPass.threshold=4*h},[e]),[A,d]=c.exports.useState(!1),x=c.exports.useCallback(h=>{e.postProcessingPlugin.toneMappingPass.enabled=h,d(h)},[e]),p=c.exports.useCallback(h=>{e.postProcessingPlugin.toneMappingPass.uniforms.exposure.value=2*h},[e]);return r(Q,v(w({},n),{children:M(z,{children:[r("h3",{className:"text-lg font-bold",children:"Bloom"}),r(We,{label:"Enabled",defaultChecked:!1,onChange:s}),r(G,{label:"Strength",defaultValue:.25,disabled:!t,onChange:a}),r(G,{label:"Radius",defaultValue:.5,disabled:!t,onChange:i}),r(G,{label:"Threshold",defaultValue:.25,disabled:!t,onChange:l}),r(F,{}),r("h3",{className:"text-lg font-bold",children:"ACES Tone Mapping"}),r(We,{label:"Enabled",defaultChecked:!1,onChange:x}),r(G,{label:"Exposure",defaultValue:.5,disabled:!A,onChange:p})]})}))},Ao=({name:n,url:e})=>{const{inspector:t}=c.exports.useContext(P),o=c.exports.useCallback(()=>{t.loadVRM(e)},[t]);return r("button",{value:n,className:"bg-gray-800 border border-gray-500 px-1 py-0 block",onClick:o,children:n})};var lo="./assets/Seed-san.624d0d55.vrm",co="./assets/three-vrm-girl.e6e179de.vrm";const ho=[{name:"three-vrm-girl (VRM0.0)",url:co},{name:"Seed-san (VRM1.0)",url:lo},{name:"VRM1_Constaint_Twist_Sample (VRM1.0)",url:Ne}],mo=n=>r(Q,v(w({},n),{children:r(z,{children:ho.map(({name:e,url:t})=>r(Ao,{name:e,url:t},e))})})),uo=n=>{var s,a,i,l,A,d,x,p,h,g;const{inspector:e}=c.exports.useContext(P),t=(s=e.stats)==null?void 0:s.dimension.map(u=>u.toFixed(3)),o=`( ${(a=t==null?void 0:t[0])!=null?a:0}, ${(i=t==null?void 0:t[1])!=null?i:0}, ${(l=t==null?void 0:t[2])!=null?l:0} )`;return r(Q,v(w({},n),{children:M(z,{children:[r(f,{name:"Dimension",value:o}),r(f,{name:"Vertices",value:(A=e.stats)==null?void 0:A.vertices}),r(f,{name:"Polygons",value:(d=e.stats)==null?void 0:d.polygons}),r(f,{name:"Meshes",value:(x=e.stats)==null?void 0:x.meshes}),r(f,{name:"Primitives",value:(p=e.stats)==null?void 0:p.primitives}),r(f,{name:"Materials",value:(h=e.stats)==null?void 0:h.materials}),r(f,{name:"Spring Bone Joints",value:(g=e.stats)==null?void 0:g.joints})]})}))},po=({children:n})=>r("div",{style:{marginLeft:"1.13em"},children:n}),go=n=>{const[e,t]=c.exports.useState(!1),o=n.severity===0?N.error:n.severity===1?N.warning:N.severityInfo,s=c.exports.useCallback(()=>{t(!e)},[e]);return M("div",{className:"group cursor-pointer",onClick:s,children:[r("span",{className:"group-hover:text-sky-500",children:e?"- ":"+ "}),r("span",{style:{color:o},children:n.code}),r("span",{className:"text-gray-500",children:" - "+n.pointer}),e&&r(po,{children:n.message})]})},te=({count:n,colorClass:e})=>r("span",{className:n?e:"text-gray-500",children:n}),fo=n=>{var i,l;const{inspector:e}=c.exports.useContext(P),t=(i=e.gltfValidatorPlugin.validationReport)==null?void 0:i.issues,[o,s]=c.exports.useReducer(A=>A+1,0),a=c.exports.useCallback(()=>{const A=2*t.messages.length;e.gltfValidatorPlugin.validate(A).then(()=>s())},[t]);return r(Q,v(w({},n),{children:M(z,{className:"w-120 h-80 resize overflow-y-scroll",children:[r(f,{name:"Validator Version",value:(l=e.gltfValidatorPlugin.validationReport)==null?void 0:l.validatorVersion}),r(f,{name:"Errors",value:r(te,{count:t==null?void 0:t.numErrors,colorClass:"text-red-500"})}),r(f,{name:"Warnings",value:r(te,{count:t==null?void 0:t.numWarnings,colorClass:"text-yellow-300"})}),r(f,{name:"Infos",value:r(te,{count:t==null?void 0:t.numInfos,colorClass:"text-sky-500"})}),r(f,{name:"Hints",value:r(te,{count:t==null?void 0:t.numHints,colorClass:"text-sky-500"})}),r(F,{}),(t==null?void 0:t.truncated)&&M("div",{className:"m-1 font-bold",children:["There are too many issues! Showing only ",t==null?void 0:t.messages.length," entries.",r("span",{onClick:a,className:"pl-2 text-sky-500 font-bold cursor-pointer",children:"See all"})]}),r("div",{className:"w-full font-mono leading-tight text-xs",children:t==null?void 0:t.messages.map((A,d)=>r(go,{code:A.code,message:A.message,severity:A.severity,pointer:A.pointer},d))})]})}))},O=n=>(n/1048576).toFixed(3)+" MB",xo=n=>{var o,s,a,i,l,A,d,x,p,h,g,u,E,B,R,I,C,b,L,S,j,W,Y,Z,J,y,le,ce,he,de;const{inspector:e}=c.exports.useContext(P),t=e.webglMemoryInfo;return r(Q,v(w({},n),{children:M(z,{children:[r(f,{name:"Buffer",value:O((s=(o=t==null?void 0:t.memory)==null?void 0:o.buffer)!=null?s:0)}),r(f,{name:"Texture",value:O((i=(a=t==null?void 0:t.memory)==null?void 0:a.texture)!=null?i:0)}),r(f,{name:"Render Buffer",value:O((A=(l=t==null?void 0:t.memory)==null?void 0:l.renderbuffer)!=null?A:0)}),r(f,{name:"Drawing Buffer",value:O((x=(d=t==null?void 0:t.memory)==null?void 0:d.drawingbuffer)!=null?x:0)}),r(f,{name:"Total",value:O((h=(p=t==null?void 0:t.memory)==null?void 0:p.total)!=null?h:0)}),r(F,{}),r(f,{name:"Buffer",value:(u=(g=t==null?void 0:t.resources)==null?void 0:g.buffer)!=null?u:0}),r(f,{name:"Render Buffer",value:(B=(E=t==null?void 0:t.resources)==null?void 0:E.renderbuffer)!=null?B:0}),r(f,{name:"Program",value:(I=(R=t==null?void 0:t.resources)==null?void 0:R.program)!=null?I:0}),r(f,{name:"Query",value:(b=(C=t==null?void 0:t.resources)==null?void 0:C.query)!=null?b:0}),r(f,{name:"Sampler",value:(S=(L=t==null?void 0:t.resources)==null?void 0:L.sampler)!=null?S:0}),r(f,{name:"Shader",value:(W=(j=t==null?void 0:t.resources)==null?void 0:j.shader)!=null?W:0}),r(f,{name:"Sync",value:(Z=(Y=t==null?void 0:t.resources)==null?void 0:Y.sync)!=null?Z:0}),r(f,{name:"Texture",value:(y=(J=t==null?void 0:t.resources)==null?void 0:J.texture)!=null?y:0}),r(f,{name:"Transform Feedback",value:(ce=(le=t==null?void 0:t.resources)==null?void 0:le.transformFeedback)!=null?ce:0}),r(f,{name:"Vertex Array",value:(de=(he=t==null?void 0:t.resources)==null?void 0:he.vertexArray)!=null?de:0})]})}))},Eo=()=>{const[n,e]=c.exports.useState(["jsonTree","materialDebugger","meta","stats","webglMemory","blendShape","lookAt","validationReport","sampleModels","helpers","exportBufferView","mixamoAnimations","postProcessing","jsEditor","about"]),t=c.exports.useCallback((i,l)=>{const A=n.concat();A.splice(n.indexOf(l),1),A.push(l),e(A)},[n]);let o=0;const s=()=>{const i=0,l=o;return o+=20,{left:i,top:l}},a={jsonTree:r(Yn,{paneKey:"jsonTree",title:"JSON Tree",onClick:t,initPosition:s()},"jsonTree"),materialDebugger:r(Jn,{paneKey:"materialDebugger",title:"MToon Material Debugger",onClick:t,initPosition:s()},"materialDebugger"),meta:r(qn,{paneKey:"meta",title:"Meta",onClick:t,initPosition:s()},"meta"),stats:r(uo,{paneKey:"stats",title:"Stats",onClick:t,initPosition:s()},"stats"),webglMemory:r(xo,{paneKey:"webglMemory",title:"WebGL Memory",onClick:t,initPosition:s()},"webglMemory"),blendShape:r(Nn,{paneKey:"blendShape",title:"Blend Shape Proxy",onClick:t,initPosition:s()},"blendShape"),lookAt:r(Zn,{paneKey:"lookAt",title:"Look At",onClick:t,initPosition:s()},"lookAt"),validationReport:r(fo,{paneKey:"validationReport",title:"Validation Report",onClick:t,initPosition:s()},"validationReport"),sampleModels:r(mo,{paneKey:"sampleModels",title:"Sample Models",onClick:t,initPosition:s()},"sampleModels"),helpers:r(Un,{paneKey:"helpers",title:"Helpers",onClick:t,initPosition:s()},"helpers"),exportBufferView:r(Vn,{paneKey:"exportBufferView",title:"Export Buffer View",onClick:t,initPosition:s()},"exportBufferView"),mixamoAnimations:r(io,{paneKey:"mixamoAnimations",title:"Mixamo Animations",onClick:t,initPosition:s()},"mixamoAnimations"),postProcessing:r(ao,{paneKey:"postProcessing",title:"Post Processing",onClick:t,initPosition:s()},"postProcessing"),jsEditor:r(Wn,{paneKey:"jsEditor",title:"JavaScript Editor",onClick:t,initPosition:s()},"jsEditor"),about:r(Tn,{paneKey:"about",title:"About",onClick:t,initPosition:s()},"about")};return r(_,{children:n.map(i=>a[i])})},Bo=()=>{const{inspector:n}=c.exports.useContext(P),[e,t]=c.exports.useState(null);c.exports.useEffect(()=>{const s=()=>{t(null)},a=i=>{t(i)};return n.on("load",s),n.on("progress",a),()=>{n.off("load",s),n.off("progress",a)}});const o=c.exports.useMemo(()=>e?e.loaded/e.total:null,[e]);return r(_,{children:r("div",{className:"w-full h-full absolute text-center pointer-events-none",children:r("div",{children:o?(100*o).toFixed(2):"yay"})})})},bo=()=>{const{inspector:n}=c.exports.useContext(P),e=c.exports.useCallback(t=>{t&&n.setup(t)},[]);return r(_,{children:M("div",{className:"w-full h-full text-sm absolute overflow-hidden text-gray-100",children:[r("canvas",{ref:e,className:"w-full h-full absolute"}),r(Eo,{}),r(Bo,{})]})})},Co=()=>r(_,{children:r(bo,{})});St.render(r(ve.StrictMode,{children:r(Co,{})}),document.getElementById("root"));
