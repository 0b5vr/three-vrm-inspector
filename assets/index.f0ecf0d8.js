var Ve=Object.defineProperty,Ge=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var q=(o,e,t)=>e in o?Ve(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,w=(o,e)=>{for(var t in e||(e={}))Oe.call(e,t)&&q(o,t,e[t]);if(ce)for(var t of ce(e))je.call(e,t)&&q(o,t,e[t]);return o},R=(o,e)=>Ge(o,Fe(e));var p=(o,e,t)=>(q(o,typeof e!="symbol"?e+"":e,t),t);import{C as de,M as $,S as We,a as Ye,b as he,F as Ze,A as me,Q as ue,V as pe,c as Ke,d as ge,v as Je,G as Xe,e as qe,f as W,g as fe,T as Ee,h as $e,R as et,i as xe,j as tt,E as nt,k as Be,O as ot,U as st,l as rt,m as it,n as be,P as At,o as at,D as lt,p as ct,q as dt,r as ht,s as mt,t as ut,u as pt,w as Y,x as gt,W as ft,y as Et,z as xt,B as Bt,H as bt,I as Ct,J as wt,K as Rt,L as Z,N as Ce,X as vt,Y as s,Z as a,_ as v,$ as y,a0 as _,a1 as Mt,a2 as It}from"./vendor.92b00e1c.js";const yt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const A of i.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&n(A)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};yt();const V={black:"#000000",white:"#ffffff",back1:"#191a1f",fore:"#d0edff",titleBarBg:"#30343b",accent:"#ff0066",gray:"#75848f",uiBackground:"rgba( 25, 26, 31, 0.8 )",error:"#ff0066",warning:"#f7f025",severityInfo:"#53c5ff",constant:"#ff0066",number:"#8a8aff",string:"#f7f025"},Pt=new de(V.constant),kt=new $({color:Pt,transparent:!0,wireframe:!0,depthTest:!1,depthWrite:!1}),Qt=new We(.2);function we(o=Qt){const e=new Ye(o,kt);return e.frustumCulled=!1,e.renderOrder=1e4,e}function Lt(o,e,t){const r=o.parser.json.nodes[e].mesh;if(r==null)return null;const A=o.parser.json.meshes[r].primitives.length,l=[];return t.traverse(c=>{l.length<A&&c.isMesh&&l.push(c)}),l}async function K(o,e){const t=await o.parser.getDependency("node",e);return Lt(o,e,t)}const zt=new he({transparent:!0,depthTest:!1,depthWrite:!1});function G(o,e=zt){const t=new Map;return o.forEach(n=>{Array.isArray(n.material)&&(t.set(n,n.material[0]),n.material[0]=e)}),()=>{for(const[n,r]of t)n.material[0]=r}}function ee(o){const e=new Map;return o.forEach(t=>{const n=we();t.add(n),e.set(t,n)}),()=>{o.forEach(t=>{const n=e.get(t);t.remove(n)})}}class _t extends he{constructor(e){super(e);p(this,"_skinIndexVisualize");p(this,"_uniforms");this._skinIndexVisualize=0,this.onBeforeCompile=t=>{this._uniforms=t.uniforms,this._uniforms.skinIndexVisualize={value:this._skinIndexVisualize},t.vertexShader=t.vertexShader.replace("#include <common>",`#include <common>

        varying float vWeightVisualize;
        uniform float skinIndexVisualize;`),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`#ifdef USE_SKINNING
          vWeightVisualize = (
            skinIndex.x == skinIndexVisualize ? skinWeight.x : 0.0 +
            skinIndex.y == skinIndexVisualize ? skinWeight.y : 0.0 +
            skinIndex.z == skinIndexVisualize ? skinWeight.z : 0.0 +
            skinIndex.w == skinIndexVisualize ? skinWeight.w : 0.0
          );
        #else
          vWeightVisualize = 0.0;
        #endif

        #include <begin_vertex>`),t.fragmentShader=t.fragmentShader.replace("#include <packing>",`#include <packing>

        varying float vWeightVisualize;`),t.fragmentShader=t.fragmentShader.replace("gl_FragColor = vec4( packNormalToRGB( normal ), opacity );",`gl_FragColor = vec4(
          clamp( 2.0 - abs( vec3( 4.0, 2.0, 0.0 ) - 4.0 * vWeightVisualize ), 0.0, 1.0 ),
          opacity
        );`)}}get skinIndexVisualize(){return this._skinIndexVisualize}set skinIndexVisualize(e){this._uniforms&&(this._uniforms.skinIndexVisualize={value:e}),this._skinIndexVisualize=e}}const Re=new _t({transparent:!0,depthTest:!1,depthWrite:!1}),St=new de(V.constant);class Ht{constructor(e){p(this,"_inspector");this._inspector=e}highlight(e){const t=this._inspector,n=e.split("/"),r=t.model.gltf,i=r.parser,A=i.json;if(n.length===3&&n[1]==="nodes"){const l=parseInt(n.pop());let c;return i.getDependency("node",l).then(h=>{c=ee([h])}),()=>{c&&c()}}else if(n.length===3&&n[1]==="meshes"){const l=parseInt(n.pop());let c;const h=A.nodes,m=[];return h==null||h.forEach((d,E)=>{d.mesh===l&&m.push(E)}),Promise.all(m.map(d=>K(r,d))).then(d=>d.flat()).then(d=>{c=G(d)}),()=>{c&&c()}}else if(n.length===5&&n[1]==="meshes"&&n[3]==="primitives"){const l=parseInt(n[2]),c=parseInt(n[4]);let h;return i.getDependency("mesh",l).then(m=>{m.children.length!==0&&(m=m.children[c]),h=G([m])}),()=>{h&&h()}}else if(n.length===7&&n[1]==="meshes"&&n[3]==="primitives"&&n[5]==="targets"){const l=parseInt(n[2]),c=parseInt(n[4]),h=parseInt(n[6]);let m;return i.getDependency("mesh",l).then(g=>{g.children.length!==0&&(g=g.children[c]);const d=g;d.morphTargetInfluences&&(d.morphTargetInfluences[h]=1),m=()=>{d.morphTargetInfluences&&(d.morphTargetInfluences[h]=0)}}),()=>{m&&m()}}else if(n.length===6&&n[1]==="meshes"&&n[3]==="extras"&&n[4]==="targetNames"){const l=parseInt(n[2]),c=parseInt(n[5]);let h;const m=A.nodes,g=[];return m==null||m.forEach((E,u)=>{E.mesh===l&&g.push(u)}),Promise.all(g.map(E=>K(r,E))).then(E=>E.flat()).then(E=>{E.forEach(u=>{u.morphTargetInfluences&&(u.morphTargetInfluences[c]=1)}),h=()=>{E.forEach(u=>{u.morphTargetInfluences&&(u.morphTargetInfluences[c]=0)})}}),()=>{h&&h()}}else if(n.length===3&&n[1]==="skins"){const l=parseInt(n[2]);let c;const h=A.nodes,m=[];return h==null||h.forEach((d,E)=>{d.skin===l&&m.push(E)}),Promise.all(m.map(d=>K(r,d))).then(d=>d.flat()).then(d=>{c=G(d)}),()=>{c&&c()}}else if(n.length===5&&n[1]==="skins"&&n[3]==="joints"){const l=parseInt(n[2]),c=parseInt(n[4]),h=[],m=A.skins[l].joints[c];i.getDependency("node",m).then(u=>{h.push(ee([u]))});const g=A.nodes,d=[];return g==null||g.forEach((u,x)=>{u.skin===l&&d.push(x)}),Promise.all(d.map(u=>K(r,u))).then(u=>u.flat()).then(u=>{h.push(G(u,Re)),Re.skinIndexVisualize=c}),()=>{h.forEach(u=>u())}}else if(n.length===3&&n[1]==="materials"||n.length===5&&n[2]==="VRM"&&n[3]==="materialProperties"){const l=parseInt(n.pop());let c;return i.getDependencies("mesh").then(h=>{const m=[];A.meshes.forEach((g,d)=>{g.primitives.forEach((u,x)=>{if(l===u.material){let B=h[d];B.children.length!==0&&(B=B.children[x]);const C=B;m.push(C)}})}),c=G(m)}),()=>{c&&c()}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="humanoid"&&n[4]==="humanBones"){const l={leftThumbProximal:"leftThumbMetacarpal",leftThumbIntermediate:"leftThumbProximal",rightThumbProximal:"rightThumbMetacarpal",rightThumbIntermediate:"rightThumbProximal"},c=parseInt(e.split("/").pop()),m=A.extensions.VRM.humanoid.humanBones[c].bone,d=t.model.vrm.humanoid.getNormalizedBoneNode(l[m]);return ee([d])}else if(n.length===4&&n[2]==="VRM"&&n[3]==="firstPerson"){const l=we();return t.model.vrm.lookAt.getLookAtWorldPosition(l.position),t.scene.add(l),()=>{t.scene.remove(l)}}else{if(n.length===5&&n[2]==="VRM"&&n[3]==="firstPerson"&&n[4]==="meshAnnotations")return t.layerMode="firstPerson",()=>{t.layerMode="thirdPerson"};if(n.length===6&&n[2]==="VRM"&&n[3]==="blendShapeMaster"&&n[4]==="blendShapeGroups"){const l=parseInt(e.split("/").pop()),m=A.extensions.VRM.blendShapeMaster.blendShapeGroups[l].name,g=t.model.vrm.expressionManager.getValue(m);return t.model.vrm.expressionManager.setValue(m,1),()=>{t.model.vrm.expressionManager.setValue(m,g)}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="secondaryAnimation"&&n[4]==="boneGroups"){const l=parseInt(e.split("/").pop()),h=A.extensions.VRM.secondaryAnimation,m=h==null?void 0:h.boneGroups[l].bones,g=t.model.vrm.springBoneManager,d=new Map;for(const C of g.joints)d.set(C.bone,C);const E=t.helpersPlugin.springBoneJointHelperRoot,u=new Map;E.children.forEach(C=>{const I=C;u.set(I.springBone,I)});const x=[],B=new Set;return m.forEach(C=>{i.getDependency("node",C).then(I=>{I.traverse(M=>{const b=d.get(M),k=u.get(b);B.add(k);const H=k.children[0].material,N=H.color.clone();H.color.copy(St),x.push(()=>{H.color.copy(N)})})})}),()=>{x.forEach(C=>C())}}}}}class Tt{constructor(){p(this,"_eventListeners")}on(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n)),n.push(t)}off(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n));const r=n.indexOf(t);r!==-1&&n.splice(r,1)}_emit(...[e,t]){var n;this._eventListeners=this._eventListeners||new Map,(n=this._eventListeners.get(e))==null||n.forEach(r=>r(t))}}const Dt={mixamorigHips:"hips",mixamorigSpine:"spine",mixamorigSpine1:"chest",mixamorigSpine2:"upperChest",mixamorigNeck:"neck",mixamorigHead:"head",mixamorigLeftShoulder:"leftShoulder",mixamorigLeftArm:"leftUpperArm",mixamorigLeftForeArm:"leftLowerArm",mixamorigLeftHand:"leftHand",mixamorigLeftHandThumb1:"leftThumbMetacarpal",mixamorigLeftHandThumb2:"leftThumbProximal",mixamorigLeftHandThumb3:"leftThumbDistal",mixamorigLeftHandIndex1:"leftIndexProximal",mixamorigLeftHandIndex2:"leftIndexIntermediate",mixamorigLeftHandIndex3:"leftIndexDistal",mixamorigLeftHandMiddle1:"leftMiddleProximal",mixamorigLeftHandMiddle2:"leftMiddleIntermediate",mixamorigLeftHandMiddle3:"leftMiddleDistal",mixamorigLeftHandRing1:"leftRingProximal",mixamorigLeftHandRing2:"leftRingIntermediate",mixamorigLeftHandRing3:"leftRingDistal",mixamorigLeftHandPinky1:"leftLittleProximal",mixamorigLeftHandPinky2:"leftLittleIntermediate",mixamorigLeftHandPinky3:"leftLittleDistal",mixamorigRightShoulder:"rightShoulder",mixamorigRightArm:"rightUpperArm",mixamorigRightForeArm:"rightLowerArm",mixamorigRightHand:"rightHand",mixamorigRightHandPinky1:"rightLittleProximal",mixamorigRightHandPinky2:"rightLittleIntermediate",mixamorigRightHandPinky3:"rightLittleDistal",mixamorigRightHandRing1:"rightRingProximal",mixamorigRightHandRing2:"rightRingIntermediate",mixamorigRightHandRing3:"rightRingDistal",mixamorigRightHandMiddle1:"rightMiddleProximal",mixamorigRightHandMiddle2:"rightMiddleIntermediate",mixamorigRightHandMiddle3:"rightMiddleDistal",mixamorigRightHandIndex1:"rightIndexProximal",mixamorigRightHandIndex2:"rightIndexIntermediate",mixamorigRightHandIndex3:"rightIndexDistal",mixamorigRightHandThumb1:"rightThumbMetacarpal",mixamorigRightHandThumb2:"rightThumbProximal",mixamorigRightHandThumb3:"rightThumbDistal",mixamorigLeftUpLeg:"leftUpperLeg",mixamorigLeftLeg:"leftLowerLeg",mixamorigLeftFoot:"leftFoot",mixamorigLeftToeBase:"leftToes",mixamorigRightUpLeg:"rightUpperLeg",mixamorigRightLeg:"rightLowerLeg",mixamorigRightFoot:"rightFoot",mixamorigRightToeBase:"rightToes"};async function Ut(o,e){const t=e.humanoid;if(t==null)return null;const r=await new Ze().loadAsync(o),A=r.children[0].position.y,h=t.normalizedRestPose.hips.position[1]/A,m=me.findByName(r.animations,"mixamo.com"),g=[];return m.tracks.forEach(d=>{var B;const E=d.name.split("."),u=E[0],x=Dt[u];if(x!=null){const C=(B=t.getNormalizedBoneNode(x))==null?void 0:B.name;if(C!=null){const I=E[1];if(d instanceof ue){const M=d.values.map((b,k)=>{var S;return((S=e.meta)==null?void 0:S.metaVersion)==="0"&&k%2==0?-b:b});g.push(new ue(`${C}.${I}`,d.times,M))}else if(x==="hips"&&d instanceof pe){const M=d.values.map((b,k)=>{var S;return(((S=e.meta)==null?void 0:S.metaVersion)==="0"&&k%3!=1?-b:b)*h});g.push(new pe(`${C}.${I}`,d.times,M))}}}}),new me("vrmAnimation",m.duration,g)}class Nt{constructor(e){p(this,"inspector");p(this,"_currentAnimationMixer");p(this,"_currentAnimationAction");p(this,"_currentAnimationURL");this.inspector=e}handleAfterLoad(e){const t=e.vrm;t!=null&&(this._currentAnimationMixer=new Ke(t.humanoid.normalizedHumanBonesRoot),this._currentAnimationURL!=null&&this.loadMixamoAnimation(this._currentAnimationURL))}handleAfterUnload(){this._currentAnimationAction=null,this._currentAnimationMixer=null}handleBeforeRender(e){this._currentAnimationMixer!=null&&this._currentAnimationMixer.update(e)}loadMixamoAnimation(e){var r;const t=(r=this.inspector.model)==null?void 0:r.vrm;if(!t)return;const n=this._currentAnimationMixer;!n||(this._currentAnimationAction!=null&&this.clearMixamoAnimation(),Ut(e,t).then(i=>{i&&(this._currentAnimationURL=e,this._currentAnimationAction=n.clipAction(i),this._currentAnimationAction.play())}))}clearMixamoAnimation(){var n;const e=(n=this.inspector.model)==null?void 0:n.vrm;if(!e)return;const t=this._currentAnimationAction;!t||(this._currentAnimationURL=null,t.stop(),this._currentAnimationAction=null,e.humanoid.resetNormalizedPose())}}class Vt{constructor(e){p(this,"inspector");p(this,"_controls");this.inspector=e}get controls(){return this._controls}handleAfterSetup(){const{camera:e,canvas:t}=this.inspector;this._controls=new ge(e,t),this._controls.setTarget(0,1,0)}handleBeforeRender(e){this._controls&&this._controls.update(e)}}class te{constructor(e){p(this,"inspector");p(this,"__validationReport");this.inspector=e,this.__validationReport=null}static get VALIDATOR_MAX_ISSUES(){return 100}get validationReport(){return this.__validationReport}async validate(e=te.VALIDATOR_MAX_ISSUES){var r;const t=(r=this.inspector.model)==null?void 0:r.buffer;if(!t)return null;const n=await Je(new Uint8Array(t),{maxIssues:e}).catch(i=>console.error("Validation failed: ",i));return this.__validationReport=n,n}handleAfterLoad(){this.validate()}handleAfterUnload(){this.__validationReport=null}}class Gt{constructor(e){p(this,"inspector");p(this,"gridHelper");p(this,"axesHelper");p(this,"humanoidHelperRoot");p(this,"lookAtHelperRoot");p(this,"springBoneJointHelperRoot");p(this,"springBoneColliderHelperRoot");this.inspector=e,this.gridHelper=new Xe(10,10),e.scene.add(this.gridHelper),this.axesHelper=new qe(5),e.scene.add(this.axesHelper),this.humanoidHelperRoot=new W,this.humanoidHelperRoot.renderOrder=1e4,e.scene.add(this.humanoidHelperRoot),this.lookAtHelperRoot=new W,this.lookAtHelperRoot.renderOrder=1e4,e.scene.add(this.lookAtHelperRoot),this.springBoneJointHelperRoot=new W,this.springBoneJointHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneJointHelperRoot),this.springBoneColliderHelperRoot=new W,this.springBoneColliderHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneColliderHelperRoot)}handleAfterUnload(){this.humanoidHelperRoot.children.concat().forEach(e=>{this.humanoidHelperRoot.remove(e),e.dispose()}),this.springBoneJointHelperRoot.children.concat().forEach(e=>{this.springBoneJointHelperRoot.remove(e),e.dispose()}),this.springBoneColliderHelperRoot.children.concat().forEach(e=>{this.springBoneColliderHelperRoot.remove(e),e.dispose()}),this.lookAtHelperRoot.children.concat().forEach(e=>{this.lookAtHelperRoot.remove(e),e.dispose()})}}function ve(o,e){let t=!1,n,r={x:0,y:0};const i=()=>{t||(requestAnimationFrame(i),n&&(o(n,r),n=void 0,r={x:0,y:0}))};i();const A=c=>{n=c,r.x+=c.movementX,r.y+=c.movementY},l=c=>{t||(e&&e(c),t=!0),window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",l),window.removeEventListener("mousedown",l)};window.addEventListener("mousemove",A),window.addEventListener("mouseup",l),setTimeout(()=>window.addEventListener("mousedown",l))}var Ft="./assets/grab-purple.7ef5ea20.png";const Me=new fe;class Ot{constructor(e){p(this,"inspector");p(this,"_sprites");p(this,"_transformControls");p(this,"_spriteMaterial");p(this,"_raycaster");p(this,"_active");this.inspector=e;const n=new Ee().load(Ft,r=>{r.flipY=!1});this._spriteMaterial=new $e({sizeAttenuation:!1,transparent:!0,depthTest:!1,map:n}),this._raycaster=new et,this._active=!0}get active(){return this._active}set active(e){var t,n;this._active=e,(t=this._sprites)==null||t.forEach(r=>r.visible=e),e===!1&&((n=this._transformControls)==null||n.detach())}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new xe(t,n),this._transformControls.space="local",this._transformControls.mode="rotate",e.add(this._transformControls),this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)}),n!=null&&(n==null||n.addEventListener("mousedown",r=>this.handleMouseDown(r)))}handleAfterLoad(e){var n;const t=(n=e.vrm)==null?void 0:n.humanoid;if(t!=null){this._sprites=[];for(const r of Object.values(t.normalizedHumanBones)){const i=r.node,A=new tt(this._spriteMaterial);A.scale.setScalar(.01),A.renderOrder=1e4,A.visible=this._active,i.add(A),this._sprites.push(A)}}}handleAfterUnload(){var e;this._sprites=null,(e=this._transformControls)==null||e.detach()}handleMouseDown(e){const{camera:t,canvas:n}=this.inspector;if(n==null)return;const r=this._sprites;if(r==null)return;const i=this._transformControls;if(i==null)return;const A=n.getBoundingClientRect();Me.set((e.clientX-A.left)/A.width*2-1,-(e.clientY-A.top)/A.height*2+1),this._raycaster.setFromCamera(Me,t);const c=this._raycaster.intersectObjects(r,!1)[0],h=Date.now();ve(()=>0,()=>{if(!(Date.now()-h>300))if(c!=null){const d=c.object.parent;i.attach(d)}else i.detach()})}}const Ie=new Be,jt=new nt;class Wt{constructor(e){p(this,"inspector");p(this,"_enableLookAt");p(this,"_lookAtTarget");p(this,"_transformControls");this.inspector=e,this._enableLookAt=!1,this._lookAtTarget=new ot,e.scene.add(this._lookAtTarget)}get enableLookAt(){return this._enableLookAt}set enableLookAt(e){this._enableLookAt=e,this._transformControls&&(this._transformControls.enabled=e,this._transformControls.visible=e),e?this._enableLookAtTarget():this._disableLookAtTarget()}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new xe(t,n),e.add(this._transformControls),this._transformControls.attach(this._lookAtTarget),this._transformControls.enabled=!1,this._transformControls.visible=!1,this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)})}handleAfterLoad(e){var r;const{vrm:t}=e;if(t==null)return;const n=(r=t.humanoid)==null?void 0:r.getNormalizedBoneNode("head");n!=null&&(n.getWorldPosition(Ie),this._lookAtTarget.position.set(0,0,5).add(Ie)),this._enableLookAt&&this._enableLookAtTarget()}_enableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=this._lookAtTarget)}_disableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=void 0,e.applier.lookAt(jt.set(0,0,0)))}}class Yt{constructor(e){p(this,"inspector");p(this,"bloomPass");p(this,"toneMappingPass");this.inspector=e,this.bloomPass=new st(new fe(4,4),1,.5,1),this.bloomPass.enabled=!1,this.toneMappingPass=new rt(it),this.toneMappingPass.enabled=!1}handleAfterSetup(){const e=this.inspector.composer;e.addPass(this.bloomPass),e.addPass(this.toneMappingPass)}}function Zt(o,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(o.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}function Kt(o,e){const t=new Set,n=o.material;if(Array.isArray(n))n.forEach(i=>{t.add(i)});else{const r=n;t.add(r)}for(const r of t)e(r)}var Jt="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQQBBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAH7v5JqzrodJxSqKZUVyCEgj6EZBH0IyCMgjIPPQ8kEZB5IOwqeJbISlsqmFVgVTCEpSE5SuctkJxZCZZCZZCZZGZZCwITDrvqOe5Si6Wznvls57osouLKLiyi4souLKbiym4spuKpvCm4Sq4squLNHQma5ujrlLm6OuUubo65y5mlpnLmaWmcuZpaZy5mlpnLmaWmcubpaZy5ujpnLnaPecudo6Zy5+hpnLwaGmcvB36Zy5bzvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/8QAIBABAQEBAAIABwAAAAAAAAAAABIREwECAwQQFDBQcP/aAAgBAQABBQL39vWPm/Hivb833ftnxPenn9DjGMZ9MYxjGMYxjGMYxjGMYxjEpSlKUpSlKUpSlCEIQhCEIQhCEIcnJxcXFxcXFxcXFxcXJycv4D//xAAbEQEBAAIDAQAAAAAAAAAAAAAAEQEwAhJgcP/aAAgBAwEBPwFy39mc775CIiIiIiIiIifAf//EABwRAQEBAAMAAwAAAAAAAAAAAAATEQESMAJQcP/aAAgBAgEBPwF8Pfo4498Z9/rWt8ta1RRRRRRRRRRRRRRR3/Af/8QAGRAAAgMBAAAAAAAAAAAAAAAAATEAITBw/9oACAEBAAY/AjYUO77h/8QAHhABAQEAAQQDAAAAAAAAAAAAABEBIRAgMEFQUWD/2gAIAQEAAT8hpdhXtxr7YbidIndERnCrru4iIiIiIiIrda3ERERERERERuN7QTxgPvn83m/HAAH/AP2fzcuV1dXV1dXf3P8A/9oADAMBAAIAAwAAABD1v+TzxSRCCCBACADDAiKLNsvk00302/8AvbJpdNFF1BBwgxRRMk0QwyyyyCSf/wD407777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDnDndwzOhLnvM6uXRyzMz2M7szOjOzMzMzPhKUpSlKUpzn6nKcvsSIiIiIiIiIi//EABwRAQEBAQADAQEAAAAAAAAAABEAUQEQIDBAcP/aAAgBAgEBPxDnOt10ufbvMdz1Ij1I8hHg+Z8j5kfJ/IDMzM8nkzz0A2Gw2Gx2Ox2Ox2Ow2Gw2Gw2O/wAB/8QAIBABAQACAgMBAAMAAAAAAAAAAQARUWGREHGhIDAxYP/aAAgBAQABPxASIw/o5ye7N8cZWFfExJ8GLFixY8hE58WNyNVzmOV8TGP8IAJmTsc+FrWv6/KUq58kYx/ZAhCMY+AxjH85IQhHjPG4Zep4zxnjPGz1el6XrHCOMcY4ytStS9S9S9S9S9S9S9WerLULULULULUPU8D5PE+TwJeiVol6JeiXqXo+Weiy0WerPVno+WWi9Szs9tnZ7bke25HtuR7bke25HtuR7bLt7bLt7bLt7bLt7bLt7bLt7bLt7bLt7f8AY//Z",Xt="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDAgT/2gAMAwEAAhADEAAAAc6XpYoSCEpSEpSMoISCPQ50OdDnQ5IOdDklOSlOSDnQssWKpylc4srmWVzLK5lQmFcwhMITCMwhMIzEjMsjMsjML76Tz3lnm9BZ5ryzz3lnnvK898pRdKUXylF8pTdKU3ylN8pTeFVwVXCe7Rma5ujpnLm6WmcuXp6Zy5enpnLl6eucuXp6Zy5enpnLl6emcuZp98S5ul3nLm6Wmcudo6Zy5+hpnL4NDTOXwe/TOXLed6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITMFBw/9oACAEBAAEFAvRTzRERERERERERERERERERERGWWWWWWWWWWWWWWWWHNzc3Nzc3NzYYYYYYYcnFxcXBwcHBwcHFxcXFycvgP//EABcRAQEBAQAAAAAAAAAAAAAAABEAYHD/2gAIAQMBAT8B2BERERERERERwH//xAAbEQEBAQEAAwEAAAAAAAAAAAAAExEBEjBgcP/aAAgBAgEBPwH6DWt9etaoooooopxTinFOKKKKKPP8B//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEABj8CAH//xAAcEAEBAQADAAMAAAAAAAAAAAARAAEQMEBQYHH/2gAIAQEAAT8hIiOkjgiIiIiIiIiIiI4ERERERERHwYAAf/8A++DwAt8wD9YfjoZOzs7Ozs7O/ev/2gAMAwEAAgADAAAAEBAOuj73333736qgkCm3XVdBNNNBNNRXX8QYcQQqmqqmqqoAEemjrrgkssqz7z0w07777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABsRAQEBAAIDAAAAAAAAAAAAABEAIEBREDBg/9oACAEDAQE/EJ4b6HTlmds+WdM4cM7Z2zPKU5SlKc5zn1PqU5S+xIiIiIiIiIiL/8QAHREBAQEAAgMBAQAAAAAAAAAAEQBRMGEBECBAcP/aAAgBAgEBPxD8B8HOcRxERHIfJH5gTM+J8TMzM+g9BsNhsdjsdu67rsuyOw2Gw2Gx3+A//8QAHRABAQADAQEBAQEAAAAAAAAAAQARUWGRIHFgof/aAAgBAQABPxBjGMSxYsWLFixEIERrGsY/ICEIQhGtY1r9flKUpWtaxjH5AQhCEa1rWMfkBCEIR4ni4TxPErU835s9Wer8xzHMcxzHMvUrUmpWpWpWpWpWrLVnqz1D1D1C1C1D1fknklaP8l6JWiVol6JeiVpK0WerLRZ6LLRZavyXR9bo+t0fW6PrdH1uj63R9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9f7H/9k=",qt="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAasKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQABBQIAf//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8BAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/AQB//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQAGPwIAf//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEAAT8hAH//2gAMAwEAAgADAAAAEM8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8QAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/EAB//8QAFhABAQEAAAAAAAAAAAAAAAAAABFw/9oACAEBAAE/ENwiIiIiIiIiIj//2Q==",$t="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAQEBAQEAAAAAAAAAAAAAAQACAwQG/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAAB+6+NdXO8q2eY0ywUAEBCCWEWCAgICBrIaA0WHo5qb5y2OJSEIsICAcggICCoQgaAQNAdCiAhCAgICBYBAQEBAYEJdBGgN1BQEABAsBSEWFBQUCA1g1CBqI1AQEBARRIEFBQUFBQME0SDEagICAiwiilBgIKCgoJCVKBiGDSGYBDKGUsIoQGUGUGUEKCRJCQkFUywZQygIZQEsEszosEsEBCQkJCg/8QAHRAAAQQCAwAAAAAAAAAAAAAAAgADERIBMAQUcP/aAAgBAQABBQIzCnLixbu2UOOWWd1lPr//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQMBAT8BJb2G+3//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQIBAT8BIb0Eu3//xAAZEAACAwEAAAAAAAAAAAAAAAABMQAhMHD/2gAIAQEABj8CNhQ7vuH/xAAgEAEAAgEDBQEAAAAAAAAAAAABABEQIDBgITFAQVBR/9oACAEBAAE/Ib+sK9k7F+4Om9Fy8nRWwHHeMrHduXF4c8AfAfof/9oADAMBAAIAAwAAABC0w8HDHUfe8+/9+8colvcc/wDf/LKL/P8A38MRzzz2sAAAEIMm34b7/wBrCRSyyxyQBAP+++sATwwwwxwyCAM888EBixwxxyyhBP8Av/vnhQgIIIgQxnvvrPv/AD9xQYRV9/zz3//EABwRAAEDBQAAAAAAAAAAAAAAAAEQEUAAITBQcP/aAAgBAwEBPxAmyDABVsb0+gEATxxD/8QAGxEAAwADAQEAAAAAAAAAAAAAAAERECAwUGD/2gAIAQIBAT8QSdGcFvdKXEUgLtCfUXK6P0J7H//EAB0QAQEBAQACAwEAAAAAAAAAAAEAERAgMSFBUWH/2gAIAQEAAT8QAAo+E3T+MW/rq9mUsssvGtra9Nhl75Z+zpV23WUsstttttttsMNr9nfu3lLLLbbbbbbbDbMeBZZZZbbbbbYYYZZZZZZZZbbbbbYYYlllllllttttthhhiWWWWWWW223mxERLMyyyz5ERHDMzM93hERE+5mZmeMcIiImZmZ8iIiJmZmZ5llkEEEEcMzMlllllkEEEEEJmSSSyyyyyCCCCCZJJJLLLLLLIIIIIJJJJLLLLLLLIIIIIL//Z",en="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQEEBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAHOl6WKEgjII9CMgjIIyDnQ5IOdDkg5IEglKDSo466n3HyWGuueJPRwrsCuZZXMshMshMshMshNbIzlIylIzCNgRmCUtnUtnUtkbhKLiyi4sovKouCm4Sm4spuLKriyq4squLKriyq9bKrpbKrpSq+Cfvma5+hpnLnaGmcudo6Zy52jpnLnaOucudpaZy5ulpnLnaWmcudpaZy52lpnLnaWmcufo6Zy5+jplLn6OuUvg0NM5cN53oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/EACEQAQEBAQABAgcAAAAAAAAAAAASERMCATADBBAUIEBw/9oACAEBAAEFAvd8Xynp6V4eXjHu+j4fnL7vyz9DGMYxjPpjGMZ+GMYxjGMYxjGMYxKUpSlKUpSlKUpQhCEIQhCEIQhCHJycnFxcXFxcXFxcXFxcnL+A/wD/xAAcEQEBAAICAwAAAAAAAAAAAAARAAFAAhIwYHD/2gAIAQMBAT8B83HQxm7aD6CREREREREREfAf/8QAHREBAQEAAgIDAAAAAAAAAAAAABMRATACEkBQcP/aAAgBAgEBPwHu8/gc8PTvxn2Otb1a1rXuoooooooooooooop+A//EABoQAAICAwAAAAAAAAAAAAAAAAExACEwQHD/2gAIAQEABj8CzCCwtB9h/8QAHxABAQEAAQMFAAAAAAAAAAAAABEBIRAgMEBBUFFg/9oACAEBAAE/IYid0TpGYw519qXIR7oiIiIiIiMzr28KkRERERERGYxmr4AE7QwzETy+z56HwAGfFh//ANn87q6urq6uuXP7H//aAAwDAQACAAMAAAAQAgAQgggQkU88k/b9/vN9NNN5LbziiIwwRRxgwBB1FFNdpJbvTj//AH0gsssssENJDL777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDDM4d+MOO7iDJ0curPYZmZ1Zmd2cszMzM7M+CpynP1OcpSlKUpS+xIiIiIiIiIiL//xAAcEQEBAQEBAQADAAAAAAAAAAARAFEBMCAQQHD/2gAIAQIBAT8Q9e3XS7zrEfJEfPZ7nPmfgjwDyPIj9V+A8meTyZmZ+QOw2Gw2Gw2Ox2Ox2Ox2Gw2Gw3+A/wD/xAAgEAEBAAICAwEAAwAAAAAAAAABABFRYZEQcaEgMDFg/9oACAEBAAE/EHyMWLFix4ECPCypZvjjCUCEP6GMHuf4QAQh4RwkjEcYg48WNzWv6/KUp4pxOWbMY/sEQh5CQcxjH8pKQh4BCEeM8Z4zwvW9L0hajjHGOMcYerhjjHGXqVqVqVqVqy1Z6h6h6h6h6h6h6h6hahavUstFno+WerPVlos9EPR8h6h6IeiFoh6I4EcT5HA+WXb22Xb22Xb22Xb22Xb22Xb22Xb22Xb23I9tyPbcj23I9tyPbcj22dnts7Pb/sf/2Q==",tn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAc7vSxRkEJSkJSkewRkEehzoc6HOhyQckEZKclKckHJBKZFcyyuZZXMsrmVCYVzCEwhMIzCEwjMSMyyMyyM1I2Sk7hKLivPeHnvlPPfKUXSlF8pRfKU3SlN8pTeFN4lN5ZT6Cym8spvLL/fM1z9DTOXO0NM5c7R0zlzdLTOXN0tM5czT08S5mnpnLm6emcubp6Zy5unpnLm6fvOXN09M5c7S0zlztHTOXP0dM5cVzugAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITEFBw/9oACAEBAAEFAvWzzEREREREREREREREREREREZZZZZZZZZZZZZZZZYYYYYYYc3Nzc3Nzc3NhycnFxcXFwcHBwcHBxcXFy+A/wD/xAAXEQEBAQEAAAAAAAAAAAAAAAARAGBw/9oACAEDAQE/AdgREREREREREcB//8QAGxEBAQEBAAMBAAAAAAAAAAAAABMRARIwYHD/2gAIAQIBAT8B+g1rfXrWvNRRRRRTinFOKcUUUUUU/Af/xAAUEAEAAAAAAAAAAAAAAAAAAACA/9oACAEBAAY/AgB//8QAHBABAQEAAwADAAAAAAAAAAAAEQABEDBAUGBx/9oACAEBAAE/ITgjpIiIiIiIiIiIiIiIiIiIiIjgR8cAAH//AIAfPB34GdRTfjxBrs7Ozs7Ozv3H/9oADAMBAAIAAwAAABBAKqp+9999+8/roAR90XXQTTTQTRV11spECCqpqqpqoIHGEHFMNM+8+vLJIK645rq+++++++++++++++888888888888888888888888888888888888888888888888//xAAbEQEBAAIDAQAAAAAAAAAAAAARACAwEEBRYP/aAAgBAwEBPxDc4uh1szi5M5M8s8s5s4OpmeqpTlPyfk5znKUpTl9iREREREREREX/xAAdEQEBAQABBQEAAAAAAAAAAAARAFFhARAgMEBw/9oACAECAQE/EPrPA7nqPSREesjxPoDsZmZmek9JmHcOw2Gw2Gx25Lkua5o7HY7DYbDfwH//xAAdEAEBAAMBAQEBAQAAAAAAAAABABFRYZEgcWCh/9oACAEBAAE/EGJMZixYsWLFiCIQhGMYxj8gIQhSFa1rX6/KUpClYxjH5AQhCFKVjGMfkBCEKUpXmeZ5nmeb82erPV+Y5hajiOLhHEcS9StStS9S9WerPVlqFqFqFqFqFqTULUPV+Sy1ZaLPRZaLPULRC0h6IeiFohaIeiFo/wAjkvyWXb62Xb62Xb62Xb62Xb62Xb62Xb62Xb62Xb63R9bo+t0fW6PrdH1uj63R9f7H/9k=";const nn=new Be;ge.install({THREE:be});class ye{constructor(){p(this,"animationPlugin");p(this,"cameraControlsPlugin");p(this,"gltfValidatorPlugin");p(this,"helpersPlugin");p(this,"humanoidTransformPlugin");p(this,"lookAtPlugin");p(this,"postProcessingPlugin");p(this,"_scene");p(this,"_camera");p(this,"_renderer");p(this,"_composer");p(this,"_model");p(this,"_stats",null);p(this,"_webglMemory",null);p(this,"_webglMemoryInfo",null);p(this,"_dracoLoader");p(this,"_loader");p(this,"_canvas");p(this,"_layerMode","thirdPerson");p(this,"_handleResize");p(this,"_ongoingRequestEnvMap");p(this,"_plugins");this._camera=new At(30,window.innerWidth/window.innerHeight,.1,20),this._camera.position.set(0,1,5),this._scene=new at;const e=new lt(16777215);e.position.set(1,1,1).normalize(),this._scene.add(e),this.helpersPlugin=new Gt(this),this._dracoLoader=new ct,this._dracoLoader.setDecoderPath("./draco/"),this._loader=new dt,this._loader.setDRACOLoader(this._dracoLoader),this._loader.register(t=>new ht(t,{humanoidPlugin:new mt(t,{helperRoot:this.helpersPlugin.humanoidHelperRoot}),lookAtPlugin:new ut(t,{helperRoot:this.helpersPlugin.lookAtHelperRoot}),springBonePlugin:new pt(t,{jointHelperRoot:this.helpersPlugin.springBoneJointHelperRoot,colliderHelperRoot:this.helpersPlugin.springBoneColliderHelperRoot})})),this.animationPlugin=new Nt(this),this.cameraControlsPlugin=new Vt(this),this.gltfValidatorPlugin=new te(this),this.humanoidTransformPlugin=new Ot(this),this.lookAtPlugin=new Wt(this),this.postProcessingPlugin=new Yt(this),this._plugins=[this.animationPlugin,this.cameraControlsPlugin,this.gltfValidatorPlugin,this.helpersPlugin,this.humanoidTransformPlugin,this.lookAtPlugin,this.postProcessingPlugin]}get scene(){return this._scene}get camera(){return this._camera}get renderer(){return this._renderer}get composer(){return this._composer}get model(){var e;return(e=this._model)!=null?e:null}get stats(){return this._stats}get webglMemoryInfo(){return this._webglMemoryInfo}get canvas(){return this._canvas}get layerMode(){return this._layerMode}set layerMode(e){this._layerMode=e,this._updateLayerMode()}unloadVRM(){const e=this._model;e&&(this._scene.remove(e.scene),Y.deepDispose(e.scene),this._emit("unload")),this._plugins.forEach(t=>{var n;return(n=t.handleAfterUnload)==null?void 0:n.call(t)}),this._model=null}async loadVRM(e){var h,m,g,d,E;const t=await fetch(e).then(u=>u.arrayBuffer());this.unloadVRM();const r=new gt({credentials:"include"}).binaryToJSON(t).json,i=await new Promise((u,x)=>{this._loader.crossOrigin="anonymous",this._loader.load(e,B=>{u(B)},B=>{this._emit("progress",B)},B=>{this._emit("error",B),x(B)})});Y.removeUnnecessaryVertices(i.scene),Y.removeUnnecessaryJoints(i.scene);const A=(h=i.userData.vrm)!=null?h:null;A==null&&console.warn("Failed to load the model as a VRM. Fallback to treat the model as a mere GLTF"),this._stats=await this._prepareStats(i,A);const l=(m=A==null?void 0:A.scene)!=null?m:i.scene;this._scene.add(l);const c={buffer:t,gltf:i,originalGLTFJSON:r,vrm:A,scene:l};return this._model=c,this._plugins.forEach(u=>{var x;return(x=u.handleAfterLoad)==null?void 0:x.call(u,c)}),A&&((g=A.firstPerson)==null||g.setup(),this._updateLayerMode(),A.scene.traverse(u=>{"isMesh"in u&&Kt(u,async x=>{"isMeshStandardMaterial"in x&&(x.envMap=await this._requestEnvMap())})}),Y.rotateVRM0(A),(d=A.springBoneManager)==null||d.setInitState(),(E=A.nodeConstraintManager)==null||E.setInitState()),this._emit("load",c),c}async exportBufferView(e){var l;const t=(l=this._model)==null?void 0:l.gltf;if(t==null)return;const n=await t.parser.getDependency("bufferView",e),r=new Blob([n]),i=URL.createObjectURL(r),A=document.createElement("a");A.href=i,A.download=`${e}.bin`,A.click(),URL.revokeObjectURL(i)}setup(e){this._canvas=e;const t=window.innerWidth,n=window.innerHeight,r=window.devicePixelRatio;this._renderer=new ft({canvas:this._canvas}),this._renderer.outputEncoding=Et,this._renderer.setSize(t,n),this._renderer.setPixelRatio(r),this._composer=new xt(this._renderer,new Bt(t,n,{type:bt})),this._composer.setPixelRatio(window.devicePixelRatio);const i=new Ct(this._scene,this._camera);this._composer.addPass(i),this._handleResize&&window.removeEventListener("resize",this._handleResize),this._handleResize=()=>{this._camera.aspect=window.innerWidth/window.innerHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(window.innerWidth,window.innerHeight),this._composer.setSize(window.innerWidth,window.innerHeight)},window.addEventListener("resize",this._handleResize),this._webglMemory=this._renderer.getContext().getExtension("GMAN_webgl_memory"),this._plugins.forEach(A=>{var l;return(l=A.handleAfterSetup)==null?void 0:l.call(A)})}registerDnD(e){const t=r=>{r.preventDefault()},n=r=>{r.preventDefault();const i=r.dataTransfer.files;if(!i)return;const A=i[0];if(!A)return;const l=new Blob([A],{type:"application/octet-stream"}),c=URL.createObjectURL(l);this.loadVRM(c)};return e.addEventListener("dragover",t),e.addEventListener("drop",n),()=>{e.removeEventListener("dragover",t),e.removeEventListener("drop",n)}}update(e){var t;((t=this._model)==null?void 0:t.vrm)&&this._model.vrm.update(e),this._plugins.forEach(n=>{var r;return(r=n.handleBeforeRender)==null?void 0:r.call(n,e)}),this._composer&&this._composer.render(e),this._webglMemory&&(this._webglMemoryInfo=this._webglMemory.getMemoryInfo())}async _prepareStats(e,t){var E,u,x;const n=new wt,r=new Set;let i=0,A=0,l=0;const c=B=>{var M,b;A++;const C=B.geometry;n.expandByObject(B);const I=C.getAttribute("position");r.add(I),l+=((b=(M=C.index)==null?void 0:M.count)!=null?b:I.count)/3};(await e.parser.getDependencies("mesh")).forEach(B=>{i++,B.isMesh?c(B):B.children.forEach(I=>{c(I)})});let m=0;for(const B of r)m+=B.count;const g=await e.parser.getDependencies("material"),d=(x=(u=(E=t==null?void 0:t.springBoneManager)==null?void 0:E.joints)==null?void 0:u.size)!=null?x:0;return{dimension:n.getSize(nn).toArray(),vertices:m,polygons:l,meshes:i,primitives:A,materials:g.length,joints:d}}_requestEnvMap(){const e=[Xt,Jt,$t,qt,tn,en];if(!this._ongoingRequestEnvMap){const t=new Rt;this._ongoingRequestEnvMap=new Promise((n,r)=>{t.load(e,i=>n(i),void 0,i=>r(i))})}return this._ongoingRequestEnvMap}_updateLayerMode(){var t,n;const e=(n=(t=this._model)==null?void 0:t.vrm)==null?void 0:n.firstPerson;!e||(this._layerMode==="firstPerson"?(this._camera.layers.enable(e.firstPersonOnlyLayer),this._camera.layers.disable(e.thirdPersonOnlyLayer)):(this._camera.layers.disable(e.firstPersonOnlyLayer),this._camera.layers.enable(e.thirdPersonOnlyLayer)))}}Zt(ye,[Tt]);var on="./assets/uv-grid.cfc47a74.png",D;(function(o){o[o.None=0]="None",o[o.GLTFFallback=1]="GLTFFallback",o[o.MToonNormal=2]="MToonNormal",o[o.MToonLitShadeRate=3]="MToonLitShadeRate",o[o.MToonUV=4]="MToonUV",o[o.UVGrid=5]="UVGrid"})(D||(D={}));const Pe=new $({visible:!1}),sn=new Promise(o=>{new Ee().load(on,t=>{t.flipY=!1,o(t)})});function ke(){const o=new $({color:16711935});return sn.then(e=>{o.map=e,o.color.set(16777215)}),o}function Qe(o,e){if("isMToonMaterial"in o){const t=o;t.debugMode=e}}function Le(o){return"isMToonMaterial"in o?o.isOutline:!1}class rn{constructor(e){p(this,"_currentMode",0);p(this,"_vrmMaterialsByMesh",new Map);p(this,"_inspector");this._inspector=e,this._inspector.on("load",()=>this._handleLoad()),this._inspector.on("unload",()=>this._handleUnload())}applyMode(e){e===0?this._applyModeMToon(Z.None):e===2?this._applyModeMToon(Z.Normal):e===3?this._applyModeMToon(Z.LitShadeRate):e===4?this._applyModeMToon(Z.UV):e===5&&this._applyModeUVGrid(),this._currentMode=e}_applyModeMToon(e){for(const[t,n]of this._vrmMaterialsByMesh.entries())Array.isArray(n)?n.forEach((r,i)=>{Qe(r,e),t.material[i]=r}):(Qe(n,e),t.material=n)}_applyModeUVGrid(){for(const[e,t]of this._vrmMaterialsByMesh.entries())Array.isArray(t)?t.forEach((n,r)=>{Le(n)?e.material[r]=Pe:e.material[r]=ke()}):Le(t)?e.material=Pe:e.material=ke()}async _handleLoad(){(await this._inspector.model.gltf.parser.getDependencies("mesh")).forEach(t=>{if("isGroup"in t)t.children.forEach(r=>{const i=r;this._addManagedMesh(i)});else{const n=t;this._addManagedMesh(n)}}),this.applyMode(this._currentMode)}_addManagedMesh(e){Array.isArray(e.material)?this._vrmMaterialsByMesh.set(e,e.material.concat()):this._vrmMaterialsByMesh.set(e,e.material)}_handleUnload(){this._vrmMaterialsByMesh.clear()}}var ze="./assets/VRM1_Constraint_Twist_Sample.859297e7.vrm";function An(o){console.error(o)}const U=new ye;U.loadVRM(ze).catch(An);U.registerDnD(document.body);const an=new Ht(U),ln=new rn(U);console.info(U);const cn=new vt;function _e(){requestAnimationFrame(_e);const o=cn.getDelta();U.update(o)}_e();const P=Ce.createContext({inspector:U,highlighter:an,materialDebugger:ln}),Se=({href:o,widthClass:e})=>o==null?null:s("a",{href:o,target:"_blank",rel:"noreferrer",className:`font-bold truncate inline-block align-top underline text-sky-500 ${e!=null?e:"w-64"}`,children:o});function dn(){const o=a.exports.useRef(-1/0);return a.exports.useCallback(t=>{const n=performance.now();n-o.current<250?(t(),o.current=-1/0):o.current=n},[o])}const L=o=>{var h,m,g;const[e,t]=a.exports.useState((h=o.initPosition)!=null?h:{left:0,top:0}),[n,r]=a.exports.useState((m=o.initOpening)!=null?m:!1),i=dn(),A=a.exports.useCallback(d=>{var E;(E=o.onClick)==null||E.call(o,d,o.paneKey)},[o.onClick,o.paneKey]),l=a.exports.useCallback(d=>{d.preventDefault();let E=e.left,u=e.top;ve((x,B)=>{x.preventDefault(),x.stopPropagation(),E+=B.x,u+=B.y,t({left:E,top:u})}),i(()=>{r(!n)})},[n,e]),c=a.exports.useCallback(d=>{var E;d.preventDefault(),d.stopPropagation(),(E=o.onClick)==null||E.call(o,d,o.paneKey),r(!n)},[n,o.onClick,o.paneKey]);return v("div",{style:{left:e.left,top:e.top,minWidth:"15rem",boxShadow:"0 0 10px rgba(0, 0, 0, 1.0)"},className:`absolute shadow ${o.className}`,onMouseDown:A,children:[v("div",{className:"h-5 leading-5 w-full bg-gray-700 cursor-move",onMouseDown:l,children:[s("div",{className:"inline-block w-5 h-5 text-center cursor-pointer hover:text-sky-500",onMouseDown:c,children:n?"-":"+"}),o.title]}),n&&((g=o.children)!=null?g:null)]})},z=({className:o,paddingClass:e,children:t})=>s("div",{className:`bg-gray-900/80 backdrop-blur ${e!=null?e:"p-2"} ${o}`,children:t}),hn=o=>s(L,R(w({},o),{children:v(z,{children:[s("div",{children:"three-vrm-inspector"}),s("div",{children:"Three.js based VRM inspector"}),v("div",{children:["Source: ",s(Se,{widthClass:"w-min",href:"https://github.com/0b5vr/three-vrm-inspector"})]})]})})),F=({label:o,onChange:e,defaultValue:t,disabled:n})=>{const r=a.exports.useCallback(i=>{const A=parseFloat(i.currentTarget.value);e(A)},[]);return v("div",{className:"flex items-center",children:[s("input",{className:"mr-2",type:"range",min:"0",max:"1",step:"0.001",defaultValue:t!=null?t:0,disabled:n,onChange:r}),n?s("span",{className:"text-gray-500",children:o}):o]})},He=({name:o,isAvailable:e})=>{const{inspector:t}=a.exports.useContext(P),n=a.exports.useCallback(r=>{var i,A,l;(l=(A=(i=t.model)==null?void 0:i.vrm)==null?void 0:A.expressionManager)==null||l.setValue(o,r)},[]);return s(F,{label:o,disabled:!e,onChange:n})},O=()=>s("div",{className:"w-full h-0.5 my-2 bg-gray-500"}),Te=[y.Neutral,y.Happy,y.Angry,y.Sad,y.Relaxed,y.Surprised,y.Blink,y.BlinkLeft,y.BlinkRight,y.Aa,y.Ee,y.Ih,y.Oh,y.Ou,y.LookLeft,y.LookRight,y.LookDown,y.LookUp],mn=new Set(Te),un=o=>{var A,l,c;const{inspector:e}=a.exports.useContext(P),t=(l=(A=e.model)==null?void 0:A.vrm)==null?void 0:l.expressionManager,n=t==null?void 0:t.expressionMap,r=[];n&&Array.from(Object.keys(n)).forEach(h=>{mn.has(h)||r.push(h)});const i=((c=r==null?void 0:r.length)!=null?c:0)>=1;return s(L,R(w({},o),{children:s(z,{children:t?v(_,{children:[Te.map(h=>s(He,{name:h,isAvailable:(t==null?void 0:t.getExpression(h))!=null},h)),s(O,{}),r==null?void 0:r.map(h=>s(He,{name:h,isAvailable:!0},h)),!i&&s("span",{className:"text-gray-500",children:"(No custom expressions)"})]}):"No blendShapeProxy detected."})}))},pn=o=>{const{inspector:e}=a.exports.useContext(P),t=a.exports.useRef(null),n=a.exports.useCallback(r=>{var A;r.preventDefault();const i=(A=t.current)==null?void 0:A.value;if(i!=null&&i!==""){const l=parseInt(i,10);e.exportBufferView(l)}},[e]);return s(L,R(w({},o),{children:s(z,{children:v("form",{onSubmit:n,children:[s("input",{type:"number",ref:t,defaultValue:0,className:"w-24 px-1 bg-gray-800 border border-gray-500",required:!0}),s("input",{type:"submit",className:"ml-1 px-1 bg-gray-800 border border-gray-500",value:"Export"})]})})}))},T=({callback:o,label:e,checked:t})=>{const n=a.exports.useCallback(({target:r})=>{o(r.checked)},[o]);return v("div",{children:[s("input",{type:"checkbox",checked:t,onChange:n}),s("label",{className:"ml-1",children:e})]})},gn=o=>{const{inspector:e}=a.exports.useContext(P),[t,n]=a.exports.useState(!0),[r,i]=a.exports.useState(!0),[A,l]=a.exports.useState(!0),[c,h]=a.exports.useState(!0),[m,g]=a.exports.useState(!0),[d,E]=a.exports.useState(!0),[u,x]=a.exports.useState(!0),B=a.exports.useCallback(()=>{n(!0),i(!0),l(!0),h(!0),g(!0),E(!0),x(!0)},[]),C=a.exports.useCallback(()=>{n(!1),i(!1),l(!1),h(!1),g(!1),E(!1),x(!1)},[]),I=a.exports.useCallback(Q=>{n(Q)},[e]),M=a.exports.useCallback(Q=>{i(Q)},[e]),b=a.exports.useCallback(Q=>{l(Q)},[e]),k=a.exports.useCallback(Q=>{h(Q)},[e]),S=a.exports.useCallback(Q=>{g(Q)},[e]),H=a.exports.useCallback(Q=>{E(Q)},[e]),N=a.exports.useCallback(Q=>{x(Q)},[e]);return a.exports.useEffect(()=>{e.helpersPlugin.gridHelper.visible=t},[e,t]),a.exports.useEffect(()=>{e.helpersPlugin.axesHelper.visible=r},[e,r]),a.exports.useEffect(()=>{e.helpersPlugin.humanoidHelperRoot.visible=A},[e,A]),a.exports.useEffect(()=>{e.humanoidTransformPlugin.active=c},[e,c]),a.exports.useEffect(()=>{e.helpersPlugin.lookAtHelperRoot.visible=m},[e,m]),a.exports.useEffect(()=>{e.helpersPlugin.springBoneJointHelperRoot.visible=d},[e,d]),a.exports.useEffect(()=>{e.helpersPlugin.springBoneColliderHelperRoot.visible=u},[e,u]),s(L,R(w({},o),{children:v(z,{children:[s("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:B,children:"Enable All"}),s("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:C,children:"Disable All"}),s(O,{}),s(T,{callback:I,label:"Grid",checked:t}),s(T,{callback:M,label:"Axes",checked:r}),s(T,{callback:b,label:"Humanoid",checked:A}),s(T,{callback:k,label:"Humanoid Transform",checked:c}),s(T,{callback:S,label:"LookAt",checked:m}),s(T,{callback:H,label:"Spring Bones",checked:d}),s(T,{callback:N,label:"Spring Bone Colliders",checked:u})]})}))},fn="modulepreload",De={},En="./",xn=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${En}${n}`,n in De)return;De[n]=!0;const r=n.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const A=document.createElement("link");if(A.rel=r?"stylesheet":fn,r||(A.as="script",A.crossOrigin=""),A.href=n,document.head.appendChild(A),r)return new Promise((l,c)=>{A.addEventListener("load",l),A.addEventListener("error",c)})})).then(()=>e())};const Bn=`// Press Ctrl+S or Ctrl+R to apply
// The api will be changed without notice! Use at your own risk

export default ( { inspector, THREE } ) => {
  let isUnmounted = false;

  const vrm = inspector.model.vrm;

  // update
  const beginTime = Date.now();

  function update() {
    if ( isUnmounted ) { return; }

    const time = 0.001 * ( Date.now() - beginTime );

    const leftUpperArm = vrm.humanoid?.getNormalizedBoneNode( 'leftUpperArm' );
    if ( leftUpperArm != null ) {
      leftUpperArm.rotation.z = Math.sin( time );
    }

    requestAnimationFrame( update );
  }
  requestAnimationFrame( update );

  // uninit
  return () => {
    isUnmounted = true;
  };
}
`,bn=o=>{const{inspector:e}=a.exports.useContext(P),[t,n]=a.exports.useState(Bn),[r,i]=a.exports.useState(!1),A=a.exports.useRef();a.exports.useEffect(()=>{window.addEventListener("beforeunload",g=>{if(r){const d="You will lose all of your changes on the editor!";return g.returnValue=d,d}})},[r]);const l=a.exports.useCallback(g=>{var u;(u=A.current)==null||u.call(A);const d=new Blob([g],{type:"text/javascript"}),E=URL.createObjectURL(d);xn(()=>import(E),[]).then(x=>{A.current=x.default({inspector:e,THREE:be}),URL.revokeObjectURL(E)})},[e]),c=a.exports.useCallback(g=>{g.addKeyMap({"Ctrl-S":()=>{l(g.getValue())},"Ctrl-R":()=>{l(g.getValue())}})},[l]),h=a.exports.useCallback((g,d,E)=>{n(E),i(!0)},[]),m=a.exports.useCallback(()=>{},[]);return s(L,R(w({},o),{children:s(z,{className:"w-120 h-80",paddingClass:"p-0",children:s(Mt,{value:t,options:{mode:"text/javascript",keyMap:"sublime",theme:"monokai-sharp",lineNumbers:!0},editorDidMount:c,onBeforeChange:h,onChange:m,className:"h-full leading-tight"})})}))},J=({children:o,onClick:e,onMouseEnter:t,onMouseLeave:n})=>s("span",{className:"select-none cursor-pointer",onClick:e,onMouseEnter:t,onMouseLeave:n,children:o}),Ue=({children:o})=>s("div",{style:{marginLeft:"1.13em"},children:o}),ne=({name:o,value:e,fullPath:t=""})=>{const{highlighter:n}=a.exports.useContext(P),[r,i]=a.exports.useState(!1),[A,l]=a.exports.useState(!1),[c,h]=a.exports.useState([void 0]),m=a.exports.useCallback(b=>{b.stopPropagation(),i(!r)},[i,r]),g=a.exports.useCallback(()=>{l(!0),h([n.highlight(t)])},[l,h,n,t]),d=a.exports.useCallback(()=>{var b;l(!1),(b=c[0])==null||b.call(c)},[l,c]),E=Array.isArray(e),u=e==null,x=typeof e=="number",B=typeof e=="boolean",C=typeof e=="string",I=!E&&!u&&!x&&!B&&!C,M={onClick:m,onMouseEnter:g,onMouseLeave:d,isHovering:A};return v("div",{className:"select-auto",children:[s("span",R(w({className:`cursor-pointer ${A&&"text-sky-500"}`},M),{children:o?`${o}: `:""})),E&&v(_,{children:[s(J,R(w({},M),{children:"["})),r&&s(Ue,{children:e.map((b,k)=>s("div",{children:s(ne,{name:k.toString()+((b==null?void 0:b.name)?` (${b.name})`:""),value:b,fullPath:`${t}/${k}`})},k))}),s(J,R(w({},M),{children:` ${r?"":e.length} ]`}))]}),I&&v(_,{children:[s(J,R(w({},M),{children:"{"})),r&&s(Ue,{children:Object.keys(e).map((b,k)=>s("div",{children:s(ne,{name:b,value:e[b],fullPath:`${t}/${b}`})},k))}),s(J,R(w({},M),{children:` ${r?"":Object.keys(e).join(", ")} }`}))]}),u&&s(_,{children:s("span",R(w({className:"text-pink-500"},M),{children:e}))}),x&&s(_,{children:s("span",R(w({className:"text-indigo-400"},M),{children:e}))}),B&&s(_,{children:s("span",R(w({className:"text-indigo-400"},M),{children:String(e)}))}),C&&s(_,{children:v("span",R(w({className:"text-yellow-300"},M),{children:['"',e,'"']}))})]})},Cn=o=>{const{inspector:e}=a.exports.useContext(P),[t,n]=a.exports.useState(void 0);return a.exports.useEffect(()=>{const r=()=>{var i;n((i=e.model)==null?void 0:i.originalGLTFJSON)};return e.on("load",r),()=>{e.off("load",r)}},[e]),s(L,R(w({},o),{children:s(z,{className:"w-120 h-80 overflow-scroll whitespace-nowrap resize font-mono text-xs leading-tight",paddingClass:"p-0",children:s(ne,{value:t})})}))},wn=o=>{const{inspector:e}=a.exports.useContext(P),[t,n]=a.exports.useState(!0),r=a.exports.useCallback(i=>{n(i),e.lookAtPlugin.enableLookAt=i},[e]);return s(L,R(w({},o),{children:s(z,{children:s(T,{callback:r,label:"Enable LookAt",checked:t})})}))},Rn=o=>{const{materialDebugger:e}=a.exports.useContext(P),t=a.exports.useCallback(n=>{const r=parseInt(n.target.value);e.applyMode(r)},[e]);return s(L,R(w({},o),{children:s(z,{children:v("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:[s("option",{value:D.None,children:"None"}),s("option",{value:D.MToonNormal,children:"MToon Normal"}),s("option",{value:D.MToonLitShadeRate,children:"MToon LitShadeRate"}),s("option",{value:D.MToonUV,children:"MToon UV"}),s("option",{value:D.UVGrid,children:"UV Grid"})]})})}))},f=({name:o,value:e,href:t})=>v("div",{children:[o,":"," ",e!=null&&s("span",{className:"font-bold",children:e}),t&&s(Se,{href:t})]}),vn=({meta:o})=>v(_,{children:[s(f,{name:"Title",value:o.title}),s(f,{name:"Author",value:o.author}),s(f,{name:"Version",value:o.version}),s(f,{name:"Reference",value:o.reference}),s(f,{name:"Contact Information",value:o.contactInformation}),s(f,{name:"Allowed User Name",value:o.allowedUserName}),s(f,{name:"Violent Ussage Name",value:o.violentUssageName}),s(f,{name:"Sexual Ussage Name",value:o.sexualUssageName}),s(f,{name:"Commercial Ussage Name",value:o.commercialUssageName}),s(f,{name:"Other Permission URL",href:o.otherPermissionUrl}),s(f,{name:"License Name",value:o.licenseName}),s(f,{name:"Other License URL",href:o.otherLicenseUrl})]}),Mn=({meta:o})=>{var e;return v(_,{children:[s(f,{name:"Name",value:o.name}),s(f,{name:"Version",value:o.version}),s(f,{name:"Authors",value:o.authors.join(", ")}),s(f,{name:"Copyright Information",value:o.copyrightInformation}),s(f,{name:"Contact Information",value:o.contactInformation}),s(f,{name:"References",value:(e=o.references)==null?void 0:e.join(", ")}),s(f,{name:"Third Party Licenses",value:o.thirdPartyLicenses}),s(f,{name:"License URL",href:o.licenseUrl}),s(f,{name:"Avatar Permission",value:o.avatarPermission}),s(f,{name:"Allow Excessively Violent Usage",value:String(o.allowExcessivelyViolentUsage)}),s(f,{name:"Allow Excessively Sexual Usage",value:String(o.allowExcessivelySexualUsage)}),s(f,{name:"Commercial Usage Name",value:o.commercialUsage}),s(f,{name:"Allow Political or Religious Usage",value:String(o.allowPoliticalOrReligiousUsage)}),s(f,{name:"Allow Antisocial or Hate Usage",value:String(o.allowAntisocialOrHateUsage)}),s(f,{name:"Credit Notation",value:o.creditNotation}),s(f,{name:"Allow Redistribution",value:String(o.allowRedistribution)}),s(f,{name:"Modification",value:o.modification}),s(f,{name:"Other License URL",href:o.otherLicenseUrl})]})},In=o=>{var r,i;const{inspector:e}=a.exports.useContext(P),t=(i=(r=e.model)==null?void 0:r.vrm)==null?void 0:i.meta;let n=s(_,{children:"No meta detected."});return(t==null?void 0:t.metaVersion)==="1"?n=s(Mn,{meta:t}):(t==null?void 0:t.metaVersion)==="0"&&(n=s(vn,{meta:t})),s(L,R(w({},o),{children:s(z,{children:n})}))};var yn="./assets/dancing.2665f039.fbx",Pn="./assets/gangnam-style.119f68a4.fbx",kn="./assets/jump.a8a08f02.fbx",Qn="./assets/running.c854d669.fbx",Ln="./assets/standing-clap.9fc941e1.fbx",zn="./assets/walking.ed38b4d6.fbx";const _n=[{name:"(No Animation)",url:"-"},{name:"Walking",url:zn},{name:"Running",url:Qn},{name:"Jump",url:kn},{name:"Dancing",url:yn},{name:"Standing Clap",url:Ln},{name:"Gangnam Style",url:Pn}],Sn=o=>{const{inspector:e}=a.exports.useContext(P),t=a.exports.useCallback(n=>{const r=n.target.value;r==="-"?e.animationPlugin.clearMixamoAnimation():e.animationPlugin.loadMixamoAnimation(r)},[e]);return s(L,R(w({},o),{children:s(z,{children:s("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:_n.map(({name:n,url:r})=>s("option",{value:r,children:n},r))})})}))},Ne=({label:o,onChange:e,defaultChecked:t,disabled:n})=>{const r=a.exports.useCallback(i=>{const A=i.currentTarget.checked;e(A)},[]);return v("div",{className:"flex items-center",children:[s("input",{className:"mr-2",type:"checkbox",disabled:n,defaultChecked:t,onChange:r}),n?s("span",{className:"text-gray-500",children:o}):o]})},Hn=o=>{const{inspector:e}=a.exports.useContext(P),[t,n]=a.exports.useState(!1),r=a.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.enabled=d,n(d)},[e]),i=a.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.strength=4*d},[e]),A=a.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.radius=d},[e]),l=a.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.threshold=4*d},[e]),[c,h]=a.exports.useState(!1),m=a.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.enabled=d,h(d)},[e]),g=a.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.uniforms.exposure.value=2*d},[e]);return s(L,R(w({},o),{children:v(z,{children:[s("h3",{className:"text-lg font-bold",children:"Bloom"}),s(Ne,{label:"Enabled",defaultChecked:!1,onChange:r}),s(F,{label:"Strength",defaultValue:.25,disabled:!t,onChange:i}),s(F,{label:"Radius",defaultValue:.5,disabled:!t,onChange:A}),s(F,{label:"Threshold",defaultValue:.25,disabled:!t,onChange:l}),s(O,{}),s("h3",{className:"text-lg font-bold",children:"ACES Tone Mapping"}),s(Ne,{label:"Enabled",defaultChecked:!1,onChange:m}),s(F,{label:"Exposure",defaultValue:.5,disabled:!c,onChange:g})]})}))},Tn=({name:o,url:e})=>{const{inspector:t}=a.exports.useContext(P),n=a.exports.useCallback(()=>{t.loadVRM(e)},[t]);return s("button",{value:o,className:"bg-gray-800 border border-gray-500 px-1 py-0 block",onClick:n,children:o})};var Dn="./assets/Seed-san.624d0d55.vrm",Un="./assets/three-vrm-girl.e6e179de.vrm";const Nn=[{name:"three-vrm-girl (VRM0.0)",url:Un},{name:"Seed-san (VRM1.0)",url:Dn},{name:"VRM1_Constaint_Twist_Sample (VRM1.0)",url:ze}],Vn=o=>s(L,R(w({},o),{children:s(z,{children:Nn.map(({name:e,url:t})=>s(Tn,{name:e,url:t},e))})})),Gn=o=>{var r,i,A,l,c,h,m,g,d,E;const{inspector:e}=a.exports.useContext(P),t=(r=e.stats)==null?void 0:r.dimension.map(u=>u.toFixed(3)),n=`( ${(i=t==null?void 0:t[0])!=null?i:0}, ${(A=t==null?void 0:t[1])!=null?A:0}, ${(l=t==null?void 0:t[2])!=null?l:0} )`;return s(L,R(w({},o),{children:v(z,{children:[s(f,{name:"Dimension",value:n}),s(f,{name:"Vertices",value:(c=e.stats)==null?void 0:c.vertices}),s(f,{name:"Polygons",value:(h=e.stats)==null?void 0:h.polygons}),s(f,{name:"Meshes",value:(m=e.stats)==null?void 0:m.meshes}),s(f,{name:"Primitives",value:(g=e.stats)==null?void 0:g.primitives}),s(f,{name:"Materials",value:(d=e.stats)==null?void 0:d.materials}),s(f,{name:"Spring Bone Joints",value:(E=e.stats)==null?void 0:E.joints})]})}))},Fn=({children:o})=>s("div",{style:{marginLeft:"1.13em"},children:o}),On=o=>{const[e,t]=a.exports.useState(!1),n=o.severity===0?V.error:o.severity===1?V.warning:V.severityInfo,r=a.exports.useCallback(()=>{t(!e)},[e]);return v("div",{className:"group cursor-pointer",onClick:r,children:[s("span",{className:"group-hover:text-sky-500",children:e?"- ":"+ "}),s("span",{style:{color:n},children:o.code}),s("span",{className:"text-gray-500",children:" - "+o.pointer}),e&&s(Fn,{children:o.message})]})},X=({count:o,colorClass:e})=>s("span",{className:o?e:"text-gray-500",children:o}),jn=o=>{var A,l;const{inspector:e}=a.exports.useContext(P),t=(A=e.gltfValidatorPlugin.validationReport)==null?void 0:A.issues,[n,r]=a.exports.useReducer(c=>c+1,0),i=a.exports.useCallback(()=>{const c=2*t.messages.length;e.gltfValidatorPlugin.validate(c).then(()=>r())},[t]);return s(L,R(w({},o),{children:v(z,{className:"w-120 h-80 resize overflow-y-scroll",children:[s(f,{name:"Validator Version",value:(l=e.gltfValidatorPlugin.validationReport)==null?void 0:l.validatorVersion}),s(f,{name:"Errors",value:s(X,{count:t==null?void 0:t.numErrors,colorClass:"text-red-500"})}),s(f,{name:"Warnings",value:s(X,{count:t==null?void 0:t.numWarnings,colorClass:"text-yellow-300"})}),s(f,{name:"Infos",value:s(X,{count:t==null?void 0:t.numInfos,colorClass:"text-sky-500"})}),s(f,{name:"Hints",value:s(X,{count:t==null?void 0:t.numHints,colorClass:"text-sky-500"})}),s(O,{}),(t==null?void 0:t.truncated)&&v("div",{className:"m-1 font-bold",children:["There are too many issues! Showing only ",t==null?void 0:t.messages.length," entries.",s("span",{onClick:i,className:"pl-2 text-sky-500 font-bold cursor-pointer",children:"See all"})]}),s("div",{className:"w-full font-mono leading-tight text-xs",children:t==null?void 0:t.messages.map((c,h)=>s(On,{code:c.code,message:c.message,severity:c.severity,pointer:c.pointer},h))})]})}))},j=o=>(o/1048576).toFixed(3)+" MB",Wn=o=>{var n,r,i,A,l,c,h,m,g,d,E,u,x,B,C,I,M,b,k,S,H,N,Q,oe,se,re,ie,Ae,ae,le;const{inspector:e}=a.exports.useContext(P),t=e.webglMemoryInfo;return s(L,R(w({},o),{children:v(z,{children:[s(f,{name:"Buffer",value:j((r=(n=t==null?void 0:t.memory)==null?void 0:n.buffer)!=null?r:0)}),s(f,{name:"Texture",value:j((A=(i=t==null?void 0:t.memory)==null?void 0:i.texture)!=null?A:0)}),s(f,{name:"Render Buffer",value:j((c=(l=t==null?void 0:t.memory)==null?void 0:l.renderbuffer)!=null?c:0)}),s(f,{name:"Drawing Buffer",value:j((m=(h=t==null?void 0:t.memory)==null?void 0:h.drawingbuffer)!=null?m:0)}),s(f,{name:"Total",value:j((d=(g=t==null?void 0:t.memory)==null?void 0:g.total)!=null?d:0)}),s(O,{}),s(f,{name:"Buffer",value:(u=(E=t==null?void 0:t.resources)==null?void 0:E.buffer)!=null?u:0}),s(f,{name:"Render Buffer",value:(B=(x=t==null?void 0:t.resources)==null?void 0:x.renderbuffer)!=null?B:0}),s(f,{name:"Program",value:(I=(C=t==null?void 0:t.resources)==null?void 0:C.program)!=null?I:0}),s(f,{name:"Query",value:(b=(M=t==null?void 0:t.resources)==null?void 0:M.query)!=null?b:0}),s(f,{name:"Sampler",value:(S=(k=t==null?void 0:t.resources)==null?void 0:k.sampler)!=null?S:0}),s(f,{name:"Shader",value:(N=(H=t==null?void 0:t.resources)==null?void 0:H.shader)!=null?N:0}),s(f,{name:"Sync",value:(oe=(Q=t==null?void 0:t.resources)==null?void 0:Q.sync)!=null?oe:0}),s(f,{name:"Texture",value:(re=(se=t==null?void 0:t.resources)==null?void 0:se.texture)!=null?re:0}),s(f,{name:"Transform Feedback",value:(Ae=(ie=t==null?void 0:t.resources)==null?void 0:ie.transformFeedback)!=null?Ae:0}),s(f,{name:"Vertex Array",value:(le=(ae=t==null?void 0:t.resources)==null?void 0:ae.vertexArray)!=null?le:0})]})}))},Yn=()=>{const[o,e]=a.exports.useState(["jsonTree","materialDebugger","meta","stats","webglMemory","blendShape","lookAt","validationReport","sampleModels","helpers","exportBufferView","mixamoAnimations","postProcessing","jsEditor","about"]),t=a.exports.useCallback((A,l)=>{const c=o.concat();c.splice(o.indexOf(l),1),c.push(l),e(c)},[o]);let n=0;const r=()=>{const A=0,l=n;return n+=20,{left:A,top:l}},i={jsonTree:s(Cn,{paneKey:"jsonTree",title:"JSON Tree",onClick:t,initPosition:r()},"jsonTree"),materialDebugger:s(Rn,{paneKey:"materialDebugger",title:"MToon Material Debugger",onClick:t,initPosition:r()},"materialDebugger"),meta:s(In,{paneKey:"meta",title:"Meta",onClick:t,initPosition:r()},"meta"),stats:s(Gn,{paneKey:"stats",title:"Stats",onClick:t,initPosition:r()},"stats"),webglMemory:s(Wn,{paneKey:"webglMemory",title:"WebGL Memory",onClick:t,initPosition:r()},"webglMemory"),blendShape:s(un,{paneKey:"blendShape",title:"Blend Shape Proxy",onClick:t,initPosition:r()},"blendShape"),lookAt:s(wn,{paneKey:"lookAt",title:"Look At",onClick:t,initPosition:r()},"lookAt"),validationReport:s(jn,{paneKey:"validationReport",title:"Validation Report",onClick:t,initPosition:r()},"validationReport"),sampleModels:s(Vn,{paneKey:"sampleModels",title:"Sample Models",onClick:t,initPosition:r()},"sampleModels"),helpers:s(gn,{paneKey:"helpers",title:"Helpers",onClick:t,initPosition:r()},"helpers"),exportBufferView:s(pn,{paneKey:"exportBufferView",title:"Export Buffer View",onClick:t,initPosition:r()},"exportBufferView"),mixamoAnimations:s(Sn,{paneKey:"mixamoAnimations",title:"Mixamo Animations",onClick:t,initPosition:r()},"mixamoAnimations"),postProcessing:s(Hn,{paneKey:"postProcessing",title:"Post Processing",onClick:t,initPosition:r()},"postProcessing"),jsEditor:s(bn,{paneKey:"jsEditor",title:"JavaScript Editor",onClick:t,initPosition:r()},"jsEditor"),about:s(hn,{paneKey:"about",title:"About",onClick:t,initPosition:r()},"about")};return s(_,{children:o.map(A=>i[A])})},Zn=()=>{const{inspector:o}=a.exports.useContext(P),[e,t]=a.exports.useState(null);a.exports.useEffect(()=>{const r=()=>{t(null)},i=A=>{t(A)};return o.on("load",r),o.on("progress",i),()=>{o.off("load",r),o.off("progress",i)}});const n=a.exports.useMemo(()=>e?e.loaded/e.total:null,[e]);return s(_,{children:s("div",{className:"w-full h-full absolute text-center pointer-events-none",children:s("div",{children:n?(100*n).toFixed(2):"yay"})})})},Kn=()=>{const{inspector:o}=a.exports.useContext(P),e=a.exports.useCallback(t=>{t&&o.setup(t)},[]);return s(_,{children:v("div",{className:"w-full h-full text-sm absolute overflow-hidden text-gray-100",children:[s("canvas",{ref:e,className:"w-full h-full absolute"}),s(Yn,{}),s(Zn,{})]})})},Jn=()=>s(_,{children:s(Kn,{})});It.render(s(Ce.StrictMode,{children:s(Jn,{})}),document.getElementById("root"));
