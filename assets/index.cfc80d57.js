var Ve=Object.defineProperty,Ge=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var X=(o,e,t)=>e in o?Ve(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,R=(o,e)=>{for(var t in e||(e={}))Oe.call(e,t)&&X(o,t,e[t]);if(ce)for(var t of ce(e))je.call(e,t)&&X(o,t,e[t]);return o},v=(o,e)=>Ge(o,Fe(e));var g=(o,e,t)=>(X(o,typeof e!="symbol"?e+"":e,t),t);import{C as de,M as q,S as We,a as Ye,b as he,F as Ze,A as me,Q as ue,V as pe,c as Ke,d as ge,v as Je,G as j,e as fe,T as Ee,f as Xe,R as qe,g as xe,h as $e,E as et,i as Be,O as tt,U as nt,j as ot,k as st,l as be,P as rt,m as it,D as At,n as at,o as lt,p as ct,q as dt,r as ht,s as mt,t as ut,u as pt,w as W,x as gt,W as ft,y as Et,z as xt,B as Bt,H as bt,I as Ct,J as wt,K as Rt,L as Y,N as Ce,X as vt,Y as s,Z as c,_ as M,$ as y,a0 as z,a1 as Mt,a2 as It}from"./vendor.a043ab8f.js";const yt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const A of i.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&n(A)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};yt();const U={black:"#000000",white:"#ffffff",back1:"#191a1f",fore:"#d0edff",titleBarBg:"#30343b",accent:"#ff0066",gray:"#75848f",uiBackground:"rgba( 25, 26, 31, 0.8 )",error:"#ff0066",warning:"#f7f025",severityInfo:"#53c5ff",constant:"#ff0066",number:"#8a8aff",string:"#f7f025"},Pt=new de(U.constant),kt=new q({color:Pt,transparent:!0,wireframe:!0,depthTest:!1,depthWrite:!1}),Qt=new We(.2);function we(o=Qt){const e=new Ye(o,kt);return e.frustumCulled=!1,e.renderOrder=1e4,e}function Lt(o,e,t){const r=o.parser.json.nodes[e].mesh;if(r==null)return null;const A=o.parser.json.meshes[r].primitives.length,a=[];return t.traverse(l=>{a.length<A&&l.isMesh&&a.push(l)}),a}async function Z(o,e){const t=await o.parser.getDependency("node",e);return Lt(o,e,t)}const zt=new he({transparent:!0,depthTest:!1,depthWrite:!1});function N(o,e=zt){const t=new Map;return o.forEach(n=>{Array.isArray(n.material)&&(t.set(n,n.material[0]),n.material[0]=e)}),()=>{for(const[n,r]of t)n.material[0]=r}}function $(o){const e=new Map;return o.forEach(t=>{const n=we();t.add(n),e.set(t,n)}),()=>{o.forEach(t=>{const n=e.get(t);t.remove(n)})}}class _t extends he{constructor(e){super(e);g(this,"_skinIndexVisualize");g(this,"_uniforms");this._skinIndexVisualize=0,this.onBeforeCompile=t=>{this._uniforms=t.uniforms,this._uniforms.skinIndexVisualize={value:this._skinIndexVisualize},t.vertexShader=t.vertexShader.replace("#include <common>",`#include <common>

        varying float vWeightVisualize;
        uniform float skinIndexVisualize;`),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`#ifdef USE_SKINNING
          vWeightVisualize = (
            skinIndex.x == skinIndexVisualize ? skinWeight.x : 0.0 +
            skinIndex.y == skinIndexVisualize ? skinWeight.y : 0.0 +
            skinIndex.z == skinIndexVisualize ? skinWeight.z : 0.0 +
            skinIndex.w == skinIndexVisualize ? skinWeight.w : 0.0
          );
        #else
          vWeightVisualize = 0.0;
        #endif

        #include <begin_vertex>`),t.fragmentShader=t.fragmentShader.replace("#include <packing>",`#include <packing>

        varying float vWeightVisualize;`),t.fragmentShader=t.fragmentShader.replace("gl_FragColor = vec4( packNormalToRGB( normal ), opacity );",`gl_FragColor = vec4(
          clamp( 2.0 - abs( vec3( 4.0, 2.0, 0.0 ) - 4.0 * vWeightVisualize ), 0.0, 1.0 ),
          opacity
        );`)}}get skinIndexVisualize(){return this._skinIndexVisualize}set skinIndexVisualize(e){this._uniforms&&(this._uniforms.skinIndexVisualize={value:e}),this._skinIndexVisualize=e}}const Re=new _t({transparent:!0,depthTest:!1,depthWrite:!1}),St=new de(U.constant);class Ht{constructor(e){g(this,"_inspector");this._inspector=e}highlight(e){const t=this._inspector,n=e.split("/"),r=t.model.gltf,i=r.parser,A=i.json;if(n.length===3&&n[1]==="nodes"){const a=parseInt(n.pop());let l;return i.getDependency("node",a).then(h=>{l=$([h])}),()=>{l&&l()}}else if(n.length===3&&n[1]==="meshes"){const a=parseInt(n.pop());let l;const h=A.nodes,m=[];return h==null||h.forEach((d,E)=>{d.mesh===a&&m.push(E)}),Promise.all(m.map(d=>Z(r,d))).then(d=>d.flat()).then(d=>{l=N(d)}),()=>{l&&l()}}else if(n.length===5&&n[1]==="meshes"&&n[3]==="primitives"){const a=parseInt(n[2]),l=parseInt(n[4]);let h;return i.getDependency("mesh",a).then(m=>{m.children.length!==0&&(m=m.children[l]),h=N([m])}),()=>{h&&h()}}else if(n.length===7&&n[1]==="meshes"&&n[3]==="primitives"&&n[5]==="targets"){const a=parseInt(n[2]),l=parseInt(n[4]),h=parseInt(n[6]);let m;return i.getDependency("mesh",a).then(u=>{u.children.length!==0&&(u=u.children[l]);const d=u;d.morphTargetInfluences&&(d.morphTargetInfluences[h]=1),m=()=>{d.morphTargetInfluences&&(d.morphTargetInfluences[h]=0)}}),()=>{m&&m()}}else if(n.length===6&&n[1]==="meshes"&&n[3]==="extras"&&n[4]==="targetNames"){const a=parseInt(n[2]),l=parseInt(n[5]);let h;const m=A.nodes,u=[];return m==null||m.forEach((E,f)=>{E.mesh===a&&u.push(f)}),Promise.all(u.map(E=>Z(r,E))).then(E=>E.flat()).then(E=>{E.forEach(f=>{f.morphTargetInfluences&&(f.morphTargetInfluences[l]=1)}),h=()=>{E.forEach(f=>{f.morphTargetInfluences&&(f.morphTargetInfluences[l]=0)})}}),()=>{h&&h()}}else if(n.length===3&&n[1]==="skins"){const a=parseInt(n[2]);let l;const h=A.nodes,m=[];return h==null||h.forEach((d,E)=>{d.skin===a&&m.push(E)}),Promise.all(m.map(d=>Z(r,d))).then(d=>d.flat()).then(d=>{l=N(d)}),()=>{l&&l()}}else if(n.length===5&&n[1]==="skins"&&n[3]==="joints"){const a=parseInt(n[2]),l=parseInt(n[4]),h=[],m=A.skins[a].joints[l];i.getDependency("node",m).then(f=>{h.push($([f]))});const u=A.nodes,d=[];return u==null||u.forEach((f,B)=>{f.skin===a&&d.push(B)}),Promise.all(d.map(f=>Z(r,f))).then(f=>f.flat()).then(f=>{h.push(N(f,Re)),Re.skinIndexVisualize=l}),()=>{h.forEach(f=>f())}}else if(n.length===3&&n[1]==="materials"||n.length===5&&n[2]==="VRM"&&n[3]==="materialProperties"){const a=parseInt(n.pop());let l;return i.getDependencies("mesh").then(h=>{const m=[];A.meshes.forEach((u,d)=>{u.primitives.forEach((f,B)=>{if(a===f.material){let x=h[d];x.children.length!==0&&(x=x.children[B]);const w=x;m.push(w)}})}),l=N(m)}),()=>{l&&l()}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="humanoid"&&n[4]==="humanBones"){const a={leftThumbProximal:"leftThumbMetacarpal",leftThumbIntermediate:"leftThumbProximal",rightThumbProximal:"rightThumbMetacarpal",rightThumbIntermediate:"rightThumbProximal"},l=parseInt(e.split("/").pop()),m=A.extensions.VRM.humanoid.humanBones[l].bone,d=t.model.vrm.humanoid.getNormalizedBoneNode(a[m]);return $([d])}else if(n.length===4&&n[2]==="VRM"&&n[3]==="firstPerson"){const a=we();return t.model.vrm.lookAt.getLookAtWorldPosition(a.position),t.scene.add(a),()=>{t.scene.remove(a)}}else{if(n.length===5&&n[2]==="VRM"&&n[3]==="firstPerson"&&n[4]==="meshAnnotations")return t.layerMode="firstPerson",()=>{t.layerMode="thirdPerson"};if(n.length===6&&n[2]==="VRM"&&n[3]==="blendShapeMaster"&&n[4]==="blendShapeGroups"){const a=parseInt(e.split("/").pop()),m=A.extensions.VRM.blendShapeMaster.blendShapeGroups[a].name,u=t.model.vrm.expressionManager.getValue(m);return t.model.vrm.expressionManager.setValue(m,1),()=>{t.model.vrm.expressionManager.setValue(m,u)}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="secondaryAnimation"&&n[4]==="boneGroups"){const a=parseInt(e.split("/").pop()),h=A.extensions.VRM.secondaryAnimation,m=h==null?void 0:h.boneGroups[a].bones,u=t.model.vrm.springBoneManager,d=new Map;for(const w of u.joints)d.set(w.bone,w);const E=t.helpersPlugin.springBoneJointHelperRoot,f=new Map;E.children.forEach(w=>{const I=w;f.set(I.springBone,I)});const B=[],x=new Set;return m.forEach(w=>{i.getDependency("node",w).then(I=>{I.traverse(b=>{const C=d.get(b),k=f.get(C);x.add(k);const T=k.children[0].material,O=T.color.clone();T.color.copy(St),B.push(()=>{T.color.copy(O)})})})}),()=>{B.forEach(w=>w())}}}}}class Tt{constructor(){g(this,"_eventListeners")}on(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n)),n.push(t)}off(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n));const r=n.indexOf(t);r!==-1&&n.splice(r,1)}_emit(...[e,t]){var n;this._eventListeners=this._eventListeners||new Map,(n=this._eventListeners.get(e))==null||n.forEach(r=>r(t))}}const Dt={mixamorigHips:"hips",mixamorigSpine:"spine",mixamorigSpine1:"chest",mixamorigSpine2:"upperChest",mixamorigNeck:"neck",mixamorigHead:"head",mixamorigLeftShoulder:"leftShoulder",mixamorigLeftArm:"leftUpperArm",mixamorigLeftForeArm:"leftLowerArm",mixamorigLeftHand:"leftHand",mixamorigLeftHandThumb1:"leftThumbMetacarpal",mixamorigLeftHandThumb2:"leftThumbProximal",mixamorigLeftHandThumb3:"leftThumbDistal",mixamorigLeftHandIndex1:"leftIndexProximal",mixamorigLeftHandIndex2:"leftIndexIntermediate",mixamorigLeftHandIndex3:"leftIndexDistal",mixamorigLeftHandMiddle1:"leftMiddleProximal",mixamorigLeftHandMiddle2:"leftMiddleIntermediate",mixamorigLeftHandMiddle3:"leftMiddleDistal",mixamorigLeftHandRing1:"leftRingProximal",mixamorigLeftHandRing2:"leftRingIntermediate",mixamorigLeftHandRing3:"leftRingDistal",mixamorigLeftHandPinky1:"leftLittleProximal",mixamorigLeftHandPinky2:"leftLittleIntermediate",mixamorigLeftHandPinky3:"leftLittleDistal",mixamorigRightShoulder:"rightShoulder",mixamorigRightArm:"rightUpperArm",mixamorigRightForeArm:"rightLowerArm",mixamorigRightHand:"rightHand",mixamorigRightHandPinky1:"rightLittleProximal",mixamorigRightHandPinky2:"rightLittleIntermediate",mixamorigRightHandPinky3:"rightLittleDistal",mixamorigRightHandRing1:"rightRingProximal",mixamorigRightHandRing2:"rightRingIntermediate",mixamorigRightHandRing3:"rightRingDistal",mixamorigRightHandMiddle1:"rightMiddleProximal",mixamorigRightHandMiddle2:"rightMiddleIntermediate",mixamorigRightHandMiddle3:"rightMiddleDistal",mixamorigRightHandIndex1:"rightIndexProximal",mixamorigRightHandIndex2:"rightIndexIntermediate",mixamorigRightHandIndex3:"rightIndexDistal",mixamorigRightHandThumb1:"rightThumbMetacarpal",mixamorigRightHandThumb2:"rightThumbProximal",mixamorigRightHandThumb3:"rightThumbDistal",mixamorigLeftUpLeg:"leftUpperLeg",mixamorigLeftLeg:"leftLowerLeg",mixamorigLeftFoot:"leftFoot",mixamorigLeftToeBase:"leftToes",mixamorigRightUpLeg:"rightUpperLeg",mixamorigRightLeg:"rightLowerLeg",mixamorigRightFoot:"rightFoot",mixamorigRightToeBase:"rightToes"};async function Ut(o,e){const t=e.humanoid;if(t==null)return null;const r=await new Ze().loadAsync(o),A=r.children[0].position.y,h=t.normalizedRestPose.hips.position[1]/A,m=me.findByName(r.animations,"mixamo.com"),u=[];return m.tracks.forEach(d=>{var x;const E=d.name.split("."),f=E[0],B=Dt[f];if(B!=null){const w=(x=t.getNormalizedBoneNode(B))==null?void 0:x.name;if(w!=null){const I=E[1];if(d instanceof ue){const b=d.values.map((C,k)=>{var _;return((_=e.meta)==null?void 0:_.metaVersion)==="0"&&k%2==0?-C:C});u.push(new ue(`${w}.${I}`,d.times,b))}else if(B==="hips"&&d instanceof pe){const b=d.values.map((C,k)=>{var _;return(((_=e.meta)==null?void 0:_.metaVersion)==="0"&&k%3!=1?-C:C)*h});u.push(new pe(`${w}.${I}`,d.times,b))}}}}),new me("vrmAnimation",m.duration,u)}class Nt{constructor(e){g(this,"inspector");g(this,"_currentAnimationMixer");g(this,"_currentAnimationAction");g(this,"_currentAnimationURL");this.inspector=e}handleAfterLoad(e){const t=e.vrm;if(t==null)return;const n=t.humanoid.getNormalizedBoneNode("hips").parent;this._currentAnimationMixer=new Ke(n),this._currentAnimationURL!=null&&this.loadMixamoAnimation(this._currentAnimationURL)}handleAfterUnload(){this._currentAnimationAction=null,this._currentAnimationMixer=null}handleBeforeRender(e){this._currentAnimationMixer!=null&&this._currentAnimationMixer.update(e)}loadMixamoAnimation(e){var r;const t=(r=this.inspector.model)==null?void 0:r.vrm;if(!t)return;const n=this._currentAnimationMixer;!n||(this._currentAnimationAction!=null&&this.clearMixamoAnimation(),Ut(e,t).then(i=>{i&&(this._currentAnimationURL=e,this._currentAnimationAction=n.clipAction(i),this._currentAnimationAction.play())}))}clearMixamoAnimation(){var n,r;const e=(n=this.inspector.model)==null?void 0:n.vrm;if(!e)return;const t=this._currentAnimationAction;!t||(this._currentAnimationURL=null,t.stop(),this._currentAnimationAction=null,(r=e.humanoid)==null||r.resetPose())}}class Vt{constructor(e){g(this,"inspector");g(this,"_controls");this.inspector=e}get controls(){return this._controls}handleAfterSetup(){const{camera:e,canvas:t}=this.inspector;this._controls=new ge(e,t),this._controls.setTarget(0,1,0)}handleBeforeRender(e){this._controls&&this._controls.update(e)}}class ee{constructor(e){g(this,"inspector");g(this,"__validationReport");this.inspector=e,this.__validationReport=null}static get VALIDATOR_MAX_ISSUES(){return 100}get validationReport(){return this.__validationReport}async validate(e=ee.VALIDATOR_MAX_ISSUES){var r;const t=(r=this.inspector.model)==null?void 0:r.buffer;if(!t)return null;const n=await Je(new Uint8Array(t),{maxIssues:e}).catch(i=>console.error("Validation failed: ",i));return this.__validationReport=n,n}handleAfterLoad(){this.validate()}handleAfterUnload(){this.__validationReport=null}}class Gt{constructor(e){g(this,"inspector");g(this,"humanoidHelperRoot");g(this,"lookAtHelperRoot");g(this,"springBoneJointHelperRoot");g(this,"springBoneColliderHelperRoot");this.inspector=e,this.humanoidHelperRoot=new j,this.humanoidHelperRoot.renderOrder=1e4,e.scene.add(this.humanoidHelperRoot),this.lookAtHelperRoot=new j,this.lookAtHelperRoot.renderOrder=1e4,e.scene.add(this.lookAtHelperRoot),this.springBoneJointHelperRoot=new j,this.springBoneJointHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneJointHelperRoot),this.springBoneColliderHelperRoot=new j,this.springBoneColliderHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneColliderHelperRoot)}handleAfterUnload(){this.humanoidHelperRoot.children.concat().forEach(e=>{this.humanoidHelperRoot.remove(e),e.dispose()}),this.springBoneJointHelperRoot.children.concat().forEach(e=>{this.springBoneJointHelperRoot.remove(e),e.dispose()}),this.springBoneColliderHelperRoot.children.concat().forEach(e=>{this.springBoneColliderHelperRoot.remove(e),e.dispose()}),this.lookAtHelperRoot.children.concat().forEach(e=>{this.lookAtHelperRoot.remove(e),e.dispose()})}}function ve(o,e){let t=!1,n,r={x:0,y:0};const i=()=>{t||(requestAnimationFrame(i),n&&(o(n,r),n=void 0,r={x:0,y:0}))};i();const A=l=>{n=l,r.x+=l.movementX,r.y+=l.movementY},a=l=>{t||(e&&e(l),t=!0),window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",a),window.removeEventListener("mousedown",a)};window.addEventListener("mousemove",A),window.addEventListener("mouseup",a),setTimeout(()=>window.addEventListener("mousedown",a))}var Ft="./assets/grab-purple.7ef5ea20.png";const Me=new fe;class Ot{constructor(e){g(this,"inspector");g(this,"_sprites");g(this,"_transformControls");g(this,"_spriteMaterial");g(this,"_raycaster");g(this,"_active");this.inspector=e;const n=new Ee().load(Ft,r=>{r.flipY=!1});this._spriteMaterial=new Xe({sizeAttenuation:!1,transparent:!0,depthTest:!1,map:n}),this._raycaster=new qe,this._active=!0}get active(){return this._active}set active(e){var t,n;this._active=e,(t=this._sprites)==null||t.forEach(r=>r.visible=e),e===!1&&((n=this._transformControls)==null||n.detach())}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new xe(t,n),this._transformControls.space="local",this._transformControls.mode="rotate",e.add(this._transformControls),this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)}),n!=null&&(n==null||n.addEventListener("mousedown",r=>this.handleMouseDown(r)))}handleAfterLoad(e){var n;const t=(n=e.vrm)==null?void 0:n.humanoid;if(t!=null&&t){this._sprites=[];for(const r of Object.values(t.normalizedHumanBones)){const i=r.node,A=new $e(this._spriteMaterial);A.scale.setScalar(.01),A.renderOrder=1e4,A.visible=this._active,i.add(A),this._sprites.push(A)}}}handleAfterUnload(){var e;this._sprites=null,(e=this._transformControls)==null||e.detach()}handleMouseDown(e){const{camera:t,canvas:n}=this.inspector;if(n==null)return;const r=this._sprites;if(r==null)return;const i=this._transformControls;if(i==null)return;const A=n.getBoundingClientRect();Me.set((e.clientX-A.left)/A.width*2-1,-(e.clientY-A.top)/A.height*2+1),this._raycaster.setFromCamera(Me,t);const l=this._raycaster.intersectObjects(r,!1)[0],h=Date.now();ve(()=>0,()=>{if(!(Date.now()-h>300))if(l!=null){const d=l.object.parent;i.attach(d)}else i.detach()})}}const Ie=new Be,jt=new et;class Wt{constructor(e){g(this,"inspector");g(this,"_enableLookAt");g(this,"_lookAtTarget");g(this,"_transformControls");this.inspector=e,this._enableLookAt=!1,this._lookAtTarget=new tt,e.scene.add(this._lookAtTarget)}get enableLookAt(){return this._enableLookAt}set enableLookAt(e){this._enableLookAt=e,this._transformControls&&(this._transformControls.enabled=e,this._transformControls.visible=e),e?this._enableLookAtTarget():this._disableLookAtTarget()}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new xe(t,n),e.add(this._transformControls),this._transformControls.attach(this._lookAtTarget),this._transformControls.enabled=!1,this._transformControls.visible=!1,this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)})}handleAfterLoad(e){var r;const{vrm:t}=e;if(t==null)return;const n=(r=t.humanoid)==null?void 0:r.getNormalizedBoneNode("head");n!=null&&(n.getWorldPosition(Ie),this._lookAtTarget.position.set(0,0,5).add(Ie)),this._enableLookAt&&this._enableLookAtTarget()}_enableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=this._lookAtTarget)}_disableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=void 0,e.applier.lookAt(jt.set(0,0,0)))}}class Yt{constructor(e){g(this,"inspector");g(this,"bloomPass");g(this,"toneMappingPass");this.inspector=e,this.bloomPass=new nt(new fe(4,4),1,.5,1),this.bloomPass.enabled=!1,this.toneMappingPass=new ot(st),this.toneMappingPass.enabled=!1}handleAfterSetup(){const e=this.inspector.composer;e.addPass(this.bloomPass),e.addPass(this.toneMappingPass)}}function Zt(o,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(o.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}function Kt(o,e){const t=new Set,n=o.material;if(Array.isArray(n))n.forEach(i=>{t.add(i)});else{const r=n;t.add(r)}for(const r of t)e(r)}var Jt="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQQBBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAH7v5JqzrodJxSqKZUVyCEgj6EZBH0IyCMgjIPPQ8kEZB5IOwqeJbISlsqmFVgVTCEpSE5SuctkJxZCZZCZZCZZGZZCwITDrvqOe5Si6Wznvls57osouLKLiyi4souLKbiym4spuKpvCm4Sq4squLNHQma5ujrlLm6OuUubo65y5mlpnLmaWmcuZpaZy5mlpnLmaWmcubpaZy5ujpnLnaPecudo6Zy5+hpnLwaGmcvB36Zy5bzvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/8QAIBABAQEBAAIABwAAAAAAAAAAABIREwECAwQQFDBQcP/aAAgBAQABBQL39vWPm/Hivb833ftnxPenn9DjGMZ9MYxjGMYxjGMYxjGMYxjEpSlKUpSlKUpSlCEIQhCEIQhCEIcnJxcXFxcXFxcXFxcXJycv4D//xAAbEQEBAAIDAQAAAAAAAAAAAAAAEQEwAhJgcP/aAAgBAwEBPwFy39mc775CIiIiIiIiIifAf//EABwRAQEBAAMAAwAAAAAAAAAAAAATEQESMAJQcP/aAAgBAgEBPwF8Pfo4498Z9/rWt8ta1RRRRRRRRRRRRRRR3/Af/8QAGRAAAgMBAAAAAAAAAAAAAAAAATEAITBw/9oACAEBAAY/AjYUO77h/8QAHhABAQEAAQQDAAAAAAAAAAAAABEBIRAgMEFQUWD/2gAIAQEAAT8hpdhXtxr7YbidIndERnCrru4iIiIiIiIrda3ERERERERERuN7QTxgPvn83m/HAAH/AP2fzcuV1dXV1dXf3P8A/9oADAMBAAIAAwAAABD1v+TzxSRCCCBACADDAiKLNsvk00302/8AvbJpdNFF1BBwgxRRMk0QwyyyyCSf/wD407777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDnDndwzOhLnvM6uXRyzMz2M7szOjOzMzMzPhKUpSlKUpzn6nKcvsSIiIiIiIiIi//EABwRAQEBAQADAQEAAAAAAAAAABEAUQEQIDBAcP/aAAgBAgEBPxDnOt10ufbvMdz1Ij1I8hHg+Z8j5kfJ/IDMzM8nkzz0A2Gw2Gx2Ox2Ox2Ow2Gw2Gw2O/wAB/8QAIBABAQACAgMBAAMAAAAAAAAAAQARUWGREHGhIDAxYP/aAAgBAQABPxASIw/o5ye7N8cZWFfExJ8GLFixY8hE58WNyNVzmOV8TGP8IAJmTsc+FrWv6/KUq58kYx/ZAhCMY+AxjH85IQhHjPG4Zep4zxnjPGz1el6XrHCOMcY4ytStS9S9S9S9S9S9S9WerLULULULULUPU8D5PE+TwJeiVol6JeiXqXo+Weiy0WerPVno+WWi9Szs9tnZ7bke25HtuR7bke25HtuR7bLt7bLt7bLt7bLt7bLt7bLt7bLt7bLt7f8AY//Z",Xt="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDAgT/2gAMAwEAAhADEAAAAc6XpYoSCEpSEpSMoISCPQ50OdDnQ5IOdDklOSlOSDnQssWKpylc4srmWVzLK5lQmFcwhMITCMwhMIzEjMsjMsjML76Tz3lnm9BZ5ryzz3lnnvK898pRdKUXylF8pTdKU3ylN8pTeFVwVXCe7Rma5ujpnLm6WmcuXp6Zy5enpnLl6eucuXp6Zy5enpnLl6emcuZp98S5ul3nLm6Wmcudo6Zy5+hpnL4NDTOXwe/TOXLed6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITMFBw/9oACAEBAAEFAvRTzRERERERERERERERERERERGWWWWWWWWWWWWWWWWHNzc3Nzc3NzYYYYYYYcnFxcXBwcHBwcHFxcXFycvgP//EABcRAQEBAQAAAAAAAAAAAAAAABEAYHD/2gAIAQMBAT8B2BERERERERERwH//xAAbEQEBAQEAAwEAAAAAAAAAAAAAExEBEjBgcP/aAAgBAgEBPwH6DWt9etaoooooopxTinFOKKKKKPP8B//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEABj8CAH//xAAcEAEBAQADAAMAAAAAAAAAAAARAAEQMEBQYHH/2gAIAQEAAT8hIiOkjgiIiIiIiIiIiI4ERERERERHwYAAf/8A++DwAt8wD9YfjoZOzs7Ozs7O/ev/2gAMAwEAAgADAAAAEBAOuj73333736qgkCm3XVdBNNNBNNRXX8QYcQQqmqqmqqoAEemjrrgkssqz7z0w07777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABsRAQEBAAIDAAAAAAAAAAAAABEAIEBREDBg/9oACAEDAQE/EJ4b6HTlmds+WdM4cM7Z2zPKU5SlKc5zn1PqU5S+xIiIiIiIiIiL/8QAHREBAQEAAgMBAQAAAAAAAAAAEQBRMGEBECBAcP/aAAgBAgEBPxD8B8HOcRxERHIfJH5gTM+J8TMzM+g9BsNhsdjsdu67rsuyOw2Gw2Gx3+A//8QAHRABAQADAQEBAQEAAAAAAAAAAQARUWGRIHFgof/aAAgBAQABPxBjGMSxYsWLFixEIERrGsY/ICEIQhGtY1r9flKUpWtaxjH5AQhCEa1rWMfkBCEIR4ni4TxPErU835s9Wer8xzHMcxzHMvUrUmpWpWpWpWpWrLVnqz1D1D1C1C1D1fknklaP8l6JWiVol6JeiVpK0WerLRZ6LLRZavyXR9bo+t0fW6PrdH1uj63R9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9f7H/9k=",qt="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAasKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQABBQIAf//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8BAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/AQB//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQAGPwIAf//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEAAT8hAH//2gAMAwEAAgADAAAAEM8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8QAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/EAB//8QAFhABAQEAAAAAAAAAAAAAAAAAABFw/9oACAEBAAE/ENwiIiIiIiIiIj//2Q==",$t="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAQEBAQEAAAAAAAAAAAAAAQACAwQG/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAAB+6+NdXO8q2eY0ywUAEBCCWEWCAgICBrIaA0WHo5qb5y2OJSEIsICAcggICCoQgaAQNAdCiAhCAgICBYBAQEBAYEJdBGgN1BQEABAsBSEWFBQUCA1g1CBqI1AQEBARRIEFBQUFBQME0SDEagICAiwiilBgIKCgoJCVKBiGDSGYBDKGUsIoQGUGUGUEKCRJCQkFUywZQygIZQEsEszosEsEBCQkJCg/8QAHRAAAQQCAwAAAAAAAAAAAAAAAgADERIBMAQUcP/aAAgBAQABBQIzCnLixbu2UOOWWd1lPr//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQMBAT8BJb2G+3//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQIBAT8BIb0Eu3//xAAZEAACAwEAAAAAAAAAAAAAAAABMQAhMHD/2gAIAQEABj8CNhQ7vuH/xAAgEAEAAgEDBQEAAAAAAAAAAAABABEQIDBgITFAQVBR/9oACAEBAAE/Ib+sK9k7F+4Om9Fy8nRWwHHeMrHduXF4c8AfAfof/9oADAMBAAIAAwAAABC0w8HDHUfe8+/9+8colvcc/wDf/LKL/P8A38MRzzz2sAAAEIMm34b7/wBrCRSyyxyQBAP+++sATwwwwxwyCAM888EBixwxxyyhBP8Av/vnhQgIIIgQxnvvrPv/AD9xQYRV9/zz3//EABwRAAEDBQAAAAAAAAAAAAAAAAEQEUAAITBQcP/aAAgBAwEBPxAmyDABVsb0+gEATxxD/8QAGxEAAwADAQEAAAAAAAAAAAAAAAERECAwUGD/2gAIAQIBAT8QSdGcFvdKXEUgLtCfUXK6P0J7H//EAB0QAQEBAQACAwEAAAAAAAAAAAEAERAgMSFBUWH/2gAIAQEAAT8QAAo+E3T+MW/rq9mUsssvGtra9Nhl75Z+zpV23WUsstttttttsMNr9nfu3lLLLbbbbbbbDbMeBZZZZbbbbbYYYZZZZZZZZbbbbbYYYlllllllttttthhhiWWWWWWW223mxERLMyyyz5ERHDMzM93hERE+5mZmeMcIiImZmZ8iIiJmZmZ5llkEEEEcMzMlllllkEEEEEJmSSSyyyyyCCCCCZJJJLLLLLLIIIIIJJJJLLLLLLLIIIIIL//Z",en="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQEEBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAHOl6WKEgjII9CMgjIIyDnQ5IOdDkg5IEglKDSo466n3HyWGuueJPRwrsCuZZXMshMshMshMshNbIzlIylIzCNgRmCUtnUtnUtkbhKLiyi4sovKouCm4Sm4spuLKriyq4squLKriyq9bKrpbKrpSq+Cfvma5+hpnLnaGmcudo6Zy52jpnLnaOucudpaZy5ulpnLnaWmcudpaZy52lpnLnaWmcufo6Zy5+jplLn6OuUvg0NM5cN53oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/EACEQAQEBAQABAgcAAAAAAAAAAAASERMCATADBBAUIEBw/9oACAEBAAEFAvd8Xynp6V4eXjHu+j4fnL7vyz9DGMYxjPpjGMZ+GMYxjGMYxjGMYxKUpSlKUpSlKUpQhCEIQhCEIQhCHJycnFxcXFxcXFxcXFxcnL+A/wD/xAAcEQEBAAICAwAAAAAAAAAAAAARAAFAAhIwYHD/2gAIAQMBAT8B83HQxm7aD6CREREREREREfAf/8QAHREBAQEAAgIDAAAAAAAAAAAAABMRATACEkBQcP/aAAgBAgEBPwHu8/gc8PTvxn2Otb1a1rXuoooooooooooooop+A//EABoQAAICAwAAAAAAAAAAAAAAAAExACEwQHD/2gAIAQEABj8CzCCwtB9h/8QAHxABAQEAAQMFAAAAAAAAAAAAABEBIRAgMEBBUFFg/9oACAEBAAE/IYid0TpGYw519qXIR7oiIiIiIiMzr28KkRERERERGYxmr4AE7QwzETy+z56HwAGfFh//ANn87q6urq6uuXP7H//aAAwDAQACAAMAAAAQAgAQgggQkU88k/b9/vN9NNN5LbziiIwwRRxgwBB1FFNdpJbvTj//AH0gsssssENJDL777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDDM4d+MOO7iDJ0curPYZmZ1Zmd2cszMzM7M+CpynP1OcpSlKUpS+xIiIiIiIiIiL//xAAcEQEBAQEBAQADAAAAAAAAAAARAFEBMCAQQHD/2gAIAQIBAT8Q9e3XS7zrEfJEfPZ7nPmfgjwDyPIj9V+A8meTyZmZ+QOw2Gw2Gw2Ox2Ox2Ox2Gw2Gw3+A/wD/xAAgEAEBAAICAwEAAwAAAAAAAAABABFRYZEQcaEgMDFg/9oACAEBAAE/EHyMWLFix4ECPCypZvjjCUCEP6GMHuf4QAQh4RwkjEcYg48WNzWv6/KUp4pxOWbMY/sEQh5CQcxjH8pKQh4BCEeM8Z4zwvW9L0hajjHGOMcYerhjjHGXqVqVqVqVqy1Z6h6h6h6h6h6h6h6hahavUstFno+WerPVlos9EPR8h6h6IeiFoh6I4EcT5HA+WXb22Xb22Xb22Xb22Xb22Xb22Xb22Xb23I9tyPbcj23I9tyPbcj22dnts7Pb/sf/2Q==",tn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAc7vSxRkEJSkJSkewRkEehzoc6HOhyQckEZKclKckHJBKZFcyyuZZXMsrmVCYVzCEwhMIzCEwjMSMyyMyyM1I2Sk7hKLivPeHnvlPPfKUXSlF8pRfKU3SlN8pTeFN4lN5ZT6Cym8spvLL/fM1z9DTOXO0NM5c7R0zlzdLTOXN0tM5czT08S5mnpnLm6emcubp6Zy5unpnLm6fvOXN09M5c7S0zlztHTOXP0dM5cVzugAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITEFBw/9oACAEBAAEFAvWzzEREREREREREREREREREREZZZZZZZZZZZZZZZZYYYYYYYc3Nzc3Nzc3NhycnFxcXFwcHBwcHBxcXFy+A/wD/xAAXEQEBAQEAAAAAAAAAAAAAAAARAGBw/9oACAEDAQE/AdgREREREREREcB//8QAGxEBAQEBAAMBAAAAAAAAAAAAABMRARIwYHD/2gAIAQIBAT8B+g1rfXrWvNRRRRRTinFOKcUUUUUU/Af/xAAUEAEAAAAAAAAAAAAAAAAAAACA/9oACAEBAAY/AgB//8QAHBABAQEAAwADAAAAAAAAAAAAEQABEDBAUGBx/9oACAEBAAE/ITgjpIiIiIiIiIiIiIiIiIiIiIjgR8cAAH//AIAfPB34GdRTfjxBrs7Ozs7Ozv3H/9oADAMBAAIAAwAAABBAKqp+9999+8/roAR90XXQTTTQTRV11spECCqpqqpqoIHGEHFMNM+8+vLJIK645rq+++++++++++++++888888888888888888888888888888888888888888888888//xAAbEQEBAAIDAQAAAAAAAAAAAAARACAwEEBRYP/aAAgBAwEBPxDc4uh1szi5M5M8s8s5s4OpmeqpTlPyfk5znKUpTl9iREREREREREX/xAAdEQEBAQABBQEAAAAAAAAAAAARAFFhARAgMEBw/9oACAECAQE/EPrPA7nqPSREesjxPoDsZmZmek9JmHcOw2Gw2Gx25Lkua5o7HY7DYbDfwH//xAAdEAEBAAMBAQEBAQAAAAAAAAABABFRYZEgcWCh/9oACAEBAAE/EGJMZixYsWLFiCIQhGMYxj8gIQhSFa1rX6/KUpClYxjH5AQhCFKVjGMfkBCEKUpXmeZ5nmeb82erPV+Y5hajiOLhHEcS9StStS9S9WerPVlqFqFqFqFqFqTULUPV+Sy1ZaLPRZaLPULRC0h6IeiFohaIeiFo/wAjkvyWXb62Xb62Xb62Xb62Xb62Xb62Xb62Xb62Xb63R9bo+t0fW6PrdH1uj63R9f7H/9k=";const nn=new Be;ge.install({THREE:be});class ye{constructor(){g(this,"animationPlugin");g(this,"cameraControlsPlugin");g(this,"gltfValidatorPlugin");g(this,"helpersPlugin");g(this,"humanoidTransformPlugin");g(this,"lookAtPlugin");g(this,"postProcessingPlugin");g(this,"_scene");g(this,"_camera");g(this,"_renderer");g(this,"_composer");g(this,"_model");g(this,"_stats",null);g(this,"_webglMemory",null);g(this,"_webglMemoryInfo",null);g(this,"_dracoLoader");g(this,"_loader");g(this,"_canvas");g(this,"_layerMode","thirdPerson");g(this,"_handleResize");g(this,"_ongoingRequestEnvMap");g(this,"_plugins");this._camera=new rt(30,window.innerWidth/window.innerHeight,.1,20),this._camera.position.set(0,1,5),this._scene=new it;const e=new At(16777215);e.position.set(1,1,1).normalize(),this._scene.add(e);const t=new at(10,10);this._scene.add(t);const n=new lt(5);this._scene.add(n),this.helpersPlugin=new Gt(this),this._dracoLoader=new ct,this._dracoLoader.setDecoderPath("./draco/"),this._loader=new dt,this._loader.setDRACOLoader(this._dracoLoader),this._loader.register(r=>new ht(r,{humanoidPlugin:new mt(r,{helperRoot:this.helpersPlugin.humanoidHelperRoot}),lookAtPlugin:new ut(r,{helperRoot:this.helpersPlugin.lookAtHelperRoot}),springBonePlugin:new pt(r,{jointHelperRoot:this.helpersPlugin.springBoneJointHelperRoot,colliderHelperRoot:this.helpersPlugin.springBoneColliderHelperRoot})})),this.animationPlugin=new Nt(this),this.cameraControlsPlugin=new Vt(this),this.gltfValidatorPlugin=new ee(this),this.humanoidTransformPlugin=new Ot(this),this.lookAtPlugin=new Wt(this),this.postProcessingPlugin=new Yt(this),this._plugins=[this.animationPlugin,this.cameraControlsPlugin,this.gltfValidatorPlugin,this.helpersPlugin,this.humanoidTransformPlugin,this.lookAtPlugin,this.postProcessingPlugin]}get scene(){return this._scene}get camera(){return this._camera}get renderer(){return this._renderer}get composer(){return this._composer}get model(){var e;return(e=this._model)!=null?e:null}get stats(){return this._stats}get webglMemoryInfo(){return this._webglMemoryInfo}get canvas(){return this._canvas}get layerMode(){return this._layerMode}set layerMode(e){this._layerMode=e,this._updateLayerMode()}unloadVRM(){const e=this._model;e&&(this._scene.remove(e.scene),W.deepDispose(e.scene),this._emit("unload")),this._plugins.forEach(t=>{var n;return(n=t.handleAfterUnload)==null?void 0:n.call(t)}),this._model=null}async loadVRM(e){var h,m,u,d,E;const t=await fetch(e).then(f=>f.arrayBuffer());this.unloadVRM();const r=new gt({credentials:"include"}).binaryToJSON(t).json,i=await new Promise((f,B)=>{this._loader.crossOrigin="anonymous",this._loader.load(e,x=>{f(x)},x=>{this._emit("progress",x)},x=>{this._emit("error",x),B(x)})});W.removeUnnecessaryVertices(i.scene),W.removeUnnecessaryJoints(i.scene);const A=(h=i.userData.vrm)!=null?h:null;A==null&&console.warn("Failed to load the model as a VRM. Fallback to treat the model as a mere GLTF"),this._stats=await this._prepareStats(i,A);const a=(m=A==null?void 0:A.scene)!=null?m:i.scene;this._scene.add(a);const l={buffer:t,gltf:i,originalGLTFJSON:r,vrm:A,scene:a};if(this._model=l,this._plugins.forEach(f=>{var B;return(B=f.handleAfterLoad)==null?void 0:B.call(f,l)}),A){const f=A.humanoid.getNormalizedBoneNode("hips").parent;A.scene.add(f),(u=A.firstPerson)==null||u.setup(),this._updateLayerMode(),A.scene.traverse(B=>{"isMesh"in B&&Kt(B,async x=>{"isMeshStandardMaterial"in x&&(x.envMap=await this._requestEnvMap())})}),W.rotateVRM0(A),(d=A.springBoneManager)==null||d.setInitState(),(E=A.nodeConstraintManager)==null||E.setInitState()}return this._emit("load",l),l}async exportBufferView(e){var a;const t=(a=this._model)==null?void 0:a.gltf;if(t==null)return;const n=await t.parser.getDependency("bufferView",e),r=new Blob([n]),i=URL.createObjectURL(r),A=document.createElement("a");A.href=i,A.download=`${e}.bin`,A.click(),URL.revokeObjectURL(i)}setup(e){this._canvas=e;const t=window.innerWidth,n=window.innerHeight,r=window.devicePixelRatio;this._renderer=new ft({canvas:this._canvas}),this._renderer.outputEncoding=Et,this._renderer.setSize(t,n),this._renderer.setPixelRatio(r),this._composer=new xt(this._renderer,new Bt(t,n,{type:bt})),this._composer.setPixelRatio(window.devicePixelRatio);const i=new Ct(this._scene,this._camera);this._composer.addPass(i),this._handleResize&&window.removeEventListener("resize",this._handleResize),this._handleResize=()=>{this._camera.aspect=window.innerWidth/window.innerHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(window.innerWidth,window.innerHeight),this._composer.setSize(window.innerWidth,window.innerHeight)},window.addEventListener("resize",this._handleResize),this._webglMemory=this._renderer.getContext().getExtension("GMAN_webgl_memory"),this._plugins.forEach(A=>{var a;return(a=A.handleAfterSetup)==null?void 0:a.call(A)})}registerDnD(e){const t=r=>{r.preventDefault()},n=r=>{r.preventDefault();const i=r.dataTransfer.files;if(!i)return;const A=i[0];if(!A)return;const a=new Blob([A],{type:"application/octet-stream"}),l=URL.createObjectURL(a);this.loadVRM(l)};return e.addEventListener("dragover",t),e.addEventListener("drop",n),()=>{e.removeEventListener("dragover",t),e.removeEventListener("drop",n)}}update(e){var t;((t=this._model)==null?void 0:t.vrm)&&this._model.vrm.update(e),this._plugins.forEach(n=>{var r;return(r=n.handleBeforeRender)==null?void 0:r.call(n,e)}),this._composer&&this._composer.render(e),this._webglMemory&&(this._webglMemoryInfo=this._webglMemory.getMemoryInfo())}async _prepareStats(e,t){var E,f,B;const n=new wt,r=new Set;let i=0,A=0,a=0;const l=x=>{var b,C;A++;const w=x.geometry;n.expandByObject(x);const I=w.getAttribute("position");r.add(I),a+=((C=(b=w.index)==null?void 0:b.count)!=null?C:I.count)/3};(await e.parser.getDependencies("mesh")).forEach(x=>{i++,x.isMesh?l(x):x.children.forEach(I=>{l(I)})});let m=0;for(const x of r)m+=x.count;const u=await e.parser.getDependencies("material"),d=(B=(f=(E=t==null?void 0:t.springBoneManager)==null?void 0:E.joints)==null?void 0:f.size)!=null?B:0;return{dimension:n.getSize(nn).toArray(),vertices:m,polygons:a,meshes:i,primitives:A,materials:u.length,joints:d}}_requestEnvMap(){const e=[Xt,Jt,$t,qt,tn,en];if(!this._ongoingRequestEnvMap){const t=new Rt;this._ongoingRequestEnvMap=new Promise((n,r)=>{t.load(e,i=>n(i),void 0,i=>r(i))})}return this._ongoingRequestEnvMap}_updateLayerMode(){var t,n;const e=(n=(t=this._model)==null?void 0:t.vrm)==null?void 0:n.firstPerson;!e||(this._layerMode==="firstPerson"?(this._camera.layers.enable(e.firstPersonOnlyLayer),this._camera.layers.disable(e.thirdPersonOnlyLayer)):(this._camera.layers.disable(e.firstPersonOnlyLayer),this._camera.layers.enable(e.thirdPersonOnlyLayer)))}}Zt(ye,[Tt]);var on="./assets/uv-grid.cfc47a74.png",S;(function(o){o[o.None=0]="None",o[o.GLTFFallback=1]="GLTFFallback",o[o.MToonNormal=2]="MToonNormal",o[o.MToonLitShadeRate=3]="MToonLitShadeRate",o[o.MToonUV=4]="MToonUV",o[o.UVGrid=5]="UVGrid"})(S||(S={}));const Pe=new q({visible:!1}),sn=new Promise(o=>{new Ee().load(on,t=>{t.flipY=!1,o(t)})});function ke(){const o=new q({color:16711935});return sn.then(e=>{o.map=e,o.color.set(16777215)}),o}function Qe(o,e){if("isMToonMaterial"in o){const t=o;t.debugMode=e}}function Le(o){return"isMToonMaterial"in o?o.isOutline:!1}class rn{constructor(e){g(this,"_currentMode",0);g(this,"_vrmMaterialsByMesh",new Map);g(this,"_inspector");this._inspector=e,this._inspector.on("load",()=>this._handleLoad()),this._inspector.on("unload",()=>this._handleUnload())}applyMode(e){e===0?this._applyModeMToon(Y.None):e===2?this._applyModeMToon(Y.Normal):e===3?this._applyModeMToon(Y.LitShadeRate):e===4?this._applyModeMToon(Y.UV):e===5&&this._applyModeUVGrid(),this._currentMode=e}_applyModeMToon(e){for(const[t,n]of this._vrmMaterialsByMesh.entries())Array.isArray(n)?n.forEach((r,i)=>{Qe(r,e),t.material[i]=r}):(Qe(n,e),t.material=n)}_applyModeUVGrid(){for(const[e,t]of this._vrmMaterialsByMesh.entries())Array.isArray(t)?t.forEach((n,r)=>{Le(n)?e.material[r]=Pe:e.material[r]=ke()}):Le(t)?e.material=Pe:e.material=ke()}async _handleLoad(){(await this._inspector.model.gltf.parser.getDependencies("mesh")).forEach(t=>{if("isGroup"in t)t.children.forEach(r=>{const i=r;this._addManagedMesh(i)});else{const n=t;this._addManagedMesh(n)}}),this.applyMode(this._currentMode)}_addManagedMesh(e){Array.isArray(e.material)?this._vrmMaterialsByMesh.set(e,e.material.concat()):this._vrmMaterialsByMesh.set(e,e.material)}_handleUnload(){this._vrmMaterialsByMesh.clear()}}var ze="./assets/three-vrm-girl-vrm0.0.e6e179de.vrm";function An(o){console.error(o)}const H=new ye;H.loadVRM(ze).catch(An);H.registerDnD(document.body);const an=new Ht(H),ln=new rn(H);console.info(H);const cn=new vt;function _e(){requestAnimationFrame(_e);const o=cn.getDelta();H.update(o)}_e();const P=Ce.createContext({inspector:H,highlighter:an,materialDebugger:ln}),Se=({href:o,widthClass:e})=>o==null?null:s("a",{href:o,target:"_blank",rel:"noreferrer",className:`font-bold truncate inline-block align-top underline text-sky-500 ${e!=null?e:"w-64"}`,children:o});function dn(){const o=c.exports.useRef(-1/0);return c.exports.useCallback(t=>{const n=performance.now();n-o.current<250?(t(),o.current=-1/0):o.current=n},[o])}const Q=o=>{var h,m,u;const[e,t]=c.exports.useState((h=o.initPosition)!=null?h:{left:0,top:0}),[n,r]=c.exports.useState((m=o.initOpening)!=null?m:!1),i=dn(),A=c.exports.useCallback(d=>{var E;(E=o.onClick)==null||E.call(o,d,o.paneKey)},[o.onClick,o.paneKey]),a=c.exports.useCallback(d=>{d.preventDefault();let E=e.left,f=e.top;ve((B,x)=>{B.preventDefault(),B.stopPropagation(),E+=x.x,f+=x.y,t({left:E,top:f})}),i(()=>{r(!n)})},[n,e]),l=c.exports.useCallback(d=>{var E;d.preventDefault(),d.stopPropagation(),(E=o.onClick)==null||E.call(o,d,o.paneKey),r(!n)},[n,o.onClick,o.paneKey]);return M("div",{style:{left:e.left,top:e.top,minWidth:"15rem",boxShadow:"0 0 10px rgba(0, 0, 0, 1.0)"},className:`absolute shadow ${o.className}`,onMouseDown:A,children:[M("div",{className:"h-5 leading-5 w-full bg-gray-700 cursor-move",onMouseDown:a,children:[s("div",{className:"inline-block w-5 h-5 text-center cursor-pointer hover:text-sky-500",onMouseDown:l,children:n?"-":"+"}),o.title]}),n&&((u=o.children)!=null?u:null)]})},L=({className:o,paddingClass:e,children:t})=>s("div",{className:`bg-gray-900/80 backdrop-blur ${e!=null?e:"p-2"} ${o}`,children:t}),hn=o=>s(Q,v(R({},o),{children:M(L,{children:[s("div",{children:"three-vrm-inspector"}),s("div",{children:"Three.js based VRM inspector"}),M("div",{children:["Source: ",s(Se,{widthClass:"w-min",href:"https://github.com/0b5vr/three-vrm-inspector"})]})]})})),V=({label:o,onChange:e,defaultValue:t,disabled:n})=>{const r=c.exports.useCallback(i=>{const A=parseFloat(i.currentTarget.value);e(A)},[]);return M("div",{className:"flex items-center",children:[s("input",{className:"mr-2",type:"range",min:"0",max:"1",step:"0.001",defaultValue:t!=null?t:0,disabled:n,onChange:r}),n?s("span",{className:"text-gray-500",children:o}):o]})},He=({name:o,isAvailable:e})=>{const{inspector:t}=c.exports.useContext(P),n=c.exports.useCallback(r=>{var i,A,a;(a=(A=(i=t.model)==null?void 0:i.vrm)==null?void 0:A.expressionManager)==null||a.setValue(o,r)},[]);return s(V,{label:o,disabled:!e,onChange:n})},G=()=>s("div",{className:"w-full h-0.5 my-2 bg-gray-500"}),Te=[y.Neutral,y.Happy,y.Angry,y.Sad,y.Relaxed,y.Surprised,y.Blink,y.BlinkLeft,y.BlinkRight,y.Aa,y.Ee,y.Ih,y.Oh,y.Ou,y.LookLeft,y.LookRight,y.LookDown,y.LookUp],mn=new Set(Te),un=o=>{var A,a,l;const{inspector:e}=c.exports.useContext(P),t=(a=(A=e.model)==null?void 0:A.vrm)==null?void 0:a.expressionManager,n=t==null?void 0:t.expressionMap,r=[];n&&Array.from(Object.keys(n)).forEach(h=>{mn.has(h)||r.push(h)});const i=((l=r==null?void 0:r.length)!=null?l:0)>=1;return s(Q,v(R({},o),{children:s(L,{children:t?M(z,{children:[Te.map(h=>s(He,{name:h,isAvailable:(t==null?void 0:t.getExpression(h))!=null},h)),s(G,{}),r==null?void 0:r.map(h=>s(He,{name:h,isAvailable:!0},h)),!i&&s("span",{className:"text-gray-500",children:"(No custom expressions)"})]}):"No blendShapeProxy detected."})}))},pn=o=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useRef(null),n=c.exports.useCallback(r=>{var A;r.preventDefault();const i=(A=t.current)==null?void 0:A.value;if(i!=null&&i!==""){const a=parseInt(i,10);e.exportBufferView(a)}},[e]);return s(Q,v(R({},o),{children:s(L,{children:M("form",{onSubmit:n,children:[s("input",{type:"number",ref:t,defaultValue:0,className:"w-24 px-1 bg-gray-800 border border-gray-500",required:!0}),s("input",{type:"submit",className:"ml-1 px-1 bg-gray-800 border border-gray-500",value:"Export"})]})})}))},D=({callback:o,label:e,checked:t})=>{const n=c.exports.useCallback(({target:r})=>{o(r.checked)},[o]);return M("div",{children:[s("input",{type:"checkbox",checked:t,onChange:n}),e]})},gn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!0),[r,i]=c.exports.useState(!0),[A,a]=c.exports.useState(!0),[l,h]=c.exports.useState(!0),[m,u]=c.exports.useState(!0),d=c.exports.useCallback(()=>{n(!0),i(!0),a(!0),h(!0),u(!0)},[]),E=c.exports.useCallback(()=>{n(!1),i(!1),a(!1),h(!1),u(!1)},[]),f=c.exports.useCallback(b=>{n(b)},[e]),B=c.exports.useCallback(b=>{i(b)},[e]),x=c.exports.useCallback(b=>{a(b)},[e]),w=c.exports.useCallback(b=>{h(b)},[e]),I=c.exports.useCallback(b=>{u(b)},[e]);return c.exports.useEffect(()=>{e.helpersPlugin.humanoidHelperRoot.visible=t},[e,t]),c.exports.useEffect(()=>{e.humanoidTransformPlugin.active=r},[e,r]),c.exports.useEffect(()=>{e.helpersPlugin.lookAtHelperRoot.visible=A},[e,A]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneJointHelperRoot.visible=l},[e,l]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneColliderHelperRoot.visible=m},[e,m]),s(Q,v(R({},o),{children:M(L,{children:[s("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:d,children:"Enable All"}),s("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:E,children:"Disable All"}),s(G,{}),s(D,{callback:f,label:"Humanoid",checked:t}),s(D,{callback:B,label:"Humanoid Transform",checked:r}),s(D,{callback:x,label:"LookAt",checked:A}),s(D,{callback:w,label:"Spring Bones",checked:l}),s(D,{callback:I,label:"Spring Bone Colliders",checked:m})]})}))},fn="modulepreload",De={},En="./",xn=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${En}${n}`,n in De)return;De[n]=!0;const r=n.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const A=document.createElement("link");if(A.rel=r?"stylesheet":fn,r||(A.as="script",A.crossOrigin=""),A.href=n,document.head.appendChild(A),r)return new Promise((a,l)=>{A.addEventListener("load",a),A.addEventListener("error",l)})})).then(()=>e())};const Bn=`// Press Ctrl+S or Ctrl+R to apply
// The api will be changed without notice! Use at your own risk

export default ( { inspector, THREE } ) => {
  let isUnmounted = false;

  const vrm = inspector.model.vrm;

  // update
  const beginTime = Date.now();

  function update() {
    if ( isUnmounted ) { return; }

    const time = 0.001 * ( Date.now() - beginTime );

    const leftUpperArm = vrm.humanoid?.getNormalizedBoneNode( 'leftUpperArm' );
    if ( leftUpperArm != null ) {
      leftUpperArm.rotation.z = Math.sin( time );
    }

    requestAnimationFrame( update );
  }
  requestAnimationFrame( update );

  // uninit
  return () => {
    isUnmounted = true;
  };
}
`,bn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(Bn),[r,i]=c.exports.useState(!1),A=c.exports.useRef();c.exports.useEffect(()=>{window.addEventListener("beforeunload",u=>{if(r){const d="You will lose all of your changes on the editor!";return u.returnValue=d,d}})},[r]);const a=c.exports.useCallback(u=>{var f;(f=A.current)==null||f.call(A);const d=new Blob([u],{type:"text/javascript"}),E=URL.createObjectURL(d);xn(()=>import(E),[]).then(B=>{A.current=B.default({inspector:e,THREE:be}),URL.revokeObjectURL(E)})},[e]),l=c.exports.useCallback(u=>{u.addKeyMap({"Ctrl-S":()=>{a(u.getValue())},"Ctrl-R":()=>{a(u.getValue())}})},[a]),h=c.exports.useCallback((u,d,E)=>{n(E),i(!0)},[]),m=c.exports.useCallback(()=>{},[]);return s(Q,v(R({},o),{children:s(L,{className:"w-120 h-80",paddingClass:"p-0",children:s(Mt,{value:t,options:{mode:"text/javascript",keyMap:"sublime",theme:"monokai-sharp",lineNumbers:!0},editorDidMount:l,onBeforeChange:h,onChange:m,className:"h-full leading-tight"})})}))},K=({children:o,onClick:e,onMouseEnter:t,onMouseLeave:n})=>s("span",{className:"select-none cursor-pointer",onClick:e,onMouseEnter:t,onMouseLeave:n,children:o}),Ue=({children:o})=>s("div",{style:{marginLeft:"1.13em"},children:o}),te=({name:o,value:e,fullPath:t=""})=>{const{highlighter:n}=c.exports.useContext(P),[r,i]=c.exports.useState(!1),[A,a]=c.exports.useState(!1),[l,h]=c.exports.useState([void 0]),m=c.exports.useCallback(C=>{C.stopPropagation(),i(!r)},[i,r]),u=c.exports.useCallback(()=>{a(!0),h([n.highlight(t)])},[a,h,n,t]),d=c.exports.useCallback(()=>{var C;a(!1),(C=l[0])==null||C.call(l)},[a,l]),E=Array.isArray(e),f=e==null,B=typeof e=="number",x=typeof e=="boolean",w=typeof e=="string",I=!E&&!f&&!B&&!x&&!w,b={onClick:m,onMouseEnter:u,onMouseLeave:d,isHovering:A};return M("div",{className:"select-auto",children:[s("span",v(R({className:`cursor-pointer ${A&&"text-sky-500"}`},b),{children:o?`${o}: `:""})),E&&M(z,{children:[s(K,v(R({},b),{children:"["})),r&&s(Ue,{children:e.map((C,k)=>s("div",{children:s(te,{name:k.toString()+((C==null?void 0:C.name)?` (${C.name})`:""),value:C,fullPath:`${t}/${k}`})},k))}),s(K,v(R({},b),{children:` ${r?"":e.length} ]`}))]}),I&&M(z,{children:[s(K,v(R({},b),{children:"{"})),r&&s(Ue,{children:Object.keys(e).map((C,k)=>s("div",{children:s(te,{name:C,value:e[C],fullPath:`${t}/${C}`})},k))}),s(K,v(R({},b),{children:` ${r?"":Object.keys(e).join(", ")} }`}))]}),f&&s(z,{children:s("span",v(R({className:"text-pink-500"},b),{children:e}))}),B&&s(z,{children:s("span",v(R({className:"text-indigo-400"},b),{children:e}))}),x&&s(z,{children:s("span",v(R({className:"text-indigo-400"},b),{children:String(e)}))}),w&&s(z,{children:M("span",v(R({className:"text-yellow-300"},b),{children:['"',e,'"']}))})]})},Cn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(void 0);return c.exports.useEffect(()=>{const r=()=>{var i;n((i=e.model)==null?void 0:i.originalGLTFJSON)};return e.on("load",r),()=>{e.off("load",r)}},[e]),s(Q,v(R({},o),{children:s(L,{className:"w-120 h-80 overflow-scroll whitespace-nowrap resize font-mono text-xs leading-tight",paddingClass:"p-0",children:s(te,{value:t})})}))},wn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!0),r=c.exports.useCallback(i=>{n(i),e.lookAtPlugin.enableLookAt=i},[e]);return s(Q,v(R({},o),{children:s(L,{children:s(D,{callback:r,label:"Enable LookAt",checked:t})})}))},Rn=o=>{const{materialDebugger:e}=c.exports.useContext(P),t=c.exports.useCallback(n=>{const r=parseInt(n.target.value);e.applyMode(r)},[e]);return s(Q,v(R({},o),{children:s(L,{children:M("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:[s("option",{value:S.None,children:"None"}),s("option",{value:S.MToonNormal,children:"MToon Normal"}),s("option",{value:S.MToonLitShadeRate,children:"MToon LitShadeRate"}),s("option",{value:S.MToonUV,children:"MToon UV"}),s("option",{value:S.UVGrid,children:"UV Grid"})]})})}))},p=({name:o,value:e,href:t})=>M("div",{children:[o,":"," ",e!=null&&s("span",{className:"font-bold",children:e}),t&&s(Se,{href:t})]}),vn=({meta:o})=>M(z,{children:[s(p,{name:"Title",value:o.title}),s(p,{name:"Author",value:o.author}),s(p,{name:"Version",value:o.version}),s(p,{name:"Reference",value:o.reference}),s(p,{name:"Contact Information",value:o.contactInformation}),s(p,{name:"Allowed User Name",value:o.allowedUserName}),s(p,{name:"Violent Ussage Name",value:o.violentUssageName}),s(p,{name:"Sexual Ussage Name",value:o.sexualUssageName}),s(p,{name:"Commercial Ussage Name",value:o.commercialUssageName}),s(p,{name:"Other Permission URL",href:o.otherPermissionUrl}),s(p,{name:"License Name",value:o.licenseName}),s(p,{name:"Other License URL",href:o.otherLicenseUrl})]}),Mn=({meta:o})=>{var e;return M(z,{children:[s(p,{name:"Name",value:o.name}),s(p,{name:"Version",value:o.version}),s(p,{name:"Authors",value:o.authors.join(", ")}),s(p,{name:"Copyright Information",value:o.copyrightInformation}),s(p,{name:"Contact Information",value:o.contactInformation}),s(p,{name:"References",value:(e=o.references)==null?void 0:e.join(", ")}),s(p,{name:"Third Party Licenses",value:o.thirdPartyLicenses}),s(p,{name:"License URL",href:o.licenseUrl}),s(p,{name:"Avatar Permission",value:o.avatarPermission}),s(p,{name:"Allow Excessively Violent Usage",value:String(o.allowExcessivelyViolentUsage)}),s(p,{name:"Allow Excessively Sexual Usage",value:String(o.allowExcessivelySexualUsage)}),s(p,{name:"Commercial Usage Name",value:o.commercialUsage}),s(p,{name:"Allow Political or Religious Usage",value:String(o.allowPoliticalOrReligiousUsage)}),s(p,{name:"Allow Antisocial or Hate Usage",value:String(o.allowAntisocialOrHateUsage)}),s(p,{name:"Credit Notation",value:o.creditNotation}),s(p,{name:"Allow Redistribution",value:String(o.allowRedistribution)}),s(p,{name:"Modification",value:o.modification}),s(p,{name:"Other License URL",href:o.otherLicenseUrl})]})},In=o=>{var r,i;const{inspector:e}=c.exports.useContext(P),t=(i=(r=e.model)==null?void 0:r.vrm)==null?void 0:i.meta;let n=s(z,{children:"No meta detected."});return(t==null?void 0:t.metaVersion)==="1"?n=s(Mn,{meta:t}):(t==null?void 0:t.metaVersion)==="0"&&(n=s(vn,{meta:t})),s(Q,v(R({},o),{children:s(L,{children:n})}))};var yn="./assets/dancing.2665f039.fbx",Pn="./assets/gangnam-style.119f68a4.fbx",kn="./assets/jump.a8a08f02.fbx",Qn="./assets/running.c854d669.fbx",Ln="./assets/standing-clap.9fc941e1.fbx",zn="./assets/walking.ed38b4d6.fbx";const _n=[{name:"(No Animation)",url:"-"},{name:"Walking",url:zn},{name:"Running",url:Qn},{name:"Jump",url:kn},{name:"Dancing",url:yn},{name:"Standing Clap",url:Ln},{name:"Gangnam Style",url:Pn}],Sn=o=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useCallback(n=>{const r=n.target.value;r==="-"?e.animationPlugin.clearMixamoAnimation():e.animationPlugin.loadMixamoAnimation(r)},[e]);return s(Q,v(R({},o),{children:s(L,{children:s("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:_n.map(({name:n,url:r})=>s("option",{value:r,children:n},r))})})}))},Ne=({label:o,onChange:e,defaultChecked:t,disabled:n})=>{const r=c.exports.useCallback(i=>{const A=i.currentTarget.checked;e(A)},[]);return M("div",{className:"flex items-center",children:[s("input",{className:"mr-2",type:"checkbox",disabled:n,defaultChecked:t,onChange:r}),n?s("span",{className:"text-gray-500",children:o}):o]})},Hn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!1),r=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.enabled=d,n(d)},[e]),i=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.strength=4*d},[e]),A=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.radius=d},[e]),a=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.threshold=4*d},[e]),[l,h]=c.exports.useState(!1),m=c.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.enabled=d,h(d)},[e]),u=c.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.uniforms.exposure.value=2*d},[e]);return s(Q,v(R({},o),{children:M(L,{children:[s("h3",{className:"text-lg font-bold",children:"Bloom"}),s(Ne,{label:"Enabled",defaultChecked:!1,onChange:r}),s(V,{label:"Strength",defaultValue:.25,disabled:!t,onChange:i}),s(V,{label:"Radius",defaultValue:.5,disabled:!t,onChange:A}),s(V,{label:"Threshold",defaultValue:.25,disabled:!t,onChange:a}),s(G,{}),s("h3",{className:"text-lg font-bold",children:"ACES Tone Mapping"}),s(Ne,{label:"Enabled",defaultChecked:!1,onChange:m}),s(V,{label:"Exposure",defaultValue:.5,disabled:!l,onChange:u})]})}))},Tn=({name:o,url:e})=>{const{inspector:t}=c.exports.useContext(P),n=c.exports.useCallback(()=>{t.loadVRM(e)},[t]);return s("button",{value:o,className:"bg-gray-800 border border-gray-500 px-1 py-0 block",onClick:n,children:o})};var Dn="./assets/three-vrm-girl.0525ec01.vrm";const Un=[{name:"three-vrm-girl (VRM0.X)",url:ze},{name:"three-vrm-girl (VRM1.0-beta)",url:Dn}],Nn=o=>s(Q,v(R({},o),{children:s(L,{children:Un.map(({name:e,url:t})=>s(Tn,{name:e,url:t},e))})})),Vn=o=>{var r,i,A,a,l,h,m,u,d,E;const{inspector:e}=c.exports.useContext(P),t=(r=e.stats)==null?void 0:r.dimension.map(f=>f.toFixed(3)),n=`( ${(i=t==null?void 0:t[0])!=null?i:0}, ${(A=t==null?void 0:t[1])!=null?A:0}, ${(a=t==null?void 0:t[2])!=null?a:0} )`;return s(Q,v(R({},o),{children:M(L,{children:[s(p,{name:"Dimension",value:n}),s(p,{name:"Vertices",value:(l=e.stats)==null?void 0:l.vertices}),s(p,{name:"Polygons",value:(h=e.stats)==null?void 0:h.polygons}),s(p,{name:"Meshes",value:(m=e.stats)==null?void 0:m.meshes}),s(p,{name:"Primitives",value:(u=e.stats)==null?void 0:u.primitives}),s(p,{name:"Materials",value:(d=e.stats)==null?void 0:d.materials}),s(p,{name:"Spring Bone Joints",value:(E=e.stats)==null?void 0:E.joints})]})}))},Gn=({children:o})=>s("div",{style:{marginLeft:"1.13em"},children:o}),Fn=o=>{const[e,t]=c.exports.useState(!1),n=o.severity===0?U.error:o.severity===1?U.warning:U.severityInfo,r=c.exports.useCallback(()=>{t(!e)},[e]);return M("div",{className:"group cursor-pointer",onClick:r,children:[s("span",{className:"group-hover:text-sky-500",children:e?"- ":"+ "}),s("span",{style:{color:n},children:o.code}),s("span",{className:"text-gray-500",children:" - "+o.pointer}),e&&s(Gn,{children:o.message})]})},J=({count:o,colorClass:e})=>s("span",{className:o?e:"text-gray-500",children:o}),On=o=>{var A,a;const{inspector:e}=c.exports.useContext(P),t=(A=e.gltfValidatorPlugin.validationReport)==null?void 0:A.issues,[n,r]=c.exports.useReducer(l=>l+1,0),i=c.exports.useCallback(()=>{const l=2*t.messages.length;e.gltfValidatorPlugin.validate(l).then(()=>r())},[t]);return s(Q,v(R({},o),{children:M(L,{className:"w-120 h-80 resize overflow-y-scroll",children:[s(p,{name:"Validator Version",value:(a=e.gltfValidatorPlugin.validationReport)==null?void 0:a.validatorVersion}),s(p,{name:"Errors",value:s(J,{count:t==null?void 0:t.numErrors,colorClass:"text-red-500"})}),s(p,{name:"Warnings",value:s(J,{count:t==null?void 0:t.numWarnings,colorClass:"text-yellow-300"})}),s(p,{name:"Infos",value:s(J,{count:t==null?void 0:t.numInfos,colorClass:"text-sky-500"})}),s(p,{name:"Hints",value:s(J,{count:t==null?void 0:t.numHints,colorClass:"text-sky-500"})}),s(G,{}),(t==null?void 0:t.truncated)&&M("div",{className:"m-1 font-bold",children:["There are too many issues! Showing only ",t==null?void 0:t.messages.length," entries.",s("span",{onClick:i,className:"pl-2 text-sky-500 font-bold cursor-pointer",children:"See all"})]}),s("div",{className:"w-full font-mono leading-tight text-xs",children:t==null?void 0:t.messages.map((l,h)=>s(Fn,{code:l.code,message:l.message,severity:l.severity,pointer:l.pointer},h))})]})}))},F=o=>(o/1048576).toFixed(3)+" MB",jn=o=>{var n,r,i,A,a,l,h,m,u,d,E,f,B,x,w,I,b,C,k,_,T,O,ne,oe,se,re,ie,Ae,ae,le;const{inspector:e}=c.exports.useContext(P),t=e.webglMemoryInfo;return s(Q,v(R({},o),{children:M(L,{children:[s(p,{name:"Buffer",value:F((r=(n=t==null?void 0:t.memory)==null?void 0:n.buffer)!=null?r:0)}),s(p,{name:"Texture",value:F((A=(i=t==null?void 0:t.memory)==null?void 0:i.texture)!=null?A:0)}),s(p,{name:"Render Buffer",value:F((l=(a=t==null?void 0:t.memory)==null?void 0:a.renderbuffer)!=null?l:0)}),s(p,{name:"Drawing Buffer",value:F((m=(h=t==null?void 0:t.memory)==null?void 0:h.drawingbuffer)!=null?m:0)}),s(p,{name:"Total",value:F((d=(u=t==null?void 0:t.memory)==null?void 0:u.total)!=null?d:0)}),s(G,{}),s(p,{name:"Buffer",value:(f=(E=t==null?void 0:t.resources)==null?void 0:E.buffer)!=null?f:0}),s(p,{name:"Render Buffer",value:(x=(B=t==null?void 0:t.resources)==null?void 0:B.renderbuffer)!=null?x:0}),s(p,{name:"Program",value:(I=(w=t==null?void 0:t.resources)==null?void 0:w.program)!=null?I:0}),s(p,{name:"Query",value:(C=(b=t==null?void 0:t.resources)==null?void 0:b.query)!=null?C:0}),s(p,{name:"Sampler",value:(_=(k=t==null?void 0:t.resources)==null?void 0:k.sampler)!=null?_:0}),s(p,{name:"Shader",value:(O=(T=t==null?void 0:t.resources)==null?void 0:T.shader)!=null?O:0}),s(p,{name:"Sync",value:(oe=(ne=t==null?void 0:t.resources)==null?void 0:ne.sync)!=null?oe:0}),s(p,{name:"Texture",value:(re=(se=t==null?void 0:t.resources)==null?void 0:se.texture)!=null?re:0}),s(p,{name:"Transform Feedback",value:(Ae=(ie=t==null?void 0:t.resources)==null?void 0:ie.transformFeedback)!=null?Ae:0}),s(p,{name:"Vertex Array",value:(le=(ae=t==null?void 0:t.resources)==null?void 0:ae.vertexArray)!=null?le:0})]})}))},Wn=()=>{const[o,e]=c.exports.useState(["jsonTree","materialDebugger","meta","stats","webglMemory","blendShape","lookAt","validationReport","sampleModels","helpers","exportBufferView","mixamoAnimations","postProcessing","jsEditor","about"]),t=c.exports.useCallback((A,a)=>{const l=o.concat();l.splice(o.indexOf(a),1),l.push(a),e(l)},[o]);let n=0;const r=()=>{const A=0,a=n;return n+=20,{left:A,top:a}},i={jsonTree:s(Cn,{paneKey:"jsonTree",title:"JSON Tree",onClick:t,initPosition:r()},"jsonTree"),materialDebugger:s(Rn,{paneKey:"materialDebugger",title:"MToon Material Debugger",onClick:t,initPosition:r()},"materialDebugger"),meta:s(In,{paneKey:"meta",title:"Meta",onClick:t,initPosition:r()},"meta"),stats:s(Vn,{paneKey:"stats",title:"Stats",onClick:t,initPosition:r()},"stats"),webglMemory:s(jn,{paneKey:"webglMemory",title:"WebGL Memory",onClick:t,initPosition:r()},"webglMemory"),blendShape:s(un,{paneKey:"blendShape",title:"Blend Shape Proxy",onClick:t,initPosition:r()},"blendShape"),lookAt:s(wn,{paneKey:"lookAt",title:"Look At",onClick:t,initPosition:r()},"lookAt"),validationReport:s(On,{paneKey:"validationReport",title:"Validation Report",onClick:t,initPosition:r()},"validationReport"),sampleModels:s(Nn,{paneKey:"sampleModels",title:"Sample Models",onClick:t,initPosition:r()},"sampleModels"),helpers:s(gn,{paneKey:"helpers",title:"Helpers",onClick:t,initPosition:r()},"helpers"),exportBufferView:s(pn,{paneKey:"exportBufferView",title:"Export Buffer View",onClick:t,initPosition:r()},"exportBufferView"),mixamoAnimations:s(Sn,{paneKey:"mixamoAnimations",title:"Mixamo Animations",onClick:t,initPosition:r()},"mixamoAnimations"),postProcessing:s(Hn,{paneKey:"postProcessing",title:"Post Processing",onClick:t,initPosition:r()},"postProcessing"),jsEditor:s(bn,{paneKey:"jsEditor",title:"JavaScript Editor",onClick:t,initPosition:r()},"jsEditor"),about:s(hn,{paneKey:"about",title:"About",onClick:t,initPosition:r()},"about")};return s(z,{children:o.map(A=>i[A])})},Yn=()=>{const{inspector:o}=c.exports.useContext(P),[e,t]=c.exports.useState(null);c.exports.useEffect(()=>{const r=()=>{t(null)},i=A=>{t(A)};return o.on("load",r),o.on("progress",i),()=>{o.off("load",r),o.off("progress",i)}});const n=c.exports.useMemo(()=>e?e.loaded/e.total:null,[e]);return s(z,{children:s("div",{className:"w-full h-full absolute text-center pointer-events-none",children:s("div",{children:n?(100*n).toFixed(2):"yay"})})})},Zn=()=>{const{inspector:o}=c.exports.useContext(P),e=c.exports.useCallback(t=>{t&&o.setup(t)},[]);return s(z,{children:M("div",{className:"w-full h-full text-sm absolute overflow-hidden text-gray-100",children:[s("canvas",{ref:e,className:"w-full h-full absolute"}),s(Wn,{}),s(Yn,{})]})})},Kn=()=>s(z,{children:s(Zn,{})});It.render(s(Ce.StrictMode,{children:s(Kn,{})}),document.getElementById("root"));
