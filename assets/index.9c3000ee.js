var Ne=Object.defineProperty,Ve=Object.defineProperties;var Ge=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Fe=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var X=(s,e,t)=>e in s?Ne(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,w=(s,e)=>{for(var t in e||(e={}))Fe.call(e,t)&&X(s,t,e[t]);if(ce)for(var t of ce(e))Oe.call(e,t)&&X(s,t,e[t]);return s},v=(s,e)=>Ve(s,Ge(e));var g=(s,e,t)=>(X(s,typeof e!="symbol"?e+"":e,t),t);import{C as de,M as q,S as je,a as We,b as he,F as Ye,A as me,Q as ue,V as pe,c as Ze,d as ge,v as Ke,G as Je,e as Xe,f as W,g as fe,T as Ee,h as qe,R as $e,i as xe,j as et,E as tt,k as Be,O as nt,U as st,l as ot,m as rt,n as it,o as At,p as at,q as be,P as lt,r as ct,D as dt,s as ht,t as mt,u as ut,w as pt,x as gt,y as ft,z as $,B as Et,W as xt,H as Bt,I as bt,J as Ct,K as wt,L as vt,N as Mt,X as Rt,Y,Z as Ce,_ as It,$ as o,a0 as c,a1 as M,a2 as y,a3 as _,a4 as yt,a5 as Pt}from"./vendor.3e5cd72f.js";const kt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const A of i.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&n(A)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};kt();const V={black:"#000000",white:"#ffffff",back1:"#191a1f",fore:"#d0edff",titleBarBg:"#30343b",accent:"#ff0066",gray:"#75848f",uiBackground:"rgba( 25, 26, 31, 0.8 )",error:"#ff0066",warning:"#f7f025",severityInfo:"#53c5ff",constant:"#ff0066",number:"#8a8aff",string:"#f7f025"},Qt=new de(V.constant),Lt=new q({color:Qt,transparent:!0,wireframe:!0,depthTest:!1,depthWrite:!1}),zt=new je(.2);function we(s=zt){const e=new We(s,Lt);return e.frustumCulled=!1,e.renderOrder=1e4,e}function _t(s,e,t){const r=s.parser.json.nodes[e].mesh;if(r==null)return null;const A=s.parser.json.meshes[r].primitives.length,a=[];return t.traverse(l=>{a.length<A&&l.isMesh&&a.push(l)}),a}async function Z(s,e){const t=await s.parser.getDependency("node",e);return _t(s,e,t)}const St=new he({transparent:!0,depthTest:!1,depthWrite:!1});function G(s,e=St){const t=new Map;return s.forEach(n=>{Array.isArray(n.material)&&(t.set(n,n.material[0]),n.material[0]=e)}),()=>{for(const[n,r]of t)n.material[0]=r}}function ee(s){const e=new Map;return s.forEach(t=>{const n=we();t.add(n),e.set(t,n)}),()=>{s.forEach(t=>{const n=e.get(t);t.remove(n)})}}const Ht=new de(V.constant);class Tt{constructor(e){g(this,"_inspector");this._inspector=e}highlight(e){const t=this._inspector,n=e.split("/"),r=t.model.gltf,i=r.parser,A=i.json;if(n.length===3&&n[1]==="nodes"){const a=parseInt(n.pop());let l;return i.getDependency("node",a).then(h=>{l=ee([h])}),()=>{l&&l()}}else if(n.length===3&&n[1]==="meshes"){const a=parseInt(n.pop());let l;const h=A.nodes,m=[];return h==null||h.forEach((d,f)=>{d.mesh===a&&m.push(f)}),Promise.all(m.map(d=>Z(r,d))).then(d=>d.flat()).then(d=>{l=G(d)}),()=>{l&&l()}}else if(n.length===5&&n[1]==="meshes"&&n[3]==="primitives"){const a=parseInt(n[2]),l=parseInt(n[4]);let h;return i.getDependency("mesh",a).then(m=>{m.children.length!==0&&(m=m.children[l]),h=G([m])}),()=>{h&&h()}}else if(n.length===7&&n[1]==="meshes"&&n[3]==="primitives"&&n[5]==="targets"){const a=parseInt(n[2]),l=parseInt(n[4]),h=parseInt(n[6]);let m;return i.getDependency("mesh",a).then(p=>{p.children.length!==0&&(p=p.children[l]);const d=p;d.morphTargetInfluences&&(d.morphTargetInfluences[h]=1),m=()=>{d.morphTargetInfluences&&(d.morphTargetInfluences[h]=0)}}),()=>{m&&m()}}else if(n.length===6&&n[1]==="meshes"&&n[3]==="extras"&&n[4]==="targetNames"){const a=parseInt(n[2]),l=parseInt(n[5]);let h;const m=A.nodes,p=[];return m==null||m.forEach((f,u)=>{f.mesh===a&&p.push(u)}),Promise.all(p.map(f=>Z(r,f))).then(f=>f.flat()).then(f=>{f.forEach(u=>{u.morphTargetInfluences&&(u.morphTargetInfluences[l]=1)}),h=()=>{f.forEach(u=>{u.morphTargetInfluences&&(u.morphTargetInfluences[l]=0)})}}),()=>{h&&h()}}else if(n.length===3&&n[1]==="skins"){const a=parseInt(n[2]);let l;const h=A.nodes,m=[];return h==null||h.forEach((d,f)=>{d.skin===a&&m.push(f)}),Promise.all(m.map(d=>Z(r,d))).then(d=>d.flat()).then(d=>{l=G(d)}),()=>{l&&l()}}else if(n.length===5&&n[1]==="skins"&&n[3]==="joints"){const a=parseInt(n[2]),l=parseInt(n[4]),h=[],m=A.skins[a].joints[l];i.getDependency("node",m).then(u=>{h.push(ee([u]))});const p=A.nodes,d=[];return p==null||p.forEach((u,x)=>{u.skin===a&&d.push(x)}),Promise.all(d.map(u=>Z(r,u))).then(u=>u.flat()).then(u=>{u.forEach(x=>{h.push(t.visualizeWeightPlugin.visualize(x,l))})}),()=>{h.forEach(u=>u())}}else if(n.length===3&&n[1]==="materials"||n.length===5&&n[2]==="VRM"&&n[3]==="materialProperties"){const a=parseInt(n.pop());let l;return i.getDependencies("mesh").then(h=>{const m=[];A.meshes.forEach((p,d)=>{p.primitives.forEach((u,x)=>{if(a===u.material){let B=h[d];B.children.length!==0&&(B=B.children[x]);const C=B;m.push(C)}})}),l=G(m)}),()=>{l&&l()}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="humanoid"&&n[4]==="humanBones"){const a={leftThumbProximal:"leftThumbMetacarpal",leftThumbIntermediate:"leftThumbProximal",rightThumbProximal:"rightThumbMetacarpal",rightThumbIntermediate:"rightThumbProximal"},l=parseInt(e.split("/").pop()),m=A.extensions.VRM.humanoid.humanBones[l].bone,d=t.model.vrm.humanoid.getNormalizedBoneNode(a[m]);return ee([d])}else if(n.length===4&&n[2]==="VRM"&&n[3]==="firstPerson"){const a=we();return t.model.vrm.lookAt.getLookAtWorldPosition(a.position),t.scene.add(a),()=>{t.scene.remove(a)}}else{if(n.length===5&&n[2]==="VRM"&&n[3]==="firstPerson"&&n[4]==="meshAnnotations")return t.layerMode="firstPerson",()=>{t.layerMode="thirdPerson"};if(n.length===6&&n[2]==="VRM"&&n[3]==="blendShapeMaster"&&n[4]==="blendShapeGroups"){const a=parseInt(e.split("/").pop()),m=A.extensions.VRM.blendShapeMaster.blendShapeGroups[a].name,p=t.model.vrm.expressionManager.getValue(m);return t.model.vrm.expressionManager.setValue(m,1),()=>{t.model.vrm.expressionManager.setValue(m,p)}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="secondaryAnimation"&&n[4]==="boneGroups"){const a=parseInt(e.split("/").pop()),h=A.extensions.VRM.secondaryAnimation,m=h==null?void 0:h.boneGroups[a].bones,p=t.model.vrm.springBoneManager,d=new Map;for(const C of p.joints)d.set(C.bone,C);const f=t.helpersPlugin.springBoneJointHelperRoot,u=new Map;f.children.forEach(C=>{const I=C;u.set(I.springBone,I)});const x=[],B=new Set;return m.forEach(C=>{i.getDependency("node",C).then(I=>{I.traverse(R=>{const b=d.get(R),k=u.get(b);B.add(k);const H=k.children[0].material,N=H.color.clone();H.color.copy(Ht),x.push(()=>{H.color.copy(N)})})})}),()=>{x.forEach(C=>C())}}}}}class Dt{constructor(){g(this,"_eventListeners")}on(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n)),n.push(t)}off(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n));const r=n.indexOf(t);r!==-1&&n.splice(r,1)}_emit(...[e,t]){var n;this._eventListeners=this._eventListeners||new Map,(n=this._eventListeners.get(e))==null||n.forEach(r=>r(t))}}const Ut={mixamorigHips:"hips",mixamorigSpine:"spine",mixamorigSpine1:"chest",mixamorigSpine2:"upperChest",mixamorigNeck:"neck",mixamorigHead:"head",mixamorigLeftShoulder:"leftShoulder",mixamorigLeftArm:"leftUpperArm",mixamorigLeftForeArm:"leftLowerArm",mixamorigLeftHand:"leftHand",mixamorigLeftHandThumb1:"leftThumbMetacarpal",mixamorigLeftHandThumb2:"leftThumbProximal",mixamorigLeftHandThumb3:"leftThumbDistal",mixamorigLeftHandIndex1:"leftIndexProximal",mixamorigLeftHandIndex2:"leftIndexIntermediate",mixamorigLeftHandIndex3:"leftIndexDistal",mixamorigLeftHandMiddle1:"leftMiddleProximal",mixamorigLeftHandMiddle2:"leftMiddleIntermediate",mixamorigLeftHandMiddle3:"leftMiddleDistal",mixamorigLeftHandRing1:"leftRingProximal",mixamorigLeftHandRing2:"leftRingIntermediate",mixamorigLeftHandRing3:"leftRingDistal",mixamorigLeftHandPinky1:"leftLittleProximal",mixamorigLeftHandPinky2:"leftLittleIntermediate",mixamorigLeftHandPinky3:"leftLittleDistal",mixamorigRightShoulder:"rightShoulder",mixamorigRightArm:"rightUpperArm",mixamorigRightForeArm:"rightLowerArm",mixamorigRightHand:"rightHand",mixamorigRightHandPinky1:"rightLittleProximal",mixamorigRightHandPinky2:"rightLittleIntermediate",mixamorigRightHandPinky3:"rightLittleDistal",mixamorigRightHandRing1:"rightRingProximal",mixamorigRightHandRing2:"rightRingIntermediate",mixamorigRightHandRing3:"rightRingDistal",mixamorigRightHandMiddle1:"rightMiddleProximal",mixamorigRightHandMiddle2:"rightMiddleIntermediate",mixamorigRightHandMiddle3:"rightMiddleDistal",mixamorigRightHandIndex1:"rightIndexProximal",mixamorigRightHandIndex2:"rightIndexIntermediate",mixamorigRightHandIndex3:"rightIndexDistal",mixamorigRightHandThumb1:"rightThumbMetacarpal",mixamorigRightHandThumb2:"rightThumbProximal",mixamorigRightHandThumb3:"rightThumbDistal",mixamorigLeftUpLeg:"leftUpperLeg",mixamorigLeftLeg:"leftLowerLeg",mixamorigLeftFoot:"leftFoot",mixamorigLeftToeBase:"leftToes",mixamorigRightUpLeg:"rightUpperLeg",mixamorigRightLeg:"rightLowerLeg",mixamorigRightFoot:"rightFoot",mixamorigRightToeBase:"rightToes"};async function Nt(s,e){const t=e.humanoid;if(t==null)return null;const r=await new Ye().loadAsync(s),A=r.children[0].position.y,h=t.normalizedRestPose.hips.position[1]/A,m=me.findByName(r.animations,"mixamo.com"),p=[];return m.tracks.forEach(d=>{var B;const f=d.name.split("."),u=f[0],x=Ut[u];if(x!=null){const C=(B=t.getNormalizedBoneNode(x))==null?void 0:B.name;if(C!=null){const I=f[1];if(d instanceof ue){const R=d.values.map((b,k)=>{var S;return((S=e.meta)==null?void 0:S.metaVersion)==="0"&&k%2==0?-b:b});p.push(new ue(`${C}.${I}`,d.times,R))}else if(x==="hips"&&d instanceof pe){const R=d.values.map((b,k)=>{var S;return(((S=e.meta)==null?void 0:S.metaVersion)==="0"&&k%3!=1?-b:b)*h});p.push(new pe(`${C}.${I}`,d.times,R))}}}}),new me("vrmAnimation",m.duration,p)}class Vt{constructor(e){g(this,"inspector");g(this,"_currentAnimationMixer");g(this,"_currentAnimationAction");g(this,"_currentAnimationURL");this.inspector=e}handleAfterLoad(e){const t=e.vrm;t!=null&&(this._currentAnimationMixer=new Ze(t.humanoid.normalizedHumanBonesRoot),this._currentAnimationURL!=null&&this.loadMixamoAnimation(this._currentAnimationURL))}handleAfterUnload(){this._currentAnimationAction=null,this._currentAnimationMixer=null}handleBeforeRender(e){this._currentAnimationMixer!=null&&this._currentAnimationMixer.update(e)}loadMixamoAnimation(e){var r;const t=(r=this.inspector.model)==null?void 0:r.vrm;if(!t)return;const n=this._currentAnimationMixer;!n||(this._currentAnimationAction!=null&&this.clearMixamoAnimation(),Nt(e,t).then(i=>{i&&(this._currentAnimationURL=e,this._currentAnimationAction=n.clipAction(i),this._currentAnimationAction.play())}))}clearMixamoAnimation(){var n;const e=(n=this.inspector.model)==null?void 0:n.vrm;if(!e)return;const t=this._currentAnimationAction;!t||(this._currentAnimationURL=null,t.stop(),this._currentAnimationAction=null,e.humanoid.resetNormalizedPose())}}class Gt{constructor(e){g(this,"inspector");g(this,"_controls");this.inspector=e}get controls(){return this._controls}handleAfterSetup(){const{camera:e,canvas:t}=this.inspector;this._controls=new ge(e,t),this._controls.setTarget(0,1,0)}handleBeforeRender(e){this._controls&&this._controls.update(e)}}class te{constructor(e){g(this,"inspector");g(this,"__validationReport");this.inspector=e,this.__validationReport=null}static get VALIDATOR_MAX_ISSUES(){return 100}get validationReport(){return this.__validationReport}async validate(e=te.VALIDATOR_MAX_ISSUES){var r;const t=(r=this.inspector.model)==null?void 0:r.buffer;if(!t)return null;const n=await Ke(new Uint8Array(t),{maxIssues:e}).catch(i=>console.error("Validation failed: ",i));return this.__validationReport=n,n}handleAfterLoad(){this.validate()}handleAfterUnload(){this.__validationReport=null}}class Ft{constructor(e){g(this,"inspector");g(this,"gridHelper");g(this,"axesHelper");g(this,"humanoidHelperRoot");g(this,"lookAtHelperRoot");g(this,"springBoneJointHelperRoot");g(this,"springBoneColliderHelperRoot");this.inspector=e,this.gridHelper=new Je(10,10),e.scene.add(this.gridHelper),this.axesHelper=new Xe(5),e.scene.add(this.axesHelper),this.humanoidHelperRoot=new W,this.humanoidHelperRoot.renderOrder=1e4,e.scene.add(this.humanoidHelperRoot),this.lookAtHelperRoot=new W,this.lookAtHelperRoot.renderOrder=1e4,e.scene.add(this.lookAtHelperRoot),this.springBoneJointHelperRoot=new W,this.springBoneJointHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneJointHelperRoot),this.springBoneColliderHelperRoot=new W,this.springBoneColliderHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneColliderHelperRoot)}handleAfterUnload(){this.humanoidHelperRoot.children.concat().forEach(e=>{this.humanoidHelperRoot.remove(e),e.dispose()}),this.springBoneJointHelperRoot.children.concat().forEach(e=>{this.springBoneJointHelperRoot.remove(e),e.dispose()}),this.springBoneColliderHelperRoot.children.concat().forEach(e=>{this.springBoneColliderHelperRoot.remove(e),e.dispose()}),this.lookAtHelperRoot.children.concat().forEach(e=>{this.lookAtHelperRoot.remove(e),e.dispose()})}}function ve(s,e){let t=!1,n,r={x:0,y:0};const i=()=>{t||(requestAnimationFrame(i),n&&(s(n,r),n=void 0,r={x:0,y:0}))};i();const A=l=>{n=l,r.x+=l.movementX,r.y+=l.movementY},a=l=>{t||(e&&e(l),t=!0),window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",a),window.removeEventListener("mousedown",a)};window.addEventListener("mousemove",A),window.addEventListener("mouseup",a),setTimeout(()=>window.addEventListener("mousedown",a))}var Ot="./assets/grab-purple.7ef5ea20.png";const Me=new fe;class jt{constructor(e){g(this,"inspector");g(this,"_sprites");g(this,"_transformControls");g(this,"_spriteMaterial");g(this,"_raycaster");g(this,"_active");this.inspector=e;const n=new Ee().load(Ot,r=>{r.flipY=!1});this._spriteMaterial=new qe({sizeAttenuation:!1,transparent:!0,depthTest:!1,map:n}),this._raycaster=new $e,this._active=!0}get active(){return this._active}set active(e){var t,n;this._active=e,(t=this._sprites)==null||t.forEach(r=>r.visible=e),e===!1&&((n=this._transformControls)==null||n.detach())}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new xe(t,n),this._transformControls.space="local",this._transformControls.mode="rotate",e.add(this._transformControls),this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)}),n!=null&&(n==null||n.addEventListener("mousedown",r=>this.handleMouseDown(r)))}handleAfterLoad(e){var n;const t=(n=e.vrm)==null?void 0:n.humanoid;if(t!=null){this._sprites=[];for(const r of Object.values(t.normalizedHumanBones)){const i=r.node,A=new et(this._spriteMaterial);A.scale.setScalar(.01),A.renderOrder=1e4,A.visible=this._active,i.add(A),this._sprites.push(A)}}}handleAfterUnload(){var e;this._sprites=null,(e=this._transformControls)==null||e.detach()}handleMouseDown(e){const{camera:t,canvas:n}=this.inspector;if(n==null)return;const r=this._sprites;if(r==null)return;const i=this._transformControls;if(i==null)return;const A=n.getBoundingClientRect();Me.set((e.clientX-A.left)/A.width*2-1,-(e.clientY-A.top)/A.height*2+1),this._raycaster.setFromCamera(Me,t);const l=this._raycaster.intersectObjects(r,!1)[0],h=Date.now();ve(()=>0,()=>{if(!(Date.now()-h>300))if(l!=null){const d=l.object.parent;i.attach(d)}else i.detach()})}}const Re=new Be,Wt=new tt;class Yt{constructor(e){g(this,"inspector");g(this,"_enableLookAt");g(this,"_lookAtTarget");g(this,"_transformControls");this.inspector=e,this._enableLookAt=!1,this._lookAtTarget=new nt,e.scene.add(this._lookAtTarget)}get enableLookAt(){return this._enableLookAt}set enableLookAt(e){this._enableLookAt=e,this._transformControls&&(this._transformControls.enabled=e,this._transformControls.visible=e),e?this._enableLookAtTarget():this._disableLookAtTarget()}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new xe(t,n),e.add(this._transformControls),this._transformControls.attach(this._lookAtTarget),this._transformControls.enabled=!1,this._transformControls.visible=!1,this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)})}handleAfterLoad(e){var r;const{vrm:t}=e;if(t==null)return;const n=(r=t.humanoid)==null?void 0:r.getNormalizedBoneNode("head");n!=null&&(n.getWorldPosition(Re),this._lookAtTarget.position.set(0,0,5).add(Re)),this._enableLookAt&&this._enableLookAtTarget()}_enableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=this._lookAtTarget)}_disableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=void 0,e.applier.lookAt(Wt.set(0,0,0)))}}class Zt{constructor(e){g(this,"inspector");g(this,"bloomPass");g(this,"toneMappingPass");this.inspector=e,this.bloomPass=new st(new fe(4,4),1,.5,1),this.bloomPass.enabled=!1,this.toneMappingPass=new ot(rt),this.toneMappingPass.enabled=!1}handleAfterSetup(){const e=this.inspector.composer;e.addPass(this.bloomPass),e.addPass(this.toneMappingPass)}}class Kt extends he{constructor(e){super(e);g(this,"_skinIndexVisualize");g(this,"_uniforms");this._skinIndexVisualize=0,this.onBeforeCompile=t=>{this._uniforms=t.uniforms,this._uniforms.skinIndexVisualize={value:this._skinIndexVisualize},t.vertexShader=t.vertexShader.replace("#include <common>",`#include <common>

        varying float vWeightVisualize;
        uniform float skinIndexVisualize;`),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`#ifdef USE_SKINNING
          vWeightVisualize = (
            skinIndex.x == skinIndexVisualize ? skinWeight.x : 0.0 +
            skinIndex.y == skinIndexVisualize ? skinWeight.y : 0.0 +
            skinIndex.z == skinIndexVisualize ? skinWeight.z : 0.0 +
            skinIndex.w == skinIndexVisualize ? skinWeight.w : 0.0
          );
        #else
          vWeightVisualize = 0.0;
        #endif

        #include <begin_vertex>`),t.fragmentShader=t.fragmentShader.replace("#include <packing>",`#include <packing>

        varying float vWeightVisualize;`),t.fragmentShader=t.fragmentShader.replace("gl_FragColor = vec4( packNormalToRGB( normal ), opacity );",`gl_FragColor = vec4(
          clamp( 2.0 - abs( vec3( 4.0, 2.0, 0.0 ) - 4.0 * vWeightVisualize ), 0.0, 1.0 ),
          opacity
        );`)}}get skinIndexVisualize(){return this._skinIndexVisualize}set skinIndexVisualize(e){this._uniforms&&(this._uniforms.skinIndexVisualize={value:e}),this._skinIndexVisualize=e}}class Jt{constructor(e){g(this,"inspector");g(this,"boneIndexMap");this.inspector=e}visualize(e,t){if(!(e instanceof it))return()=>0;const r=this.boneIndexMap.get(e.skeleton).get(t),i=new Kt({transparent:!0,depthTest:!1,depthWrite:!1});i.skinIndexVisualize=r;const A=G([e],i);return()=>{A(),i.dispose()}}}function Xt(s,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(s.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}function qt(s,e){const t=new Set,n=s.material;if(Array.isArray(n))n.forEach(i=>{t.add(i)});else{const r=n;t.add(r)}for(const r of t)e(r)}function $t(s){const e=new Map,t=new Map;return s.traverse(n=>{if(n.type!=="SkinnedMesh")return;const r=n,A=r.geometry.getAttribute("skinIndex");let a=t.get(A);if(!a){const l=[],h=[],m=new Map,p=A.array;for(let d=0;d<p.length;d++){const f=p[d];let u=m.get(f);u==null&&(u=l.length,m.set(f,u),l.push(r.skeleton.bones[f]),h.push(r.skeleton.boneInverses[f])),p[d]=u}A.copyArray(p),A.needsUpdate=!0,a=new At(l,h),t.set(A,a),e.set(a,m)}r.bind(a,new at)}),e}var en="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQQBBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAH7v5JqzrodJxSqKZUVyCEgj6EZBH0IyCMgjIPPQ8kEZB5IOwqeJbISlsqmFVgVTCEpSE5SuctkJxZCZZCZZCZZGZZCwITDrvqOe5Si6Wznvls57osouLKLiyi4souLKbiym4spuKpvCm4Sq4squLNHQma5ujrlLm6OuUubo65y5mlpnLmaWmcuZpaZy5mlpnLmaWmcubpaZy5ujpnLnaPecudo6Zy5+hpnLwaGmcvB36Zy5bzvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/8QAIBABAQEBAAIABwAAAAAAAAAAABIREwECAwQQFDBQcP/aAAgBAQABBQL39vWPm/Hivb833ftnxPenn9DjGMZ9MYxjGMYxjGMYxjGMYxjEpSlKUpSlKUpSlCEIQhCEIQhCEIcnJxcXFxcXFxcXFxcXJycv4D//xAAbEQEBAAIDAQAAAAAAAAAAAAAAEQEwAhJgcP/aAAgBAwEBPwFy39mc775CIiIiIiIiIifAf//EABwRAQEBAAMAAwAAAAAAAAAAAAATEQESMAJQcP/aAAgBAgEBPwF8Pfo4498Z9/rWt8ta1RRRRRRRRRRRRRRR3/Af/8QAGRAAAgMBAAAAAAAAAAAAAAAAATEAITBw/9oACAEBAAY/AjYUO77h/8QAHhABAQEAAQQDAAAAAAAAAAAAABEBIRAgMEFQUWD/2gAIAQEAAT8hpdhXtxr7YbidIndERnCrru4iIiIiIiIrda3ERERERERERuN7QTxgPvn83m/HAAH/AP2fzcuV1dXV1dXf3P8A/9oADAMBAAIAAwAAABD1v+TzxSRCCCBACADDAiKLNsvk00302/8AvbJpdNFF1BBwgxRRMk0QwyyyyCSf/wD407777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDnDndwzOhLnvM6uXRyzMz2M7szOjOzMzMzPhKUpSlKUpzn6nKcvsSIiIiIiIiIi//EABwRAQEBAQADAQEAAAAAAAAAABEAUQEQIDBAcP/aAAgBAgEBPxDnOt10ufbvMdz1Ij1I8hHg+Z8j5kfJ/IDMzM8nkzz0A2Gw2Gx2Ox2Ox2Ow2Gw2Gw2O/wAB/8QAIBABAQACAgMBAAMAAAAAAAAAAQARUWGREHGhIDAxYP/aAAgBAQABPxASIw/o5ye7N8cZWFfExJ8GLFixY8hE58WNyNVzmOV8TGP8IAJmTsc+FrWv6/KUq58kYx/ZAhCMY+AxjH85IQhHjPG4Zep4zxnjPGz1el6XrHCOMcY4ytStS9S9S9S9S9S9S9WerLULULULULUPU8D5PE+TwJeiVol6JeiXqXo+Weiy0WerPVno+WWi9Szs9tnZ7bke25HtuR7bke25HtuR7bLt7bLt7bLt7bLt7bLt7bLt7bLt7bLt7f8AY//Z",tn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDAgT/2gAMAwEAAhADEAAAAc6XpYoSCEpSEpSMoISCPQ50OdDnQ5IOdDklOSlOSDnQssWKpylc4srmWVzLK5lQmFcwhMITCMwhMIzEjMsjMsjML76Tz3lnm9BZ5ryzz3lnnvK898pRdKUXylF8pTdKU3ylN8pTeFVwVXCe7Rma5ujpnLm6WmcuXp6Zy5enpnLl6eucuXp6Zy5enpnLl6emcuZp98S5ul3nLm6Wmcudo6Zy5+hpnL4NDTOXwe/TOXLed6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITMFBw/9oACAEBAAEFAvRTzRERERERERERERERERERERGWWWWWWWWWWWWWWWWHNzc3Nzc3NzYYYYYYYcnFxcXBwcHBwcHFxcXFycvgP//EABcRAQEBAQAAAAAAAAAAAAAAABEAYHD/2gAIAQMBAT8B2BERERERERERwH//xAAbEQEBAQEAAwEAAAAAAAAAAAAAExEBEjBgcP/aAAgBAgEBPwH6DWt9etaoooooopxTinFOKKKKKPP8B//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEABj8CAH//xAAcEAEBAQADAAMAAAAAAAAAAAARAAEQMEBQYHH/2gAIAQEAAT8hIiOkjgiIiIiIiIiIiI4ERERERERHwYAAf/8A++DwAt8wD9YfjoZOzs7Ozs7O/ev/2gAMAwEAAgADAAAAEBAOuj73333736qgkCm3XVdBNNNBNNRXX8QYcQQqmqqmqqoAEemjrrgkssqz7z0w07777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABsRAQEBAAIDAAAAAAAAAAAAABEAIEBREDBg/9oACAEDAQE/EJ4b6HTlmds+WdM4cM7Z2zPKU5SlKc5zn1PqU5S+xIiIiIiIiIiL/8QAHREBAQEAAgMBAQAAAAAAAAAAEQBRMGEBECBAcP/aAAgBAgEBPxD8B8HOcRxERHIfJH5gTM+J8TMzM+g9BsNhsdjsdu67rsuyOw2Gw2Gx3+A//8QAHRABAQADAQEBAQEAAAAAAAAAAQARUWGRIHFgof/aAAgBAQABPxBjGMSxYsWLFixEIERrGsY/ICEIQhGtY1r9flKUpWtaxjH5AQhCEa1rWMfkBCEIR4ni4TxPErU835s9Wer8xzHMcxzHMvUrUmpWpWpWpWpWrLVnqz1D1D1C1C1D1fknklaP8l6JWiVol6JeiVpK0WerLRZ6LLRZavyXR9bo+t0fW6PrdH1uj63R9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9f7H/9k=",nn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAasKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQABBQIAf//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8BAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/AQB//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQAGPwIAf//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEAAT8hAH//2gAMAwEAAgADAAAAEM8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8QAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/EAB//8QAFhABAQEAAAAAAAAAAAAAAAAAABFw/9oACAEBAAE/ENwiIiIiIiIiIj//2Q==",sn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAQEBAQEAAAAAAAAAAAAAAQACAwQG/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAAB+6+NdXO8q2eY0ywUAEBCCWEWCAgICBrIaA0WHo5qb5y2OJSEIsICAcggICCoQgaAQNAdCiAhCAgICBYBAQEBAYEJdBGgN1BQEABAsBSEWFBQUCA1g1CBqI1AQEBARRIEFBQUFBQME0SDEagICAiwiilBgIKCgoJCVKBiGDSGYBDKGUsIoQGUGUGUEKCRJCQkFUywZQygIZQEsEszosEsEBCQkJCg/8QAHRAAAQQCAwAAAAAAAAAAAAAAAgADERIBMAQUcP/aAAgBAQABBQIzCnLixbu2UOOWWd1lPr//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQMBAT8BJb2G+3//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQIBAT8BIb0Eu3//xAAZEAACAwEAAAAAAAAAAAAAAAABMQAhMHD/2gAIAQEABj8CNhQ7vuH/xAAgEAEAAgEDBQEAAAAAAAAAAAABABEQIDBgITFAQVBR/9oACAEBAAE/Ib+sK9k7F+4Om9Fy8nRWwHHeMrHduXF4c8AfAfof/9oADAMBAAIAAwAAABC0w8HDHUfe8+/9+8colvcc/wDf/LKL/P8A38MRzzz2sAAAEIMm34b7/wBrCRSyyxyQBAP+++sATwwwwxwyCAM888EBixwxxyyhBP8Av/vnhQgIIIgQxnvvrPv/AD9xQYRV9/zz3//EABwRAAEDBQAAAAAAAAAAAAAAAAEQEUAAITBQcP/aAAgBAwEBPxAmyDABVsb0+gEATxxD/8QAGxEAAwADAQEAAAAAAAAAAAAAAAERECAwUGD/2gAIAQIBAT8QSdGcFvdKXEUgLtCfUXK6P0J7H//EAB0QAQEBAQACAwEAAAAAAAAAAAEAERAgMSFBUWH/2gAIAQEAAT8QAAo+E3T+MW/rq9mUsssvGtra9Nhl75Z+zpV23WUsstttttttsMNr9nfu3lLLLbbbbbbbDbMeBZZZZbbbbbYYYZZZZZZZZbbbbbYYYlllllllttttthhhiWWWWWWW223mxERLMyyyz5ERHDMzM93hERE+5mZmeMcIiImZmZ8iIiJmZmZ5llkEEEEcMzMlllllkEEEEEJmSSSyyyyyCCCCCZJJJLLLLLLIIIIIJJJJLLLLLLLIIIIIL//Z",on="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQEEBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAHOl6WKEgjII9CMgjIIyDnQ5IOdDkg5IEglKDSo466n3HyWGuueJPRwrsCuZZXMshMshMshMshNbIzlIylIzCNgRmCUtnUtnUtkbhKLiyi4sovKouCm4Sm4spuLKriyq4squLKriyq9bKrpbKrpSq+Cfvma5+hpnLnaGmcudo6Zy52jpnLnaOucudpaZy5ulpnLnaWmcudpaZy52lpnLnaWmcufo6Zy5+jplLn6OuUvg0NM5cN53oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/EACEQAQEBAQABAgcAAAAAAAAAAAASERMCATADBBAUIEBw/9oACAEBAAEFAvd8Xynp6V4eXjHu+j4fnL7vyz9DGMYxjPpjGMZ+GMYxjGMYxjGMYxKUpSlKUpSlKUpQhCEIQhCEIQhCHJycnFxcXFxcXFxcXFxcnL+A/wD/xAAcEQEBAAICAwAAAAAAAAAAAAARAAFAAhIwYHD/2gAIAQMBAT8B83HQxm7aD6CREREREREREfAf/8QAHREBAQEAAgIDAAAAAAAAAAAAABMRATACEkBQcP/aAAgBAgEBPwHu8/gc8PTvxn2Otb1a1rXuoooooooooooooop+A//EABoQAAICAwAAAAAAAAAAAAAAAAExACEwQHD/2gAIAQEABj8CzCCwtB9h/8QAHxABAQEAAQMFAAAAAAAAAAAAABEBIRAgMEBBUFFg/9oACAEBAAE/IYid0TpGYw519qXIR7oiIiIiIiMzr28KkRERERERGYxmr4AE7QwzETy+z56HwAGfFh//ANn87q6urq6uuXP7H//aAAwDAQACAAMAAAAQAgAQgggQkU88k/b9/vN9NNN5LbziiIwwRRxgwBB1FFNdpJbvTj//AH0gsssssENJDL777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDDM4d+MOO7iDJ0curPYZmZ1Zmd2cszMzM7M+CpynP1OcpSlKUpS+xIiIiIiIiIiL//xAAcEQEBAQEBAQADAAAAAAAAAAARAFEBMCAQQHD/2gAIAQIBAT8Q9e3XS7zrEfJEfPZ7nPmfgjwDyPIj9V+A8meTyZmZ+QOw2Gw2Gw2Ox2Ox2Ox2Gw2Gw3+A/wD/xAAgEAEBAAICAwEAAwAAAAAAAAABABFRYZEQcaEgMDFg/9oACAEBAAE/EHyMWLFix4ECPCypZvjjCUCEP6GMHuf4QAQh4RwkjEcYg48WNzWv6/KUp4pxOWbMY/sEQh5CQcxjH8pKQh4BCEeM8Z4zwvW9L0hajjHGOMcYerhjjHGXqVqVqVqVqy1Z6h6h6h6h6h6h6h6hahavUstFno+WerPVlos9EPR8h6h6IeiFoh6I4EcT5HA+WXb22Xb22Xb22Xb22Xb22Xb22Xb22Xb23I9tyPbcj23I9tyPbcj22dnts7Pb/sf/2Q==",rn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAc7vSxRkEJSkJSkewRkEehzoc6HOhyQckEZKclKckHJBKZFcyyuZZXMsrmVCYVzCEwhMIzCEwjMSMyyMyyM1I2Sk7hKLivPeHnvlPPfKUXSlF8pRfKU3SlN8pTeFN4lN5ZT6Cym8spvLL/fM1z9DTOXO0NM5c7R0zlzdLTOXN0tM5czT08S5mnpnLm6emcubp6Zy5unpnLm6fvOXN09M5c7S0zlztHTOXP0dM5cVzugAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITEFBw/9oACAEBAAEFAvWzzEREREREREREREREREREREZZZZZZZZZZZZZZZZYYYYYYYc3Nzc3Nzc3NhycnFxcXFwcHBwcHBxcXFy+A/wD/xAAXEQEBAQEAAAAAAAAAAAAAAAARAGBw/9oACAEDAQE/AdgREREREREREcB//8QAGxEBAQEBAAMBAAAAAAAAAAAAABMRARIwYHD/2gAIAQIBAT8B+g1rfXrWvNRRRRRTinFOKcUUUUUU/Af/xAAUEAEAAAAAAAAAAAAAAAAAAACA/9oACAEBAAY/AgB//8QAHBABAQEAAwADAAAAAAAAAAAAEQABEDBAUGBx/9oACAEBAAE/ITgjpIiIiIiIiIiIiIiIiIiIiIjgR8cAAH//AIAfPB34GdRTfjxBrs7Ozs7Ozv3H/9oADAMBAAIAAwAAABBAKqp+9999+8/roAR90XXQTTTQTRV11spECCqpqqpqoIHGEHFMNM+8+vLJIK645rq+++++++++++++++888888888888888888888888888888888888888888888888//xAAbEQEBAAIDAQAAAAAAAAAAAAARACAwEEBRYP/aAAgBAwEBPxDc4uh1szi5M5M8s8s5s4OpmeqpTlPyfk5znKUpTl9iREREREREREX/xAAdEQEBAQABBQEAAAAAAAAAAAARAFFhARAgMEBw/9oACAECAQE/EPrPA7nqPSREesjxPoDsZmZmek9JmHcOw2Gw2Gx25Lkua5o7HY7DYbDfwH//xAAdEAEBAAMBAQEBAQAAAAAAAAABABFRYZEgcWCh/9oACAEBAAE/EGJMZixYsWLFiCIQhGMYxj8gIQhSFa1rX6/KUpClYxjH5AQhCFKVjGMfkBCEKUpXmeZ5nmeb82erPV+Y5hajiOLhHEcS9StStS9S9WerPVlqFqFqFqFqFqTULUPV+Sy1ZaLPRZaLPULRC0h6IeiFohaIeiFo/wAjkvyWXb62Xb62Xb62Xb62Xb62Xb62Xb62Xb62Xb63R9bo+t0fW6PrdH1uj63R9f7H/9k=";const An=new Be;ge.install({THREE:be});class Ie{constructor(){g(this,"animationPlugin");g(this,"cameraControlsPlugin");g(this,"gltfValidatorPlugin");g(this,"helpersPlugin");g(this,"humanoidTransformPlugin");g(this,"lookAtPlugin");g(this,"postProcessingPlugin");g(this,"visualizeWeightPlugin");g(this,"_scene");g(this,"_camera");g(this,"_renderer");g(this,"_composer");g(this,"_model");g(this,"_stats",null);g(this,"_webglMemory",null);g(this,"_webglMemoryInfo",null);g(this,"_dracoLoader");g(this,"_loader");g(this,"_canvas");g(this,"_layerMode","thirdPerson");g(this,"_handleResize");g(this,"_ongoingRequestEnvMap");g(this,"_plugins");this._camera=new lt(30,window.innerWidth/window.innerHeight,.1,20),this._camera.position.set(0,1,5),this._scene=new ct;const e=new dt(16777215);e.position.set(1,1,1).normalize(),this._scene.add(e),this.helpersPlugin=new Ft(this),this._dracoLoader=new ht,this._dracoLoader.setDecoderPath("./draco/"),this._loader=new mt,this._loader.setDRACOLoader(this._dracoLoader),this._loader.register(t=>new ut(t,{humanoidPlugin:new pt(t,{helperRoot:this.helpersPlugin.humanoidHelperRoot}),lookAtPlugin:new gt(t,{helperRoot:this.helpersPlugin.lookAtHelperRoot}),springBonePlugin:new ft(t,{jointHelperRoot:this.helpersPlugin.springBoneJointHelperRoot,colliderHelperRoot:this.helpersPlugin.springBoneColliderHelperRoot})})),this.animationPlugin=new Vt(this),this.cameraControlsPlugin=new Gt(this),this.gltfValidatorPlugin=new te(this),this.humanoidTransformPlugin=new jt(this),this.lookAtPlugin=new Yt(this),this.postProcessingPlugin=new Zt(this),this.visualizeWeightPlugin=new Jt(this),this._plugins=[this.animationPlugin,this.cameraControlsPlugin,this.gltfValidatorPlugin,this.helpersPlugin,this.humanoidTransformPlugin,this.lookAtPlugin,this.postProcessingPlugin,this.visualizeWeightPlugin]}get scene(){return this._scene}get camera(){return this._camera}get renderer(){return this._renderer}get composer(){return this._composer}get model(){var e;return(e=this._model)!=null?e:null}get stats(){return this._stats}get webglMemoryInfo(){return this._webglMemoryInfo}get canvas(){return this._canvas}get layerMode(){return this._layerMode}set layerMode(e){this._layerMode=e,this._updateLayerMode()}unloadVRM(){const e=this._model;e&&(this._scene.remove(e.scene),$.deepDispose(e.scene),this._emit("unload")),this._plugins.forEach(t=>{var n;return(n=t.handleAfterUnload)==null?void 0:n.call(t)}),this._model=null}async loadVRM(e){var h,m,p,d,f;const t=await fetch(e).then(u=>u.arrayBuffer());this.unloadVRM();const r=new Et({credentials:"include"}).binaryToJSON(t).json,i=await new Promise((u,x)=>{this._loader.crossOrigin="anonymous",this._loader.load(e,B=>{u(B)},B=>{this._emit("progress",B)},B=>{this._emit("error",B),x(B)})});$.removeUnnecessaryVertices(i.scene),this.visualizeWeightPlugin.boneIndexMap=$t(i.scene);const A=(h=i.userData.vrm)!=null?h:null;A==null&&console.warn("Failed to load the model as a VRM. Fallback to treat the model as a mere GLTF"),this._stats=await this._prepareStats(i,A);const a=(m=A==null?void 0:A.scene)!=null?m:i.scene;this._scene.add(a);const l={buffer:t,gltf:i,originalGLTFJSON:r,vrm:A,scene:a};return this._model=l,this._plugins.forEach(u=>{var x;return(x=u.handleAfterLoad)==null?void 0:x.call(u,l)}),A&&((p=A.firstPerson)==null||p.setup(),this._updateLayerMode(),A.scene.traverse(u=>{"isMesh"in u&&qt(u,async x=>{"isMeshStandardMaterial"in x&&(x.envMap=await this._requestEnvMap())})}),$.rotateVRM0(A),(d=A.springBoneManager)==null||d.setInitState(),(f=A.nodeConstraintManager)==null||f.setInitState()),this._emit("load",l),l}async exportBufferView(e){var a;const t=(a=this._model)==null?void 0:a.gltf;if(t==null)return;const n=await t.parser.getDependency("bufferView",e),r=new Blob([n]),i=URL.createObjectURL(r),A=document.createElement("a");A.href=i,A.download=`${e}.bin`,A.click(),URL.revokeObjectURL(i)}setup(e){this._canvas=e;const t=window.innerWidth,n=window.innerHeight,r=window.devicePixelRatio;this._renderer=new xt({canvas:this._canvas}),this._renderer.outputEncoding=Bt,this._renderer.setSize(t,n),this._renderer.setPixelRatio(r),this._composer=new bt(this._renderer,new Ct(t,n,{type:wt})),this._composer.setPixelRatio(window.devicePixelRatio);const i=new vt(this._scene,this._camera);this._composer.addPass(i),this._handleResize&&window.removeEventListener("resize",this._handleResize),this._handleResize=()=>{this._camera.aspect=window.innerWidth/window.innerHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(window.innerWidth,window.innerHeight),this._composer.setSize(window.innerWidth,window.innerHeight)},window.addEventListener("resize",this._handleResize),this._webglMemory=this._renderer.getContext().getExtension("GMAN_webgl_memory"),this._plugins.forEach(A=>{var a;return(a=A.handleAfterSetup)==null?void 0:a.call(A)})}registerDnD(e){const t=r=>{r.preventDefault()},n=r=>{r.preventDefault();const i=r.dataTransfer.files;if(!i)return;const A=i[0];if(!A)return;const a=new Blob([A],{type:"application/octet-stream"}),l=URL.createObjectURL(a);this.loadVRM(l)};return e.addEventListener("dragover",t),e.addEventListener("drop",n),()=>{e.removeEventListener("dragover",t),e.removeEventListener("drop",n)}}update(e){var t;((t=this._model)==null?void 0:t.vrm)&&this._model.vrm.update(e),this._plugins.forEach(n=>{var r;return(r=n.handleBeforeRender)==null?void 0:r.call(n,e)}),this._composer&&this._composer.render(e),this._webglMemory&&(this._webglMemoryInfo=this._webglMemory.getMemoryInfo())}async _prepareStats(e,t){var f,u,x;const n=new Mt,r=new Set;let i=0,A=0,a=0;const l=B=>{var R,b;A++;const C=B.geometry;n.expandByObject(B);const I=C.getAttribute("position");r.add(I),a+=((b=(R=C.index)==null?void 0:R.count)!=null?b:I.count)/3};(await e.parser.getDependencies("mesh")).forEach(B=>{i++,B.isMesh?l(B):B.children.forEach(I=>{l(I)})});let m=0;for(const B of r)m+=B.count;const p=await e.parser.getDependencies("material"),d=(x=(u=(f=t==null?void 0:t.springBoneManager)==null?void 0:f.joints)==null?void 0:u.size)!=null?x:0;return{dimension:n.getSize(An).toArray(),vertices:m,polygons:a,meshes:i,primitives:A,materials:p.length,joints:d}}_requestEnvMap(){const e=[tn,en,sn,nn,rn,on];if(!this._ongoingRequestEnvMap){const t=new Rt;this._ongoingRequestEnvMap=new Promise((n,r)=>{t.load(e,i=>n(i),void 0,i=>r(i))})}return this._ongoingRequestEnvMap}_updateLayerMode(){var t,n;const e=(n=(t=this._model)==null?void 0:t.vrm)==null?void 0:n.firstPerson;!e||(this._layerMode==="firstPerson"?(this._camera.layers.enable(e.firstPersonOnlyLayer),this._camera.layers.disable(e.thirdPersonOnlyLayer)):(this._camera.layers.disable(e.firstPersonOnlyLayer),this._camera.layers.enable(e.thirdPersonOnlyLayer)))}}Xt(Ie,[Dt]);var an="./assets/uv-grid.cfc47a74.png",D;(function(s){s[s.None=0]="None",s[s.GLTFFallback=1]="GLTFFallback",s[s.MToonNormal=2]="MToonNormal",s[s.MToonLitShadeRate=3]="MToonLitShadeRate",s[s.MToonUV=4]="MToonUV",s[s.UVGrid=5]="UVGrid"})(D||(D={}));const ye=new q({visible:!1}),ln=new Promise(s=>{new Ee().load(an,t=>{t.flipY=!1,s(t)})});function Pe(){const s=new q({color:16711935});return ln.then(e=>{s.map=e,s.color.set(16777215)}),s}function ke(s,e){if("isMToonMaterial"in s){const t=s;t.debugMode=e}}function Qe(s){return"isMToonMaterial"in s?s.isOutline:!1}class cn{constructor(e){g(this,"_currentMode",0);g(this,"_vrmMaterialsByMesh",new Map);g(this,"_inspector");this._inspector=e,this._inspector.on("load",()=>this._handleLoad()),this._inspector.on("unload",()=>this._handleUnload())}applyMode(e){e===0?this._applyModeMToon(Y.None):e===2?this._applyModeMToon(Y.Normal):e===3?this._applyModeMToon(Y.LitShadeRate):e===4?this._applyModeMToon(Y.UV):e===5&&this._applyModeUVGrid(),this._currentMode=e}_applyModeMToon(e){for(const[t,n]of this._vrmMaterialsByMesh.entries())Array.isArray(n)?n.forEach((r,i)=>{ke(r,e),t.material[i]=r}):(ke(n,e),t.material=n)}_applyModeUVGrid(){for(const[e,t]of this._vrmMaterialsByMesh.entries())Array.isArray(t)?t.forEach((n,r)=>{Qe(n)?e.material[r]=ye:e.material[r]=Pe()}):Qe(t)?e.material=ye:e.material=Pe()}async _handleLoad(){(await this._inspector.model.gltf.parser.getDependencies("mesh")).forEach(t=>{if("isGroup"in t)t.children.forEach(r=>{const i=r;this._addManagedMesh(i)});else{const n=t;this._addManagedMesh(n)}}),this.applyMode(this._currentMode)}_addManagedMesh(e){Array.isArray(e.material)?this._vrmMaterialsByMesh.set(e,e.material.concat()):this._vrmMaterialsByMesh.set(e,e.material)}_handleUnload(){this._vrmMaterialsByMesh.clear()}}var Le="./assets/VRM1_Constraint_Twist_Sample.859297e7.vrm";function dn(s){console.error(s)}const U=new Ie;U.loadVRM(Le).catch(dn);U.registerDnD(document.body);const hn=new Tt(U),mn=new cn(U);console.info(U);const un=new It;function ze(){requestAnimationFrame(ze);const s=un.getDelta();U.update(s)}ze();const P=Ce.createContext({inspector:U,highlighter:hn,materialDebugger:mn}),_e=({href:s,widthClass:e})=>s==null?null:o("a",{href:s,target:"_blank",rel:"noreferrer",className:`font-bold truncate inline-block align-top underline text-sky-500 ${e!=null?e:"w-64"}`,children:s});function pn(){const s=c.exports.useRef(-1/0);return c.exports.useCallback(t=>{const n=performance.now();n-s.current<250?(t(),s.current=-1/0):s.current=n},[s])}const L=s=>{var h,m,p;const[e,t]=c.exports.useState((h=s.initPosition)!=null?h:{left:0,top:0}),[n,r]=c.exports.useState((m=s.initOpening)!=null?m:!1),i=pn(),A=c.exports.useCallback(d=>{var f;(f=s.onClick)==null||f.call(s,d,s.paneKey)},[s.onClick,s.paneKey]),a=c.exports.useCallback(d=>{d.preventDefault();let f=e.left,u=e.top;ve((x,B)=>{x.preventDefault(),x.stopPropagation(),f+=B.x,u+=B.y,t({left:f,top:u})}),i(()=>{r(!n)})},[n,e]),l=c.exports.useCallback(d=>{var f;d.preventDefault(),d.stopPropagation(),(f=s.onClick)==null||f.call(s,d,s.paneKey),r(!n)},[n,s.onClick,s.paneKey]);return M("div",{style:{left:e.left,top:e.top,minWidth:"15rem",boxShadow:"0 0 10px rgba(0, 0, 0, 1.0)"},className:`absolute shadow ${s.className}`,onMouseDown:A,children:[M("div",{className:"h-5 leading-5 w-full bg-gray-700 cursor-move",onMouseDown:a,children:[o("div",{className:"inline-block w-5 h-5 text-center cursor-pointer hover:text-sky-500",onMouseDown:l,children:n?"-":"+"}),s.title]}),n&&((p=s.children)!=null?p:null)]})},z=({className:s,paddingClass:e,children:t})=>o("div",{className:`bg-gray-900/80 backdrop-blur ${e!=null?e:"p-2"} ${s}`,children:t}),gn=s=>o(L,v(w({},s),{children:M(z,{children:[o("div",{children:"three-vrm-inspector"}),o("div",{children:"Three.js based VRM inspector"}),M("div",{children:["Source: ",o(_e,{widthClass:"w-min",href:"https://github.com/0b5vr/three-vrm-inspector"})]})]})})),F=({label:s,onChange:e,defaultValue:t,disabled:n})=>{const r=c.exports.useCallback(i=>{const A=parseFloat(i.currentTarget.value);e(A)},[]);return M("div",{className:"flex items-center",children:[o("input",{className:"mr-2",type:"range",min:"0",max:"1",step:"0.001",defaultValue:t!=null?t:0,disabled:n,onChange:r}),n?o("span",{className:"text-gray-500",children:s}):s]})},Se=({name:s,isAvailable:e})=>{const{inspector:t}=c.exports.useContext(P),n=c.exports.useCallback(r=>{var i,A,a;(a=(A=(i=t.model)==null?void 0:i.vrm)==null?void 0:A.expressionManager)==null||a.setValue(s,r)},[]);return o(F,{label:s,disabled:!e,onChange:n})},O=()=>o("div",{className:"w-full h-0.5 my-2 bg-gray-500"}),He=[y.Neutral,y.Happy,y.Angry,y.Sad,y.Relaxed,y.Surprised,y.Blink,y.BlinkLeft,y.BlinkRight,y.Aa,y.Ee,y.Ih,y.Oh,y.Ou,y.LookLeft,y.LookRight,y.LookDown,y.LookUp],fn=new Set(He),En=s=>{var A,a,l;const{inspector:e}=c.exports.useContext(P),t=(a=(A=e.model)==null?void 0:A.vrm)==null?void 0:a.expressionManager,n=t==null?void 0:t.expressionMap,r=[];n&&Array.from(Object.keys(n)).forEach(h=>{fn.has(h)||r.push(h)});const i=((l=r==null?void 0:r.length)!=null?l:0)>=1;return o(L,v(w({},s),{children:o(z,{children:t?M(_,{children:[He.map(h=>o(Se,{name:h,isAvailable:(t==null?void 0:t.getExpression(h))!=null},h)),o(O,{}),r==null?void 0:r.map(h=>o(Se,{name:h,isAvailable:!0},h)),!i&&o("span",{className:"text-gray-500",children:"(No custom expressions)"})]}):"No blendShapeProxy detected."})}))},xn=s=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useRef(null),n=c.exports.useCallback(r=>{var A;r.preventDefault();const i=(A=t.current)==null?void 0:A.value;if(i!=null&&i!==""){const a=parseInt(i,10);e.exportBufferView(a)}},[e]);return o(L,v(w({},s),{children:o(z,{children:M("form",{onSubmit:n,children:[o("input",{type:"number",ref:t,defaultValue:0,className:"w-24 px-1 bg-gray-800 border border-gray-500",required:!0}),o("input",{type:"submit",className:"ml-1 px-1 bg-gray-800 border border-gray-500",value:"Export"})]})})}))},T=({callback:s,label:e,checked:t})=>{const n=c.exports.useCallback(({target:r})=>{s(r.checked)},[s]);return M("div",{children:[o("input",{type:"checkbox",checked:t,onChange:n}),o("label",{className:"ml-1",children:e})]})},Bn=s=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!0),[r,i]=c.exports.useState(!0),[A,a]=c.exports.useState(!0),[l,h]=c.exports.useState(!0),[m,p]=c.exports.useState(!0),[d,f]=c.exports.useState(!0),[u,x]=c.exports.useState(!0),B=c.exports.useCallback(()=>{n(!0),i(!0),a(!0),h(!0),p(!0),f(!0),x(!0)},[]),C=c.exports.useCallback(()=>{n(!1),i(!1),a(!1),h(!1),p(!1),f(!1),x(!1)},[]),I=c.exports.useCallback(Q=>{n(Q)},[e]),R=c.exports.useCallback(Q=>{i(Q)},[e]),b=c.exports.useCallback(Q=>{a(Q)},[e]),k=c.exports.useCallback(Q=>{h(Q)},[e]),S=c.exports.useCallback(Q=>{p(Q)},[e]),H=c.exports.useCallback(Q=>{f(Q)},[e]),N=c.exports.useCallback(Q=>{x(Q)},[e]);return c.exports.useEffect(()=>{e.helpersPlugin.gridHelper.visible=t},[e,t]),c.exports.useEffect(()=>{e.helpersPlugin.axesHelper.visible=r},[e,r]),c.exports.useEffect(()=>{e.helpersPlugin.humanoidHelperRoot.visible=A},[e,A]),c.exports.useEffect(()=>{e.humanoidTransformPlugin.active=l},[e,l]),c.exports.useEffect(()=>{e.helpersPlugin.lookAtHelperRoot.visible=m},[e,m]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneJointHelperRoot.visible=d},[e,d]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneColliderHelperRoot.visible=u},[e,u]),o(L,v(w({},s),{children:M(z,{children:[o("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:B,children:"Enable All"}),o("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:C,children:"Disable All"}),o(O,{}),o(T,{callback:I,label:"Grid",checked:t}),o(T,{callback:R,label:"Axes",checked:r}),o(T,{callback:b,label:"Humanoid",checked:A}),o(T,{callback:k,label:"Humanoid Transform",checked:l}),o(T,{callback:S,label:"LookAt",checked:m}),o(T,{callback:H,label:"Spring Bones",checked:d}),o(T,{callback:N,label:"Spring Bone Colliders",checked:u})]})}))},bn="modulepreload",Te={},Cn="./",wn=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${Cn}${n}`,n in Te)return;Te[n]=!0;const r=n.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const A=document.createElement("link");if(A.rel=r?"stylesheet":bn,r||(A.as="script",A.crossOrigin=""),A.href=n,document.head.appendChild(A),r)return new Promise((a,l)=>{A.addEventListener("load",a),A.addEventListener("error",l)})})).then(()=>e())};const vn=`// Press Ctrl+S or Ctrl+R to apply
// The api will be changed without notice! Use at your own risk

export default ( { inspector, THREE } ) => {
  let isUnmounted = false;

  const vrm = inspector.model.vrm;

  // update
  const beginTime = Date.now();

  function update() {
    if ( isUnmounted ) { return; }

    const time = 0.001 * ( Date.now() - beginTime );

    const leftUpperArm = vrm.humanoid?.getNormalizedBoneNode( 'leftUpperArm' );
    if ( leftUpperArm != null ) {
      leftUpperArm.rotation.z = Math.sin( time );
    }

    requestAnimationFrame( update );
  }
  requestAnimationFrame( update );

  // uninit
  return () => {
    isUnmounted = true;
  };
}
`,Mn=s=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(vn),[r,i]=c.exports.useState(!1),A=c.exports.useRef();c.exports.useEffect(()=>{window.addEventListener("beforeunload",p=>{if(r){const d="You will lose all of your changes on the editor!";return p.returnValue=d,d}})},[r]);const a=c.exports.useCallback(p=>{var u;(u=A.current)==null||u.call(A);const d=new Blob([p],{type:"text/javascript"}),f=URL.createObjectURL(d);wn(()=>import(f),[]).then(x=>{A.current=x.default({inspector:e,THREE:be}),URL.revokeObjectURL(f)})},[e]),l=c.exports.useCallback(p=>{p.addKeyMap({"Ctrl-S":()=>{a(p.getValue())},"Ctrl-R":()=>{a(p.getValue())}})},[a]),h=c.exports.useCallback((p,d,f)=>{n(f),i(!0)},[]),m=c.exports.useCallback(()=>{},[]);return o(L,v(w({},s),{children:o(z,{className:"w-120 h-80",paddingClass:"p-0",children:o(yt,{value:t,options:{mode:"text/javascript",keyMap:"sublime",theme:"monokai-sharp",lineNumbers:!0},editorDidMount:l,onBeforeChange:h,onChange:m,className:"h-full leading-tight"})})}))},K=({children:s,onClick:e,onMouseEnter:t,onMouseLeave:n})=>o("span",{className:"select-none cursor-pointer",onClick:e,onMouseEnter:t,onMouseLeave:n,children:s}),De=({children:s})=>o("div",{style:{marginLeft:"1.13em"},children:s}),ne=({name:s,value:e,fullPath:t=""})=>{const{highlighter:n}=c.exports.useContext(P),[r,i]=c.exports.useState(!1),[A,a]=c.exports.useState(!1),[l,h]=c.exports.useState([void 0]),m=c.exports.useCallback(b=>{b.stopPropagation(),i(!r)},[i,r]),p=c.exports.useCallback(()=>{a(!0),h([n.highlight(t)])},[a,h,n,t]),d=c.exports.useCallback(()=>{var b;a(!1),(b=l[0])==null||b.call(l)},[a,l]),f=Array.isArray(e),u=e==null,x=typeof e=="number",B=typeof e=="boolean",C=typeof e=="string",I=!f&&!u&&!x&&!B&&!C,R={onClick:m,onMouseEnter:p,onMouseLeave:d,isHovering:A};return M("div",{className:"select-auto",children:[o("span",v(w({className:`cursor-pointer ${A&&"text-sky-500"}`},R),{children:s?`${s}: `:""})),f&&M(_,{children:[o(K,v(w({},R),{children:"["})),r&&o(De,{children:e.map((b,k)=>o("div",{children:o(ne,{name:k.toString()+((b==null?void 0:b.name)?` (${b.name})`:""),value:b,fullPath:`${t}/${k}`})},k))}),o(K,v(w({},R),{children:` ${r?"":e.length} ]`}))]}),I&&M(_,{children:[o(K,v(w({},R),{children:"{"})),r&&o(De,{children:Object.keys(e).map((b,k)=>o("div",{children:o(ne,{name:b,value:e[b],fullPath:`${t}/${b}`})},k))}),o(K,v(w({},R),{children:` ${r?"":Object.keys(e).join(", ")} }`}))]}),u&&o(_,{children:o("span",v(w({className:"text-pink-500"},R),{children:e}))}),x&&o(_,{children:o("span",v(w({className:"text-indigo-400"},R),{children:e}))}),B&&o(_,{children:o("span",v(w({className:"text-indigo-400"},R),{children:String(e)}))}),C&&o(_,{children:M("span",v(w({className:"text-yellow-300"},R),{children:['"',e,'"']}))})]})},Rn=s=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(void 0);return c.exports.useEffect(()=>{const r=()=>{var i;n((i=e.model)==null?void 0:i.originalGLTFJSON)};return e.on("load",r),()=>{e.off("load",r)}},[e]),o(L,v(w({},s),{children:o(z,{className:"w-120 h-80 overflow-scroll whitespace-nowrap resize font-mono text-xs leading-tight",paddingClass:"p-0",children:o(ne,{value:t})})}))},In=s=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!0),r=c.exports.useCallback(i=>{n(i),e.lookAtPlugin.enableLookAt=i},[e]);return o(L,v(w({},s),{children:o(z,{children:o(T,{callback:r,label:"Enable LookAt",checked:t})})}))},yn=s=>{const{materialDebugger:e}=c.exports.useContext(P),t=c.exports.useCallback(n=>{const r=parseInt(n.target.value);e.applyMode(r)},[e]);return o(L,v(w({},s),{children:o(z,{children:M("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:[o("option",{value:D.None,children:"None"}),o("option",{value:D.MToonNormal,children:"MToon Normal"}),o("option",{value:D.MToonLitShadeRate,children:"MToon LitShadeRate"}),o("option",{value:D.MToonUV,children:"MToon UV"}),o("option",{value:D.UVGrid,children:"UV Grid"})]})})}))},E=({name:s,value:e,href:t})=>M("div",{children:[s,":"," ",e!=null&&o("span",{className:"font-bold",children:e}),t&&o(_e,{href:t})]}),Pn=({meta:s})=>M(_,{children:[o(E,{name:"Title",value:s.title}),o(E,{name:"Author",value:s.author}),o(E,{name:"Version",value:s.version}),o(E,{name:"Reference",value:s.reference}),o(E,{name:"Contact Information",value:s.contactInformation}),o(E,{name:"Allowed User Name",value:s.allowedUserName}),o(E,{name:"Violent Ussage Name",value:s.violentUssageName}),o(E,{name:"Sexual Ussage Name",value:s.sexualUssageName}),o(E,{name:"Commercial Ussage Name",value:s.commercialUssageName}),o(E,{name:"Other Permission URL",href:s.otherPermissionUrl}),o(E,{name:"License Name",value:s.licenseName}),o(E,{name:"Other License URL",href:s.otherLicenseUrl})]}),kn=({meta:s})=>{var e;return M(_,{children:[o(E,{name:"Name",value:s.name}),o(E,{name:"Version",value:s.version}),o(E,{name:"Authors",value:s.authors.join(", ")}),o(E,{name:"Copyright Information",value:s.copyrightInformation}),o(E,{name:"Contact Information",value:s.contactInformation}),o(E,{name:"References",value:(e=s.references)==null?void 0:e.join(", ")}),o(E,{name:"Third Party Licenses",value:s.thirdPartyLicenses}),o(E,{name:"License URL",href:s.licenseUrl}),o(E,{name:"Avatar Permission",value:s.avatarPermission}),o(E,{name:"Allow Excessively Violent Usage",value:String(s.allowExcessivelyViolentUsage)}),o(E,{name:"Allow Excessively Sexual Usage",value:String(s.allowExcessivelySexualUsage)}),o(E,{name:"Commercial Usage Name",value:s.commercialUsage}),o(E,{name:"Allow Political or Religious Usage",value:String(s.allowPoliticalOrReligiousUsage)}),o(E,{name:"Allow Antisocial or Hate Usage",value:String(s.allowAntisocialOrHateUsage)}),o(E,{name:"Credit Notation",value:s.creditNotation}),o(E,{name:"Allow Redistribution",value:String(s.allowRedistribution)}),o(E,{name:"Modification",value:s.modification}),o(E,{name:"Other License URL",href:s.otherLicenseUrl})]})},Qn=s=>{var r,i;const{inspector:e}=c.exports.useContext(P),t=(i=(r=e.model)==null?void 0:r.vrm)==null?void 0:i.meta;let n=o(_,{children:"No meta detected."});return(t==null?void 0:t.metaVersion)==="1"?n=o(kn,{meta:t}):(t==null?void 0:t.metaVersion)==="0"&&(n=o(Pn,{meta:t})),o(L,v(w({},s),{children:o(z,{children:n})}))};var Ln="./assets/dancing.2665f039.fbx",zn="./assets/gangnam-style.119f68a4.fbx",_n="./assets/jump.a8a08f02.fbx",Sn="./assets/running.c854d669.fbx",Hn="./assets/standing-clap.9fc941e1.fbx",Tn="./assets/walking.ed38b4d6.fbx";const Dn=[{name:"(No Animation)",url:"-"},{name:"Walking",url:Tn},{name:"Running",url:Sn},{name:"Jump",url:_n},{name:"Dancing",url:Ln},{name:"Standing Clap",url:Hn},{name:"Gangnam Style",url:zn}],Un=s=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useCallback(n=>{const r=n.target.value;r==="-"?e.animationPlugin.clearMixamoAnimation():e.animationPlugin.loadMixamoAnimation(r)},[e]);return o(L,v(w({},s),{children:o(z,{children:o("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:Dn.map(({name:n,url:r})=>o("option",{value:r,children:n},r))})})}))},Ue=({label:s,onChange:e,defaultChecked:t,disabled:n})=>{const r=c.exports.useCallback(i=>{const A=i.currentTarget.checked;e(A)},[]);return M("div",{className:"flex items-center",children:[o("input",{className:"mr-2",type:"checkbox",disabled:n,defaultChecked:t,onChange:r}),n?o("span",{className:"text-gray-500",children:s}):s]})},Nn=s=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!1),r=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.enabled=d,n(d)},[e]),i=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.strength=4*d},[e]),A=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.radius=d},[e]),a=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.threshold=4*d},[e]),[l,h]=c.exports.useState(!1),m=c.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.enabled=d,h(d)},[e]),p=c.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.uniforms.exposure.value=2*d},[e]);return o(L,v(w({},s),{children:M(z,{children:[o("h3",{className:"text-lg font-bold",children:"Bloom"}),o(Ue,{label:"Enabled",defaultChecked:!1,onChange:r}),o(F,{label:"Strength",defaultValue:.25,disabled:!t,onChange:i}),o(F,{label:"Radius",defaultValue:.5,disabled:!t,onChange:A}),o(F,{label:"Threshold",defaultValue:.25,disabled:!t,onChange:a}),o(O,{}),o("h3",{className:"text-lg font-bold",children:"ACES Tone Mapping"}),o(Ue,{label:"Enabled",defaultChecked:!1,onChange:m}),o(F,{label:"Exposure",defaultValue:.5,disabled:!l,onChange:p})]})}))},Vn=({name:s,url:e})=>{const{inspector:t}=c.exports.useContext(P),n=c.exports.useCallback(()=>{t.loadVRM(e)},[t]);return o("button",{value:s,className:"bg-gray-800 border border-gray-500 px-1 py-0 block",onClick:n,children:s})};var Gn="./assets/Seed-san.624d0d55.vrm",Fn="./assets/three-vrm-girl.e6e179de.vrm";const On=[{name:"three-vrm-girl (VRM0.0)",url:Fn},{name:"Seed-san (VRM1.0)",url:Gn},{name:"VRM1_Constaint_Twist_Sample (VRM1.0)",url:Le}],jn=s=>o(L,v(w({},s),{children:o(z,{children:On.map(({name:e,url:t})=>o(Vn,{name:e,url:t},e))})})),Wn=s=>{var r,i,A,a,l,h,m,p,d,f;const{inspector:e}=c.exports.useContext(P),t=(r=e.stats)==null?void 0:r.dimension.map(u=>u.toFixed(3)),n=`( ${(i=t==null?void 0:t[0])!=null?i:0}, ${(A=t==null?void 0:t[1])!=null?A:0}, ${(a=t==null?void 0:t[2])!=null?a:0} )`;return o(L,v(w({},s),{children:M(z,{children:[o(E,{name:"Dimension",value:n}),o(E,{name:"Vertices",value:(l=e.stats)==null?void 0:l.vertices}),o(E,{name:"Polygons",value:(h=e.stats)==null?void 0:h.polygons}),o(E,{name:"Meshes",value:(m=e.stats)==null?void 0:m.meshes}),o(E,{name:"Primitives",value:(p=e.stats)==null?void 0:p.primitives}),o(E,{name:"Materials",value:(d=e.stats)==null?void 0:d.materials}),o(E,{name:"Spring Bone Joints",value:(f=e.stats)==null?void 0:f.joints})]})}))},Yn=({children:s})=>o("div",{style:{marginLeft:"1.13em"},children:s}),Zn=s=>{const[e,t]=c.exports.useState(!1),n=s.severity===0?V.error:s.severity===1?V.warning:V.severityInfo,r=c.exports.useCallback(()=>{t(!e)},[e]);return M("div",{className:"group cursor-pointer",onClick:r,children:[o("span",{className:"group-hover:text-sky-500",children:e?"- ":"+ "}),o("span",{style:{color:n},children:s.code}),o("span",{className:"text-gray-500",children:" - "+s.pointer}),e&&o(Yn,{children:s.message})]})},J=({count:s,colorClass:e})=>o("span",{className:s?e:"text-gray-500",children:s}),Kn=s=>{var A,a;const{inspector:e}=c.exports.useContext(P),t=(A=e.gltfValidatorPlugin.validationReport)==null?void 0:A.issues,[n,r]=c.exports.useReducer(l=>l+1,0),i=c.exports.useCallback(()=>{const l=2*t.messages.length;e.gltfValidatorPlugin.validate(l).then(()=>r())},[t]);return o(L,v(w({},s),{children:M(z,{className:"w-120 h-80 resize overflow-y-scroll",children:[o(E,{name:"Validator Version",value:(a=e.gltfValidatorPlugin.validationReport)==null?void 0:a.validatorVersion}),o(E,{name:"Errors",value:o(J,{count:t==null?void 0:t.numErrors,colorClass:"text-red-500"})}),o(E,{name:"Warnings",value:o(J,{count:t==null?void 0:t.numWarnings,colorClass:"text-yellow-300"})}),o(E,{name:"Infos",value:o(J,{count:t==null?void 0:t.numInfos,colorClass:"text-sky-500"})}),o(E,{name:"Hints",value:o(J,{count:t==null?void 0:t.numHints,colorClass:"text-sky-500"})}),o(O,{}),(t==null?void 0:t.truncated)&&M("div",{className:"m-1 font-bold",children:["There are too many issues! Showing only ",t==null?void 0:t.messages.length," entries.",o("span",{onClick:i,className:"pl-2 text-sky-500 font-bold cursor-pointer",children:"See all"})]}),o("div",{className:"w-full font-mono leading-tight text-xs",children:t==null?void 0:t.messages.map((l,h)=>o(Zn,{code:l.code,message:l.message,severity:l.severity,pointer:l.pointer},h))})]})}))},j=s=>(s/1048576).toFixed(3)+" MB",Jn=s=>{var n,r,i,A,a,l,h,m,p,d,f,u,x,B,C,I,R,b,k,S,H,N,Q,se,oe,re,ie,Ae,ae,le;const{inspector:e}=c.exports.useContext(P),t=e.webglMemoryInfo;return o(L,v(w({},s),{children:M(z,{children:[o(E,{name:"Buffer",value:j((r=(n=t==null?void 0:t.memory)==null?void 0:n.buffer)!=null?r:0)}),o(E,{name:"Texture",value:j((A=(i=t==null?void 0:t.memory)==null?void 0:i.texture)!=null?A:0)}),o(E,{name:"Render Buffer",value:j((l=(a=t==null?void 0:t.memory)==null?void 0:a.renderbuffer)!=null?l:0)}),o(E,{name:"Drawing Buffer",value:j((m=(h=t==null?void 0:t.memory)==null?void 0:h.drawingbuffer)!=null?m:0)}),o(E,{name:"Total",value:j((d=(p=t==null?void 0:t.memory)==null?void 0:p.total)!=null?d:0)}),o(O,{}),o(E,{name:"Buffer",value:(u=(f=t==null?void 0:t.resources)==null?void 0:f.buffer)!=null?u:0}),o(E,{name:"Render Buffer",value:(B=(x=t==null?void 0:t.resources)==null?void 0:x.renderbuffer)!=null?B:0}),o(E,{name:"Program",value:(I=(C=t==null?void 0:t.resources)==null?void 0:C.program)!=null?I:0}),o(E,{name:"Query",value:(b=(R=t==null?void 0:t.resources)==null?void 0:R.query)!=null?b:0}),o(E,{name:"Sampler",value:(S=(k=t==null?void 0:t.resources)==null?void 0:k.sampler)!=null?S:0}),o(E,{name:"Shader",value:(N=(H=t==null?void 0:t.resources)==null?void 0:H.shader)!=null?N:0}),o(E,{name:"Sync",value:(se=(Q=t==null?void 0:t.resources)==null?void 0:Q.sync)!=null?se:0}),o(E,{name:"Texture",value:(re=(oe=t==null?void 0:t.resources)==null?void 0:oe.texture)!=null?re:0}),o(E,{name:"Transform Feedback",value:(Ae=(ie=t==null?void 0:t.resources)==null?void 0:ie.transformFeedback)!=null?Ae:0}),o(E,{name:"Vertex Array",value:(le=(ae=t==null?void 0:t.resources)==null?void 0:ae.vertexArray)!=null?le:0})]})}))},Xn=()=>{const[s,e]=c.exports.useState(["jsonTree","materialDebugger","meta","stats","webglMemory","blendShape","lookAt","validationReport","sampleModels","helpers","exportBufferView","mixamoAnimations","postProcessing","jsEditor","about"]),t=c.exports.useCallback((A,a)=>{const l=s.concat();l.splice(s.indexOf(a),1),l.push(a),e(l)},[s]);let n=0;const r=()=>{const A=0,a=n;return n+=20,{left:A,top:a}},i={jsonTree:o(Rn,{paneKey:"jsonTree",title:"JSON Tree",onClick:t,initPosition:r()},"jsonTree"),materialDebugger:o(yn,{paneKey:"materialDebugger",title:"MToon Material Debugger",onClick:t,initPosition:r()},"materialDebugger"),meta:o(Qn,{paneKey:"meta",title:"Meta",onClick:t,initPosition:r()},"meta"),stats:o(Wn,{paneKey:"stats",title:"Stats",onClick:t,initPosition:r()},"stats"),webglMemory:o(Jn,{paneKey:"webglMemory",title:"WebGL Memory",onClick:t,initPosition:r()},"webglMemory"),blendShape:o(En,{paneKey:"blendShape",title:"Blend Shape Proxy",onClick:t,initPosition:r()},"blendShape"),lookAt:o(In,{paneKey:"lookAt",title:"Look At",onClick:t,initPosition:r()},"lookAt"),validationReport:o(Kn,{paneKey:"validationReport",title:"Validation Report",onClick:t,initPosition:r()},"validationReport"),sampleModels:o(jn,{paneKey:"sampleModels",title:"Sample Models",onClick:t,initPosition:r()},"sampleModels"),helpers:o(Bn,{paneKey:"helpers",title:"Helpers",onClick:t,initPosition:r()},"helpers"),exportBufferView:o(xn,{paneKey:"exportBufferView",title:"Export Buffer View",onClick:t,initPosition:r()},"exportBufferView"),mixamoAnimations:o(Un,{paneKey:"mixamoAnimations",title:"Mixamo Animations",onClick:t,initPosition:r()},"mixamoAnimations"),postProcessing:o(Nn,{paneKey:"postProcessing",title:"Post Processing",onClick:t,initPosition:r()},"postProcessing"),jsEditor:o(Mn,{paneKey:"jsEditor",title:"JavaScript Editor",onClick:t,initPosition:r()},"jsEditor"),about:o(gn,{paneKey:"about",title:"About",onClick:t,initPosition:r()},"about")};return o(_,{children:s.map(A=>i[A])})},qn=()=>{const{inspector:s}=c.exports.useContext(P),[e,t]=c.exports.useState(null);c.exports.useEffect(()=>{const r=()=>{t(null)},i=A=>{t(A)};return s.on("load",r),s.on("progress",i),()=>{s.off("load",r),s.off("progress",i)}});const n=c.exports.useMemo(()=>e?e.loaded/e.total:null,[e]);return o(_,{children:o("div",{className:"w-full h-full absolute text-center pointer-events-none",children:o("div",{children:n?(100*n).toFixed(2):"yay"})})})},$n=()=>{const{inspector:s}=c.exports.useContext(P),e=c.exports.useCallback(t=>{t&&s.setup(t)},[]);return o(_,{children:M("div",{className:"w-full h-full text-sm absolute overflow-hidden text-gray-100",children:[o("canvas",{ref:e,className:"w-full h-full absolute"}),o(Xn,{}),o(qn,{})]})})},es=()=>o(_,{children:o($n,{})});Pt.render(o(Ce.StrictMode,{children:o(es,{})}),document.getElementById("root"));
