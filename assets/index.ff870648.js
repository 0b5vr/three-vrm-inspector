var Fe=Object.defineProperty,Oe=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var We=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable;var oe=(o,e,t)=>e in o?Fe(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,w=(o,e)=>{for(var t in e||(e={}))We.call(e,t)&&oe(o,t,e[t]);if(he)for(var t of he(e))Ze.call(e,t)&&oe(o,t,e[t]);return o},v=(o,e)=>Oe(o,je(e));var f=(o,e,t)=>(oe(o,typeof e!="symbol"?e+"":e,t),t);import{C as me,M as se,S as Ye,a as Ke,b as ue,V as F,Q as O,F as Je,A as pe,c as ge,d as fe,e as Xe,f as Ee,v as qe,G as X,g as xe,T as Be,h as $e,R as et,i as be,j as tt,E as nt,O as ot,U as st,k as rt,l as it,m as Ce,P as At,n as at,D as lt,o as ct,p as dt,q as ht,r as mt,s as ut,t as pt,u as gt,w as ft,x as q,y as Et,W as xt,z as Bt,B as bt,H as Ct,I as wt,J as vt,K as Rt,L as Mt,N as $,X as we,Y as yt,Z as s,_ as c,$ as R,a0 as I,a1 as _,a2 as It,a3 as Pt}from"./vendor.bfee33c9.js";const kt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const A of i.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&n(A)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};kt();const j={black:"#000000",white:"#ffffff",back1:"#191a1f",fore:"#d0edff",titleBarBg:"#30343b",accent:"#ff0066",gray:"#75848f",uiBackground:"rgba( 25, 26, 31, 0.8 )",error:"#ff0066",warning:"#f7f025",severityInfo:"#53c5ff",constant:"#ff0066",number:"#8a8aff",string:"#f7f025"},Qt=new me(j.constant),Lt=new se({color:Qt,transparent:!0,wireframe:!0,depthTest:!1,depthWrite:!1}),_t=new Ye(.2);function ve(o=_t){const e=new Ke(o,Lt);return e.frustumCulled=!1,e.renderOrder=1e4,e}function zt(o,e,t){const r=o.parser.json.nodes[e].mesh;if(r==null)return null;const A=o.parser.json.meshes[r].primitives.length,l=[];return t.traverse(a=>{l.length<A&&a.isMesh&&l.push(a)}),l}async function ee(o,e){const t=await o.parser.getDependency("node",e);return zt(o,e,t)}const St=new ue({transparent:!0,depthTest:!1,depthWrite:!1});function W(o,e=St){const t=new Map;return o.forEach(n=>{Array.isArray(n.material)&&(t.set(n,n.material[0]),n.material[0]=e)}),()=>{for(const[n,r]of t)n.material[0]=r}}function re(o){const e=new Map;return o.forEach(t=>{const n=ve();t.add(n),e.set(t,n)}),()=>{o.forEach(t=>{const n=e.get(t);t.remove(n)})}}class Ht extends ue{constructor(e){super(e);f(this,"_skinIndexVisualize");f(this,"_uniforms");this._skinIndexVisualize=0,this.onBeforeCompile=t=>{this._uniforms=t.uniforms,this._uniforms.skinIndexVisualize={value:this._skinIndexVisualize},t.vertexShader=t.vertexShader.replace("#include <common>",`#include <common>

        varying float vWeightVisualize;
        uniform float skinIndexVisualize;`),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`#ifdef USE_SKINNING
          vWeightVisualize = (
            skinIndex.x == skinIndexVisualize ? skinWeight.x : 0.0 +
            skinIndex.y == skinIndexVisualize ? skinWeight.y : 0.0 +
            skinIndex.z == skinIndexVisualize ? skinWeight.z : 0.0 +
            skinIndex.w == skinIndexVisualize ? skinWeight.w : 0.0
          );
        #else
          vWeightVisualize = 0.0;
        #endif

        #include <begin_vertex>`),t.fragmentShader=t.fragmentShader.replace("#include <packing>",`#include <packing>

        varying float vWeightVisualize;`),t.fragmentShader=t.fragmentShader.replace("gl_FragColor = vec4( packNormalToRGB( normal ), opacity );",`gl_FragColor = vec4(
          clamp( 2.0 - abs( vec3( 4.0, 2.0, 0.0 ) - 4.0 * vWeightVisualize ), 0.0, 1.0 ),
          opacity
        );`)}}get skinIndexVisualize(){return this._skinIndexVisualize}set skinIndexVisualize(e){this._uniforms&&(this._uniforms.skinIndexVisualize={value:e}),this._skinIndexVisualize=e}}const Re=new Ht({transparent:!0,depthTest:!1,depthWrite:!1}),Dt=new me(j.constant);class Tt{constructor(e){f(this,"_inspector");this._inspector=e}highlight(e){const t=this._inspector,n=e.split("/"),r=t.model.gltf,i=r.parser,A=i.json;if(n.length===3&&n[1]==="nodes"){const l=parseInt(n.pop());let a;return i.getDependency("node",l).then(h=>{a=re([h])}),()=>{a&&a()}}else if(n.length===3&&n[1]==="meshes"){const l=parseInt(n.pop());let a;const h=A.nodes,u=[];return h==null||h.forEach((d,E)=>{d.mesh===l&&u.push(E)}),Promise.all(u.map(d=>ee(r,d))).then(d=>d.flat()).then(d=>{a=W(d)}),()=>{a&&a()}}else if(n.length===5&&n[1]==="meshes"&&n[3]==="primitives"){const l=parseInt(n[2]),a=parseInt(n[4]);let h;return i.getDependency("mesh",l).then(u=>{u.children.length!==0&&(u=u.children[a]),h=W([u])}),()=>{h&&h()}}else if(n.length===7&&n[1]==="meshes"&&n[3]==="primitives"&&n[5]==="targets"){const l=parseInt(n[2]),a=parseInt(n[4]),h=parseInt(n[6]);let u;return i.getDependency("mesh",l).then(m=>{m.children.length!==0&&(m=m.children[a]);const d=m;d.morphTargetInfluences&&(d.morphTargetInfluences[h]=1),u=()=>{d.morphTargetInfluences&&(d.morphTargetInfluences[h]=0)}}),()=>{u&&u()}}else if(n.length===6&&n[1]==="meshes"&&n[3]==="extras"&&n[4]==="targetNames"){const l=parseInt(n[2]),a=parseInt(n[5]);let h;const u=A.nodes,m=[];return u==null||u.forEach((E,p)=>{E.mesh===l&&m.push(p)}),Promise.all(m.map(E=>ee(r,E))).then(E=>E.flat()).then(E=>{E.forEach(p=>{p.morphTargetInfluences&&(p.morphTargetInfluences[a]=1)}),h=()=>{E.forEach(p=>{p.morphTargetInfluences&&(p.morphTargetInfluences[a]=0)})}}),()=>{h&&h()}}else if(n.length===3&&n[1]==="skins"){const l=parseInt(n[2]);let a;const h=A.nodes,u=[];return h==null||h.forEach((d,E)=>{d.skin===l&&u.push(E)}),Promise.all(u.map(d=>ee(r,d))).then(d=>d.flat()).then(d=>{a=W(d)}),()=>{a&&a()}}else if(n.length===5&&n[1]==="skins"&&n[3]==="joints"){const l=parseInt(n[2]),a=parseInt(n[4]),h=[],u=A.skins[l].joints[a];i.getDependency("node",u).then(p=>{h.push(re([p]))});const m=A.nodes,d=[];return m==null||m.forEach((p,B)=>{p.skin===l&&d.push(B)}),Promise.all(d.map(p=>ee(r,p))).then(p=>p.flat()).then(p=>{h.push(W(p,Re)),Re.skinIndexVisualize=a}),()=>{h.forEach(p=>p())}}else if(n.length===3&&n[1]==="materials"||n.length===5&&n[2]==="VRM"&&n[3]==="materialProperties"){const l=parseInt(n.pop());let a;return i.getDependencies("mesh").then(h=>{const u=[];A.meshes.forEach((m,d)=>{m.primitives.forEach((p,B)=>{if(l===p.material){let x=h[d];x.children.length!==0&&(x=x.children[B]);const C=x;u.push(C)}})}),a=W(u)}),()=>{a&&a()}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="humanoid"&&n[4]==="humanBones"){const l={leftThumbProximal:"leftThumbMetacarpal",leftThumbIntermediate:"leftThumbProximal",rightThumbProximal:"rightThumbMetacarpal",rightThumbIntermediate:"rightThumbProximal"},a=parseInt(e.split("/").pop()),u=A.extensions.VRM.humanoid.humanBones[a].bone,m=t.model.vrm.humanoid.getBoneNode(l[u]);return re([m])}else if(n.length===4&&n[2]==="VRM"&&n[3]==="firstPerson"){const l=ve();return t.model.vrm.lookAt.getLookAtWorldPosition(l.position),t.scene.add(l),()=>{t.scene.remove(l)}}else{if(n.length===5&&n[2]==="VRM"&&n[3]==="firstPerson"&&n[4]==="meshAnnotations")return t.layerMode="firstPerson",()=>{t.layerMode="thirdPerson"};if(n.length===6&&n[2]==="VRM"&&n[3]==="blendShapeMaster"&&n[4]==="blendShapeGroups"){const l=parseInt(e.split("/").pop()),u=A.extensions.VRM.blendShapeMaster.blendShapeGroups[l].name,m=t.model.vrm.expressionManager.getValue(u);return t.model.vrm.expressionManager.setValue(u,1),()=>{t.model.vrm.expressionManager.setValue(u,m)}}else if(n.length===6&&n[2]==="VRM"&&n[3]==="secondaryAnimation"&&n[4]==="boneGroups"){const l=parseInt(e.split("/").pop()),h=A.extensions.VRM.secondaryAnimation,u=h==null?void 0:h.boneGroups[l].bones,m=t.model.vrm.springBoneManager,d=new Map;for(const C of m.joints)d.set(C.bone,C);const E=t.helpersPlugin.springBoneJointHelperRoot,p=new Map;E.children.forEach(C=>{const y=C;p.set(y.springBone,y)});const B=[],x=new Set;return u.forEach(C=>{i.getDependency("node",C).then(y=>{y.traverse(b=>{const M=d.get(b),k=p.get(M);x.add(k);const z=k.children[0].material,S=z.color.clone();z.color.copy(Dt),B.push(()=>{z.color.copy(S)})})})}),()=>{B.forEach(C=>C())}}}}}class Ut{constructor(){f(this,"_eventListeners")}on(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n)),n.push(t)}off(e,t){this._eventListeners=this._eventListeners||new Map;let n=this._eventListeners.get(e);n||(n=[],this._eventListeners.set(e,n));const r=n.indexOf(t);r!==-1&&n.splice(r,1)}_emit(...[e,t]){var n;this._eventListeners=this._eventListeners||new Map,(n=this._eventListeners.get(e))==null||n.forEach(r=>r(t))}}function Me(o,e){const t=[];let n=[],r=0;return Array.from(o).forEach(i=>{r<=0&&(r=e,n=[],t.push(n)),n.push(i),r--}),t}const Nt=new F,Vt=new O;function Gt(o){const e=o.humanoid;if(e==null)return null;const t=e.getPose(),n={};return Object.entries(e.humanBones).map(([r,i])=>{if(i!=null){const A=i.node;n[r]={position:A.getWorldPosition(Nt).toArray(),rotation:A.getWorldQuaternion(Vt).toArray()}}}),e.setPose(t),n}const Ft={mixamorigHips:"hips",mixamorigSpine:"spine",mixamorigSpine1:"chest",mixamorigSpine2:"upperChest",mixamorigNeck:"neck",mixamorigHead:"head",mixamorigLeftShoulder:"leftShoulder",mixamorigLeftArm:"leftUpperArm",mixamorigLeftForeArm:"leftLowerArm",mixamorigLeftHand:"leftHand",mixamorigLeftHandThumb1:"leftThumbMetacarpal",mixamorigLeftHandThumb2:"leftThumbProximal",mixamorigLeftHandThumb3:"leftThumbDistal",mixamorigLeftHandIndex1:"leftIndexProximal",mixamorigLeftHandIndex2:"leftIndexIntermediate",mixamorigLeftHandIndex3:"leftIndexDistal",mixamorigLeftHandMiddle1:"leftMiddleProximal",mixamorigLeftHandMiddle2:"leftMiddleIntermediate",mixamorigLeftHandMiddle3:"leftMiddleDistal",mixamorigLeftHandRing1:"leftRingProximal",mixamorigLeftHandRing2:"leftRingIntermediate",mixamorigLeftHandRing3:"leftRingDistal",mixamorigLeftHandPinky1:"leftLittleProximal",mixamorigLeftHandPinky2:"leftLittleIntermediate",mixamorigLeftHandPinky3:"leftLittleDistal",mixamorigRightShoulder:"rightShoulder",mixamorigRightArm:"rightUpperArm",mixamorigRightForeArm:"rightLowerArm",mixamorigRightHand:"rightHand",mixamorigRightHandPinky1:"rightLittleProximal",mixamorigRightHandPinky2:"rightLittleIntermediate",mixamorigRightHandPinky3:"rightLittleDistal",mixamorigRightHandRing1:"rightRingProximal",mixamorigRightHandRing2:"rightRingIntermediate",mixamorigRightHandRing3:"rightRingDistal",mixamorigRightHandMiddle1:"rightMiddleProximal",mixamorigRightHandMiddle2:"rightMiddleIntermediate",mixamorigRightHandMiddle3:"rightMiddleDistal",mixamorigRightHandIndex1:"rightIndexProximal",mixamorigRightHandIndex2:"rightIndexIntermediate",mixamorigRightHandIndex3:"rightIndexDistal",mixamorigRightHandThumb1:"rightThumbMetacarpal",mixamorigRightHandThumb2:"rightThumbProximal",mixamorigRightHandThumb3:"rightThumbDistal",mixamorigLeftUpLeg:"leftUpperLeg",mixamorigLeftLeg:"leftLowerLeg",mixamorigLeftFoot:"leftFoot",mixamorigLeftToeBase:"leftToes",mixamorigRightUpLeg:"rightUpperLeg",mixamorigRightLeg:"rightLowerLeg",mixamorigRightFoot:"rightFoot",mixamorigRightToeBase:"rightToes"},Ot=new O,jt=new O,Wt=new O,Zt=new O,Yt=new F,Kt=new F;async function Jt(o,e){const t=e.humanoid;if(t==null)return null;const r=await new Je().loadAsync(o),i=pe.findByName(r.animations,"mixamo.com"),A=[],l=Gt(e);return i.tracks.forEach(a=>{var d,E,p,B;const h=a.name.split("."),u=h[0],m=Ft[u];if(m!=null){const x=t.restPose[m],C=l==null?void 0:l[m],y=(d=t.getBoneNode(m))==null?void 0:d.name;if(y!=null){const b=h[1],M=(E=x==null?void 0:x.position)!=null?E:[0,0,0],k=Yt.fromArray(M);let T=.01;m==="hips"&&(T*=k.length(),k.multiplyScalar(0));const z=(p=x==null?void 0:x.rotation)!=null?p:[0,0,0,1],S=Ot.fromArray(z),J=(B=C==null?void 0:C.rotation)!=null?B:[0,0,0,1],V=jt.fromArray(J).multiply(S),G=Wt.copy(V).invert();a instanceof ge?A.push(new ge(`${y}.${b}`,a.times,Me(a.values,4).flatMap(U=>Zt.fromArray(U).multiply(V).premultiply(G).multiply(S).toArray()))):a instanceof fe&&A.push(new fe(`${y}.${b}`,a.times,Me(a.values,3).flatMap(U=>Kt.fromArray(U).applyQuaternion(G).multiplyScalar(T).add(k).toArray())))}}}),new pe("vrmAnimation",i.duration,A)}class Xt{constructor(e){f(this,"inspector");f(this,"_currentAnimationMixer");f(this,"_currentAnimationAction");f(this,"_currentAnimationURL");this.inspector=e}handleAfterLoad(e){const t=e.vrm;t!=null&&(this._currentAnimationMixer=new Xe(t.scene),this._currentAnimationURL!=null&&this.loadMixamoAnimation(this._currentAnimationURL))}handleAfterUnload(){this._currentAnimationAction=null,this._currentAnimationMixer=null}handleBeforeRender(e){this._currentAnimationMixer!=null&&this._currentAnimationMixer.update(e)}loadMixamoAnimation(e){var r;const t=(r=this.inspector.model)==null?void 0:r.vrm;if(!t)return;const n=this._currentAnimationMixer;!n||(this._currentAnimationAction!=null&&this.clearMixamoAnimation(),Jt(e,t).then(i=>{i&&(this._currentAnimationURL=e,this._currentAnimationAction=n.clipAction(i),this._currentAnimationAction.play())}))}clearMixamoAnimation(){var n,r;const e=(n=this.inspector.model)==null?void 0:n.vrm;if(!e)return;const t=this._currentAnimationAction;!t||(this._currentAnimationURL=null,t.stop(),this._currentAnimationAction=null,(r=e.humanoid)==null||r.resetPose())}}class qt{constructor(e){f(this,"inspector");f(this,"_controls");this.inspector=e}get controls(){return this._controls}handleAfterSetup(){const{camera:e,canvas:t}=this.inspector;this._controls=new Ee(e,t),this._controls.setTarget(0,1,0)}handleBeforeRender(e){this._controls&&this._controls.update(e)}}class ie{constructor(e){f(this,"inspector");f(this,"__validationReport");this.inspector=e,this.__validationReport=null}static get VALIDATOR_MAX_ISSUES(){return 100}get validationReport(){return this.__validationReport}async validate(e=ie.VALIDATOR_MAX_ISSUES){var r;const t=(r=this.inspector.model)==null?void 0:r.buffer;if(!t)return null;const n=await qe(new Uint8Array(t),{maxIssues:e}).catch(i=>console.error("Validation failed: ",i));return this.__validationReport=n,n}handleAfterLoad(){this.validate()}handleAfterUnload(){this.__validationReport=null}}class $t{constructor(e){f(this,"inspector");f(this,"humanoidHelperRoot");f(this,"lookAtHelperRoot");f(this,"springBoneJointHelperRoot");f(this,"springBoneColliderHelperRoot");this.inspector=e,this.humanoidHelperRoot=new X,this.humanoidHelperRoot.renderOrder=1e4,e.scene.add(this.humanoidHelperRoot),this.lookAtHelperRoot=new X,this.lookAtHelperRoot.renderOrder=1e4,e.scene.add(this.lookAtHelperRoot),this.springBoneJointHelperRoot=new X,this.springBoneJointHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneJointHelperRoot),this.springBoneColliderHelperRoot=new X,this.springBoneColliderHelperRoot.renderOrder=1e4,e.scene.add(this.springBoneColliderHelperRoot)}handleAfterUnload(){this.humanoidHelperRoot.children.concat().forEach(e=>{this.humanoidHelperRoot.remove(e),e.dispose()}),this.springBoneJointHelperRoot.children.concat().forEach(e=>{this.springBoneJointHelperRoot.remove(e),e.dispose()}),this.springBoneColliderHelperRoot.children.concat().forEach(e=>{this.springBoneColliderHelperRoot.remove(e),e.dispose()}),this.lookAtHelperRoot.children.concat().forEach(e=>{this.lookAtHelperRoot.remove(e),e.dispose()})}}function ye(o,e){let t=!1,n,r={x:0,y:0};const i=()=>{t||(requestAnimationFrame(i),n&&(o(n,r),n=void 0,r={x:0,y:0}))};i();const A=a=>{n=a,r.x+=a.movementX,r.y+=a.movementY},l=a=>{t||(e&&e(a),t=!0),window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",l),window.removeEventListener("mousedown",l)};window.addEventListener("mousemove",A),window.addEventListener("mouseup",l),setTimeout(()=>window.addEventListener("mousedown",l))}var en="./assets/grab-purple.7ef5ea20.png";const Ie=new xe;class tn{constructor(e){f(this,"inspector");f(this,"_sprites");f(this,"_transformControls");f(this,"_spriteMaterial");f(this,"_raycaster");f(this,"_active");this.inspector=e;const n=new Be().load(en,r=>{r.flipY=!1});this._spriteMaterial=new $e({sizeAttenuation:!1,transparent:!0,depthTest:!1,map:n}),this._raycaster=new et,this._active=!0}get active(){return this._active}set active(e){var t,n;this._active=e,(t=this._sprites)==null||t.forEach(r=>r.visible=e),e===!1&&((n=this._transformControls)==null||n.detach())}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new be(t,n),this._transformControls.space="local",this._transformControls.mode="rotate",e.add(this._transformControls),this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)}),n!=null&&(n==null||n.addEventListener("mousedown",r=>this.handleMouseDown(r)))}handleAfterLoad(e){var n;const t=(n=e.vrm)==null?void 0:n.humanoid;if(t!=null&&t){this._sprites=[];for(const r of Object.values(t.humanBones)){const i=r.node,A=new tt(this._spriteMaterial);A.scale.setScalar(.01),A.renderOrder=1e4,A.visible=this._active,i.add(A),this._sprites.push(A)}}}handleAfterUnload(){var e;this._sprites=null,(e=this._transformControls)==null||e.detach()}handleMouseDown(e){const{camera:t,canvas:n}=this.inspector;if(n==null)return;const r=this._sprites;if(r==null)return;const i=this._transformControls;if(i==null)return;const A=n.getBoundingClientRect();Ie.set((e.clientX-A.left)/A.width*2-1,-(e.clientY-A.top)/A.height*2+1),this._raycaster.setFromCamera(Ie,t);const a=this._raycaster.intersectObjects(r,!1)[0],h=Date.now();ye(()=>0,()=>{if(!(Date.now()-h>300))if(a!=null){const d=a.object.parent;i.attach(d)}else i.detach()})}}const Pe=new F,nn=new nt;class on{constructor(e){f(this,"inspector");f(this,"_enableLookAt");f(this,"_lookAtTarget");f(this,"_transformControls");this.inspector=e,this._enableLookAt=!1,this._lookAtTarget=new ot,e.scene.add(this._lookAtTarget)}get enableLookAt(){return this._enableLookAt}set enableLookAt(e){this._enableLookAt=e,this._transformControls&&(this._transformControls.enabled=e,this._transformControls.visible=e),e?this._enableLookAtTarget():this._disableLookAtTarget()}handleAfterSetup(){const{scene:e,camera:t,canvas:n}=this.inspector;this._transformControls=new be(t,n),e.add(this._transformControls),this._transformControls.attach(this._lookAtTarget),this._transformControls.enabled=!1,this._transformControls.visible=!1,this._transformControls.addEventListener("dragging-changed",r=>{const i=this.inspector.cameraControlsPlugin.controls;i&&(i.enabled=!r.value)})}handleAfterLoad(e){var r;const{vrm:t}=e;if(t==null)return;const n=(r=t.humanoid)==null?void 0:r.getBoneNode("head");n!=null&&(n.getWorldPosition(Pe),this._lookAtTarget.position.set(0,0,5).add(Pe)),this._enableLookAt&&this._enableLookAtTarget()}_enableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=this._lookAtTarget)}_disableLookAtTarget(){var t,n;const e=(n=(t=this.inspector.model)==null?void 0:t.vrm)==null?void 0:n.lookAt;!e||(e.target=void 0,e.applier.lookAt(nn.set(0,0,0)))}}class sn{constructor(e){f(this,"inspector");f(this,"bloomPass");f(this,"toneMappingPass");this.inspector=e,this.bloomPass=new st(new xe(4,4),1,.5,1),this.bloomPass.enabled=!1,this.toneMappingPass=new rt(it),this.toneMappingPass.enabled=!1}handleAfterSetup(){const e=this.inspector.composer;e.addPass(this.bloomPass),e.addPass(this.toneMappingPass)}}function rn(o,e){e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{Object.defineProperty(o.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}function An(o,e){const t=new Set,n=o.material;if(Array.isArray(n))n.forEach(i=>{t.add(i)});else{const r=n;t.add(r)}for(const r of t)e(r)}var an="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQQBBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAH7v5JqzrodJxSqKZUVyCEgj6EZBH0IyCMgjIPPQ8kEZB5IOwqeJbISlsqmFVgVTCEpSE5SuctkJxZCZZCZZCZZGZZCwITDrvqOe5Si6Wznvls57osouLKLiyi4souLKbiym4spuKpvCm4Sq4squLNHQma5ujrlLm6OuUubo65y5mlpnLmaWmcuZpaZy5mlpnLmaWmcubpaZy5ujpnLnaPecudo6Zy5+hpnLwaGmcvB36Zy5bzvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/8QAIBABAQEBAAIABwAAAAAAAAAAABIREwECAwQQFDBQcP/aAAgBAQABBQL39vWPm/Hivb833ftnxPenn9DjGMZ9MYxjGMYxjGMYxjGMYxjEpSlKUpSlKUpSlCEIQhCEIQhCEIcnJxcXFxcXFxcXFxcXJycv4D//xAAbEQEBAAIDAQAAAAAAAAAAAAAAEQEwAhJgcP/aAAgBAwEBPwFy39mc775CIiIiIiIiIifAf//EABwRAQEBAAMAAwAAAAAAAAAAAAATEQESMAJQcP/aAAgBAgEBPwF8Pfo4498Z9/rWt8ta1RRRRRRRRRRRRRRR3/Af/8QAGRAAAgMBAAAAAAAAAAAAAAAAATEAITBw/9oACAEBAAY/AjYUO77h/8QAHhABAQEAAQQDAAAAAAAAAAAAABEBIRAgMEFQUWD/2gAIAQEAAT8hpdhXtxr7YbidIndERnCrru4iIiIiIiIrda3ERERERERERuN7QTxgPvn83m/HAAH/AP2fzcuV1dXV1dXf3P8A/9oADAMBAAIAAwAAABD1v+TzxSRCCCBACADDAiKLNsvk00302/8AvbJpdNFF1BBwgxRRMk0QwyyyyCSf/wD407777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDnDndwzOhLnvM6uXRyzMz2M7szOjOzMzMzPhKUpSlKUpzn6nKcvsSIiIiIiIiIi//EABwRAQEBAQADAQEAAAAAAAAAABEAUQEQIDBAcP/aAAgBAgEBPxDnOt10ufbvMdz1Ij1I8hHg+Z8j5kfJ/IDMzM8nkzz0A2Gw2Gx2Ox2Ox2Ow2Gw2Gw2O/wAB/8QAIBABAQACAgMBAAMAAAAAAAAAAQARUWGREHGhIDAxYP/aAAgBAQABPxASIw/o5ye7N8cZWFfExJ8GLFixY8hE58WNyNVzmOV8TGP8IAJmTsc+FrWv6/KUq58kYx/ZAhCMY+AxjH85IQhHjPG4Zep4zxnjPGz1el6XrHCOMcY4ytStS9S9S9S9S9S9S9WerLULULULULUPU8D5PE+TwJeiVol6JeiXqXo+Weiy0WerPVno+WWi9Szs9tnZ7bke25HtuR7bke25HtuR7bLt7bLt7bLt7bLt7bLt7bLt7bLt7bLt7f8AY//Z",ln="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDAgT/2gAMAwEAAhADEAAAAc6XpYoSCEpSEpSMoISCPQ50OdDnQ5IOdDklOSlOSDnQssWKpylc4srmWVzLK5lQmFcwhMITCMwhMIzEjMsjMsjML76Tz3lnm9BZ5ryzz3lnnvK898pRdKUXylF8pTdKU3ylN8pTeFVwVXCe7Rma5ujpnLm6WmcuXp6Zy5enpnLl6eucuXp6Zy5enpnLl6emcuZp98S5ul3nLm6Wmcudo6Zy5+hpnL4NDTOXwe/TOXLed6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITMFBw/9oACAEBAAEFAvRTzRERERERERERERERERERERGWWWWWWWWWWWWWWWWHNzc3Nzc3NzYYYYYYYcnFxcXBwcHBwcHFxcXFycvgP//EABcRAQEBAQAAAAAAAAAAAAAAABEAYHD/2gAIAQMBAT8B2BERERERERERwH//xAAbEQEBAQEAAwEAAAAAAAAAAAAAExEBEjBgcP/aAAgBAgEBPwH6DWt9etaoooooopxTinFOKKKKKPP8B//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEABj8CAH//xAAcEAEBAQADAAMAAAAAAAAAAAARAAEQMEBQYHH/2gAIAQEAAT8hIiOkjgiIiIiIiIiIiI4ERERERERHwYAAf/8A++DwAt8wD9YfjoZOzs7Ozs7O/ev/2gAMAwEAAgADAAAAEBAOuj73333736qgkCm3XVdBNNNBNNRXX8QYcQQqmqqmqqoAEemjrrgkssqz7z0w07777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABsRAQEBAAIDAAAAAAAAAAAAABEAIEBREDBg/9oACAEDAQE/EJ4b6HTlmds+WdM4cM7Z2zPKU5SlKc5zn1PqU5S+xIiIiIiIiIiL/8QAHREBAQEAAgMBAQAAAAAAAAAAEQBRMGEBECBAcP/aAAgBAgEBPxD8B8HOcRxERHIfJH5gTM+J8TMzM+g9BsNhsdjsdu67rsuyOw2Gw2Gx3+A//8QAHRABAQADAQEBAQEAAAAAAAAAAQARUWGRIHFgof/aAAgBAQABPxBjGMSxYsWLFixEIERrGsY/ICEIQhGtY1r9flKUpWtaxjH5AQhCEa1rWMfkBCEIR4ni4TxPErU835s9Wer8xzHMcxzHMvUrUmpWpWpWpWpWrLVnqz1D1D1C1C1D1fknklaP8l6JWiVol6JeiVpK0WerLRZ6LLRZavyXR9bo+t0fW6PrdH1uj63R9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9bLt9f7H/9k=",cn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAasKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQABBQIAf//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8BAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/AQB//8QAFBABAAAAAAAAAAAAAAAAAAAAgP/aAAgBAQAGPwIAf//EABQQAQAAAAAAAAAAAAAAAAAAAID/2gAIAQEAAT8hAH//2gAMAwEAAgADAAAAEM8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//EABQRAQAAAAAAAAAAAAAAAAAAAID/2gAIAQMBAT8QAH//xAAUEQEAAAAAAAAAAAAAAAAAAACA/9oACAECAQE/EAB//8QAFhABAQEAAAAAAAAAAAAAAAAAABFw/9oACAEBAAE/ENwiIiIiIiIiIj//2Q==",dn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAQEBAQEAAAAAAAAAAAAAAQACAwQG/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAECA//aAAwDAQACEAMQAAAB+6+NdXO8q2eY0ywUAEBCCWEWCAgICBrIaA0WHo5qb5y2OJSEIsICAcggICCoQgaAQNAdCiAhCAgICBYBAQEBAYEJdBGgN1BQEABAsBSEWFBQUCA1g1CBqI1AQEBARRIEFBQUFBQME0SDEagICAiwiilBgIKCgoJCVKBiGDSGYBDKGUsIoQGUGUGUEKCRJCQkFUywZQygIZQEsEszosEsEBCQkJCg/8QAHRAAAQQCAwAAAAAAAAAAAAAAAgADERIBMAQUcP/aAAgBAQABBQIzCnLixbu2UOOWWd1lPr//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQMBAT8BJb2G+3//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQISMHD/2gAIAQIBAT8BIb0Eu3//xAAZEAACAwEAAAAAAAAAAAAAAAABMQAhMHD/2gAIAQEABj8CNhQ7vuH/xAAgEAEAAgEDBQEAAAAAAAAAAAABABEQIDBgITFAQVBR/9oACAEBAAE/Ib+sK9k7F+4Om9Fy8nRWwHHeMrHduXF4c8AfAfof/9oADAMBAAIAAwAAABC0w8HDHUfe8+/9+8colvcc/wDf/LKL/P8A38MRzzz2sAAAEIMm34b7/wBrCRSyyxyQBAP+++sATwwwwxwyCAM888EBixwxxyyhBP8Av/vnhQgIIIgQxnvvrPv/AD9xQYRV9/zz3//EABwRAAEDBQAAAAAAAAAAAAAAAAEQEUAAITBQcP/aAAgBAwEBPxAmyDABVsb0+gEATxxD/8QAGxEAAwADAQEAAAAAAAAAAAAAAAERECAwUGD/2gAIAQIBAT8QSdGcFvdKXEUgLtCfUXK6P0J7H//EAB0QAQEBAQACAwEAAAAAAAAAAAEAERAgMSFBUWH/2gAIAQEAAT8QAAo+E3T+MW/rq9mUsssvGtra9Nhl75Z+zpV23WUsstttttttsMNr9nfu3lLLLbbbbbbbDbMeBZZZZbbbbbYYYZZZZZZZZbbbbbYYYlllllllttttthhhiWWWWWWW223mxERLMyyyz5ERHDMzM93hERE+5mZmeMcIiImZmZ8iIiJmZmZ5llkEEEEcMzMlllllkEEEEEJmSSSyyyyyCCCCCZJJJLLLLLLIIIIIJJJJLLLLLLLIIIIIL//Z",hn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGgABAAMBAQEAAAAAAAAAAAAAAAIDBQEEBv/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/9oADAMBAAIQAxAAAAHOl6WKEgjII9CMgjIIyDnQ5IOdDkg5IEglKDSo466n3HyWGuueJPRwrsCuZZXMshMshMshMshNbIzlIylIzCNgRmCUtnUtnUtkbhKLiyi4sovKouCm4Sm4spuLKriyq4squLKriyq9bKrpbKrpSq+Cfvma5+hpnLnaGmcudo6Zy52jpnLnaOucudpaZy5ulpnLnaWmcudpaZy52lpnLnaWmcufo6Zy5+jplLn6OuUvg0NM5cN53oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/EACEQAQEBAQABAgcAAAAAAAAAAAASERMCATADBBAUIEBw/9oACAEBAAEFAvd8Xynp6V4eXjHu+j4fnL7vyz9DGMYxjPpjGMZ+GMYxjGMYxjGMYxKUpSlKUpSlKUpQhCEIQhCEIQhCHJycnFxcXFxcXFxcXFxcnL+A/wD/xAAcEQEBAAICAwAAAAAAAAAAAAARAAFAAhIwYHD/2gAIAQMBAT8B83HQxm7aD6CREREREREREfAf/8QAHREBAQEAAgIDAAAAAAAAAAAAABMRATACEkBQcP/aAAgBAgEBPwHu8/gc8PTvxn2Otb1a1rXuoooooooooooooop+A//EABoQAAICAwAAAAAAAAAAAAAAAAExACEwQHD/2gAIAQEABj8CzCCwtB9h/8QAHxABAQEAAQMFAAAAAAAAAAAAABEBIRAgMEBBUFFg/9oACAEBAAE/IYid0TpGYw519qXIR7oiIiIiIiMzr28KkRERERERGYxmr4AE7QwzETy+z56HwAGfFh//ANn87q6urq6uuXP7H//aAAwDAQACAAMAAAAQAgAQgggQkU88k/b9/vN9NNN5LbziiIwwRRxgwBB1FFNdpJbvTj//AH0gsssssENJDL777777777777777zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz//EABwRAQEAAgIDAAAAAAAAAAAAABEAECABMEBRYP/aAAgBAwEBPxDDM4d+MOO7iDJ0curPYZmZ1Zmd2cszMzM7M+CpynP1OcpSlKUpS+xIiIiIiIiIiL//xAAcEQEBAQEBAQADAAAAAAAAAAARAFEBMCAQQHD/2gAIAQIBAT8Q9e3XS7zrEfJEfPZ7nPmfgjwDyPIj9V+A8meTyZmZ+QOw2Gw2Gw2Ox2Ox2Ox2Gw2Gw3+A/wD/xAAgEAEBAAICAwEAAwAAAAAAAAABABFRYZEQcaEgMDFg/9oACAEBAAE/EHyMWLFix4ECPCypZvjjCUCEP6GMHuf4QAQh4RwkjEcYg48WNzWv6/KUp4pxOWbMY/sEQh5CQcxjH8pKQh4BCEeM8Z4zwvW9L0hajjHGOMcYerhjjHGXqVqVqVqVqy1Z6h6h6h6h6h6h6h6hahavUstFno+WerPVlos9EPR8h6h6IeiFoh6I4EcT5HA+WXb22Xb22Xb22Xb22Xb22Xb22Xb22Xb23I9tyPbcj23I9tyPbcj22dnts7Pb/sf/2Q==",mn="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgEBAQEBAUFBQUFBQYGBgYGBgYGBgYGBgYHBwcICAgHBwcGBgcHCAgICAkJCQgICAgJCQoKCgwMCwsODg4RERT/wgARCACAAIADARIAAhIAAxIA/8QAGQABAAMBAQAAAAAAAAAAAAAAAAIDBQEE/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAEDBAL/2gAMAwEAAhADEAAAAc7vSxRkEJSkJSkewRkEehzoc6HOhyQckEZKclKckHJBKZFcyyuZZXMsrmVCYVzCEwhMIzCEwjMSMyyMyyM1I2Sk7hKLivPeHnvlPPfKUXSlF8pRfKU3SlN8pTeFN4lN5ZT6Cym8spvLL/fM1z9DTOXO0NM5c7R0zlzdLTOXN0tM5czT08S5mnpnLm6emcubp6Zy5unpnLm6fvOXN09M5c7S0zlztHTOXP0dM5cVzugAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB//xAAaEAEBAQEAAwAAAAAAAAAAAAAAERITEFBw/9oACAEBAAEFAvWzzEREREREREREREREREREREZZZZZZZZZZZZZZZZYYYYYYYc3Nzc3Nzc3NhycnFxcXFwcHBwcHBxcXFy+A/wD/xAAXEQEBAQEAAAAAAAAAAAAAAAARAGBw/9oACAEDAQE/AdgREREREREREcB//8QAGxEBAQEBAAMBAAAAAAAAAAAAABMRARIwYHD/2gAIAQIBAT8B+g1rfXrWvNRRRRRTinFOKcUUUUUU/Af/xAAUEAEAAAAAAAAAAAAAAAAAAACA/9oACAEBAAY/AgB//8QAHBABAQEAAwADAAAAAAAAAAAAEQABEDBAUGBx/9oACAEBAAE/ITgjpIiIiIiIiIiIiIiIiIiIiIjgR8cAAH//AIAfPB34GdRTfjxBrs7Ozs7Ozv3H/9oADAMBAAIAAwAAABBAKqp+9999+8/roAR90XXQTTTQTRV11spECCqpqqpqoIHGEHFMNM+8+vLJIK645rq+++++++++++++++888888888888888888888888888888888888888888888888//xAAbEQEBAAIDAQAAAAAAAAAAAAARACAwEEBRYP/aAAgBAwEBPxDc4uh1szi5M5M8s8s5s4OpmeqpTlPyfk5znKUpTl9iREREREREREX/xAAdEQEBAQABBQEAAAAAAAAAAAARAFFhARAgMEBw/9oACAECAQE/EPrPA7nqPSREesjxPoDsZmZmek9JmHcOw2Gw2Gx25Lkua5o7HY7DYbDfwH//xAAdEAEBAAMBAQEBAQAAAAAAAAABABFRYZEgcWCh/9oACAEBAAE/EGJMZixYsWLFiCIQhGMYxj8gIQhSFa1rX6/KUpClYxjH5AQhCFKVjGMfkBCEKUpXmeZ5nmeb82erPV+Y5hajiOLhHEcS9StStS9S9WerPVlqFqFqFqFqFqTULUPV+Sy1ZaLPRZaLPULRC0h6IeiFohaIeiFo/wAjkvyWXb62Xb62Xb62Xb62Xb62Xb62Xb62Xb62Xb63R9bo+t0fW6PrdH1uj63R9f7H/9k=";const un=new F;Ee.install({THREE:Ce});class ke{constructor(){f(this,"animationPlugin");f(this,"cameraControlsPlugin");f(this,"gltfValidatorPlugin");f(this,"helpersPlugin");f(this,"humanoidTransformPlugin");f(this,"lookAtPlugin");f(this,"postProcessingPlugin");f(this,"_scene");f(this,"_camera");f(this,"_renderer");f(this,"_composer");f(this,"_model");f(this,"_stats",null);f(this,"_webglMemory",null);f(this,"_webglMemoryInfo",null);f(this,"_dracoLoader");f(this,"_loader");f(this,"_canvas");f(this,"_layerMode","thirdPerson");f(this,"_handleResize");f(this,"_ongoingRequestEnvMap");f(this,"_plugins");this._camera=new At(30,window.innerWidth/window.innerHeight,.1,20),this._camera.position.set(0,1,5),this._scene=new at;const e=new lt(16777215);e.position.set(1,1,1).normalize(),this._scene.add(e);const t=new ct(10,10);this._scene.add(t);const n=new dt(5);this._scene.add(n),this.helpersPlugin=new $t(this),this._dracoLoader=new ht,this._dracoLoader.setDecoderPath("./draco/"),this._loader=new mt,this._loader.setDRACOLoader(this._dracoLoader),this._loader.register(r=>new ut(r,{humanoidPlugin:new pt(r,{helperRoot:this.helpersPlugin.humanoidHelperRoot}),lookAtPlugin:new gt(r,{helperRoot:this.helpersPlugin.lookAtHelperRoot}),springBonePlugin:new ft(r,{jointHelperRoot:this.helpersPlugin.springBoneJointHelperRoot,colliderHelperRoot:this.helpersPlugin.springBoneColliderHelperRoot})})),this.animationPlugin=new Xt(this),this.cameraControlsPlugin=new qt(this),this.gltfValidatorPlugin=new ie(this),this.humanoidTransformPlugin=new tn(this),this.lookAtPlugin=new on(this),this.postProcessingPlugin=new sn(this),this._plugins=[this.animationPlugin,this.cameraControlsPlugin,this.gltfValidatorPlugin,this.helpersPlugin,this.humanoidTransformPlugin,this.lookAtPlugin,this.postProcessingPlugin]}get scene(){return this._scene}get camera(){return this._camera}get renderer(){return this._renderer}get composer(){return this._composer}get model(){var e;return(e=this._model)!=null?e:null}get stats(){return this._stats}get webglMemoryInfo(){return this._webglMemoryInfo}get canvas(){return this._canvas}get layerMode(){return this._layerMode}set layerMode(e){this._layerMode=e,this._updateLayerMode()}unloadVRM(){const e=this._model;e&&(this._scene.remove(e.scene),q.deepDispose(e.scene),this._emit("unload")),this._plugins.forEach(t=>{var n;return(n=t.handleAfterUnload)==null?void 0:n.call(t)}),this._model=null}async loadVRM(e){var h,u,m,d,E;const t=await fetch(e).then(p=>p.arrayBuffer());this.unloadVRM();const r=new Et({credentials:"include"}).binaryToJSON(t).json,i=await new Promise((p,B)=>{this._loader.crossOrigin="anonymous",this._loader.load(e,x=>{p(x)},x=>{this._emit("progress",x)},x=>{this._emit("error",x),B(x)})});q.removeUnnecessaryVertices(i.scene),q.removeUnnecessaryJoints(i.scene);const A=(h=i.userData.vrm)!=null?h:null;A==null&&console.warn("Failed to load the model as a VRM. Fallback to treat the model as a mere GLTF"),this._stats=await this._prepareStats(i,A);const l=(u=A==null?void 0:A.scene)!=null?u:i.scene;this._scene.add(l);const a={buffer:t,gltf:i,originalGLTFJSON:r,vrm:A,scene:l};return this._model=a,this._plugins.forEach(p=>{var B;return(B=p.handleAfterLoad)==null?void 0:B.call(p,a)}),A&&((m=A.firstPerson)==null||m.setup(),this._updateLayerMode(),A.scene.traverse(p=>{"isMesh"in p&&An(p,async B=>{"isMeshStandardMaterial"in B&&(B.envMap=await this._requestEnvMap())})}),q.rotateVRM0(A),(d=A.springBoneManager)==null||d.setInitState(),(E=A.nodeConstraintManager)==null||E.setInitState()),this._emit("load",a),a}async exportBufferView(e){var l;const t=(l=this._model)==null?void 0:l.gltf;if(t==null)return;const n=await t.parser.getDependency("bufferView",e),r=new Blob([n]),i=URL.createObjectURL(r),A=document.createElement("a");A.href=i,A.download=`${e}.bin`,A.click(),URL.revokeObjectURL(i)}setup(e){this._canvas=e;const t=window.innerWidth,n=window.innerHeight,r=window.devicePixelRatio;this._renderer=new xt({canvas:this._canvas}),this._renderer.outputEncoding=Bt,this._renderer.setSize(t,n),this._renderer.setPixelRatio(r),this._composer=new bt(this._renderer,new Ct(t,n,{type:wt})),this._composer.setPixelRatio(window.devicePixelRatio);const i=new vt(this._scene,this._camera);this._composer.addPass(i),this._handleResize&&window.removeEventListener("resize",this._handleResize),this._handleResize=()=>{this._camera.aspect=window.innerWidth/window.innerHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(window.innerWidth,window.innerHeight),this._composer.setSize(window.innerWidth,window.innerHeight)},window.addEventListener("resize",this._handleResize),this._webglMemory=this._renderer.getContext().getExtension("GMAN_webgl_memory"),this._plugins.forEach(A=>{var l;return(l=A.handleAfterSetup)==null?void 0:l.call(A)})}registerDnD(e){const t=r=>{r.preventDefault()},n=r=>{r.preventDefault();const i=r.dataTransfer.files;if(!i)return;const A=i[0];if(!A)return;const l=new Blob([A],{type:"application/octet-stream"}),a=URL.createObjectURL(l);this.loadVRM(a)};return e.addEventListener("dragover",t),e.addEventListener("drop",n),()=>{e.removeEventListener("dragover",t),e.removeEventListener("drop",n)}}update(e){var t;((t=this._model)==null?void 0:t.vrm)&&this._model.vrm.update(e),this._plugins.forEach(n=>{var r;return(r=n.handleBeforeRender)==null?void 0:r.call(n,e)}),this._composer&&this._composer.render(e),this._webglMemory&&(this._webglMemoryInfo=this._webglMemory.getMemoryInfo())}async _prepareStats(e,t){var E,p,B;const n=new Rt,r=new Set;let i=0,A=0,l=0;const a=x=>{var b,M;A++;const C=x.geometry;n.expandByObject(x);const y=C.getAttribute("position");r.add(y),l+=((M=(b=C.index)==null?void 0:b.count)!=null?M:y.count)/3};(await e.parser.getDependencies("mesh")).forEach(x=>{i++,x.isMesh?a(x):x.children.forEach(y=>{a(y)})});let u=0;for(const x of r)u+=x.count;const m=await e.parser.getDependencies("material"),d=(B=(p=(E=t==null?void 0:t.springBoneManager)==null?void 0:E.joints)==null?void 0:p.size)!=null?B:0;return{dimension:n.getSize(un).toArray(),vertices:u,polygons:l,meshes:i,primitives:A,materials:m.length,joints:d}}_requestEnvMap(){const e=[ln,an,dn,cn,mn,hn];if(!this._ongoingRequestEnvMap){const t=new Mt;this._ongoingRequestEnvMap=new Promise((n,r)=>{t.load(e,i=>n(i),void 0,i=>r(i))})}return this._ongoingRequestEnvMap}_updateLayerMode(){var t,n;const e=(n=(t=this._model)==null?void 0:t.vrm)==null?void 0:n.firstPerson;!e||(this._layerMode==="firstPerson"?(this._camera.layers.enable(e.firstPersonOnlyLayer),this._camera.layers.disable(e.thirdPersonOnlyLayer)):(this._camera.layers.disable(e.firstPersonOnlyLayer),this._camera.layers.enable(e.thirdPersonOnlyLayer)))}}rn(ke,[Ut]);var pn="./assets/uv-grid.cfc47a74.png",H;(function(o){o[o.None=0]="None",o[o.GLTFFallback=1]="GLTFFallback",o[o.MToonNormal=2]="MToonNormal",o[o.MToonLitShadeRate=3]="MToonLitShadeRate",o[o.MToonUV=4]="MToonUV",o[o.UVGrid=5]="UVGrid"})(H||(H={}));const Qe=new se({visible:!1}),gn=new Promise(o=>{new Be().load(pn,t=>{t.flipY=!1,o(t)})});function Le(){const o=new se({color:16711935});return gn.then(e=>{o.map=e,o.color.set(16777215)}),o}function _e(o,e){if("isMToonMaterial"in o){const t=o;t.debugMode=e}}function ze(o){return"isMToonMaterial"in o?o.isOutline:!1}class fn{constructor(e){f(this,"_currentMode",0);f(this,"_vrmMaterialsByMesh",new Map);f(this,"_inspector");this._inspector=e,this._inspector.on("load",()=>this._handleLoad()),this._inspector.on("unload",()=>this._handleUnload())}applyMode(e){e===0?this._applyModeMToon($.None):e===2?this._applyModeMToon($.Normal):e===3?this._applyModeMToon($.LitShadeRate):e===4?this._applyModeMToon($.UV):e===5&&this._applyModeUVGrid(),this._currentMode=e}_applyModeMToon(e){for(const[t,n]of this._vrmMaterialsByMesh.entries())Array.isArray(n)?n.forEach((r,i)=>{_e(r,e),t.material[i]=r}):(_e(n,e),t.material=n)}_applyModeUVGrid(){for(const[e,t]of this._vrmMaterialsByMesh.entries())Array.isArray(t)?t.forEach((n,r)=>{ze(n)?e.material[r]=Qe:e.material[r]=Le()}):ze(t)?e.material=Qe:e.material=Le()}async _handleLoad(){(await this._inspector.model.gltf.parser.getDependencies("mesh")).forEach(t=>{if("isGroup"in t)t.children.forEach(r=>{const i=r;this._addManagedMesh(i)});else{const n=t;this._addManagedMesh(n)}}),this.applyMode(this._currentMode)}_addManagedMesh(e){Array.isArray(e.material)?this._vrmMaterialsByMesh.set(e,e.material.concat()):this._vrmMaterialsByMesh.set(e,e.material)}_handleUnload(){this._vrmMaterialsByMesh.clear()}}var Se="./assets/three-vrm-girl-vrm0.0.e6e179de.vrm";function En(o){console.error(o)}const D=new ke;D.loadVRM(Se).catch(En);D.registerDnD(document.body);const xn=new Tt(D),Bn=new fn(D);console.info(D);const bn=new yt;function He(){requestAnimationFrame(He);const o=bn.getDelta();D.update(o)}He();const P=we.createContext({inspector:D,highlighter:xn,materialDebugger:Bn}),De=({href:o,widthClass:e})=>o==null?null:s("a",{href:o,target:"_blank",rel:"noreferrer",className:`font-bold truncate inline-block align-top underline text-sky-500 ${e!=null?e:"w-64"}`,children:o});function Cn(){const o=c.exports.useRef(-1/0);return c.exports.useCallback(t=>{const n=performance.now();n-o.current<250?(t(),o.current=-1/0):o.current=n},[o])}const Q=o=>{var h,u,m;const[e,t]=c.exports.useState((h=o.initPosition)!=null?h:{left:0,top:0}),[n,r]=c.exports.useState((u=o.initOpening)!=null?u:!1),i=Cn(),A=c.exports.useCallback(d=>{var E;(E=o.onClick)==null||E.call(o,d,o.paneKey)},[o.onClick,o.paneKey]),l=c.exports.useCallback(d=>{d.preventDefault();let E=e.left,p=e.top;ye((B,x)=>{B.preventDefault(),B.stopPropagation(),E+=x.x,p+=x.y,t({left:E,top:p})}),i(()=>{r(!n)})},[n,e]),a=c.exports.useCallback(d=>{var E;d.preventDefault(),d.stopPropagation(),(E=o.onClick)==null||E.call(o,d,o.paneKey),r(!n)},[n,o.onClick,o.paneKey]);return R("div",{style:{left:e.left,top:e.top,minWidth:"15rem",boxShadow:"0 0 10px rgba(0, 0, 0, 1.0)"},className:`absolute shadow ${o.className}`,onMouseDown:A,children:[R("div",{className:"h-5 leading-5 w-full bg-gray-700 cursor-move",onMouseDown:l,children:[s("div",{className:"inline-block w-5 h-5 text-center cursor-pointer hover:text-sky-500",onMouseDown:a,children:n?"-":"+"}),o.title]}),n&&((m=o.children)!=null?m:null)]})},L=({className:o,paddingClass:e,children:t})=>s("div",{className:`bg-gray-900/80 backdrop-blur ${e!=null?e:"p-2"} ${o}`,children:t}),wn=o=>s(Q,v(w({},o),{children:R(L,{children:[s("div",{children:"three-vrm-inspector"}),s("div",{children:"Three.js based VRM inspector"}),R("div",{children:["Source: ",s(De,{widthClass:"w-min",href:"https://github.com/0b5vr/three-vrm-inspector"})]})]})})),Z=({label:o,onChange:e,defaultValue:t,disabled:n})=>{const r=c.exports.useCallback(i=>{const A=parseFloat(i.currentTarget.value);e(A)},[]);return R("div",{className:"flex items-center",children:[s("input",{className:"mr-2",type:"range",min:"0",max:"1",step:"0.001",defaultValue:t!=null?t:0,disabled:n,onChange:r}),n?s("span",{className:"text-gray-500",children:o}):o]})},Te=({name:o,isAvailable:e})=>{const{inspector:t}=c.exports.useContext(P),n=c.exports.useCallback(r=>{var i,A,l;(l=(A=(i=t.model)==null?void 0:i.vrm)==null?void 0:A.expressionManager)==null||l.setValue(o,r)},[]);return s(Z,{label:o,disabled:!e,onChange:n})},Y=()=>s("div",{className:"w-full h-0.5 my-2 bg-gray-500"}),Ue=[I.Neutral,I.Happy,I.Angry,I.Sad,I.Relaxed,I.Surprised,I.Blink,I.BlinkLeft,I.BlinkRight,I.Aa,I.Ee,I.Ih,I.Oh,I.Ou,I.LookLeft,I.LookRight,I.LookDown,I.LookUp],vn=new Set(Ue),Rn=o=>{var A,l,a;const{inspector:e}=c.exports.useContext(P),t=(l=(A=e.model)==null?void 0:A.vrm)==null?void 0:l.expressionManager,n=t==null?void 0:t.expressionMap,r=[];n&&Array.from(Object.keys(n)).forEach(h=>{vn.has(h)||r.push(h)});const i=((a=r==null?void 0:r.length)!=null?a:0)>=1;return s(Q,v(w({},o),{children:s(L,{children:t?R(_,{children:[Ue.map(h=>s(Te,{name:h,isAvailable:(t==null?void 0:t.getExpression(h))!=null},h)),s(Y,{}),r==null?void 0:r.map(h=>s(Te,{name:h,isAvailable:!0},h)),!i&&s("span",{className:"text-gray-500",children:"(No custom expressions)"})]}):"No blendShapeProxy detected."})}))},Mn=o=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useRef(null),n=c.exports.useCallback(r=>{var A;r.preventDefault();const i=(A=t.current)==null?void 0:A.value;if(i!=null&&i!==""){const l=parseInt(i,10);e.exportBufferView(l)}},[e]);return s(Q,v(w({},o),{children:s(L,{children:R("form",{onSubmit:n,children:[s("input",{type:"number",ref:t,defaultValue:0,className:"w-24 px-1 bg-gray-800 border border-gray-500",required:!0}),s("input",{type:"submit",className:"ml-1 px-1 bg-gray-800 border border-gray-500",value:"Export"})]})})}))},N=({callback:o,label:e,checked:t})=>{const n=c.exports.useCallback(({target:r})=>{o(r.checked)},[o]);return R("div",{children:[s("input",{type:"checkbox",checked:t,onChange:n}),e]})},yn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!0),[r,i]=c.exports.useState(!0),[A,l]=c.exports.useState(!0),[a,h]=c.exports.useState(!0),[u,m]=c.exports.useState(!0),d=c.exports.useCallback(()=>{n(!0),i(!0),l(!0),h(!0),m(!0)},[]),E=c.exports.useCallback(()=>{n(!1),i(!1),l(!1),h(!1),m(!1)},[]),p=c.exports.useCallback(b=>{n(b)},[e]),B=c.exports.useCallback(b=>{i(b)},[e]),x=c.exports.useCallback(b=>{l(b)},[e]),C=c.exports.useCallback(b=>{h(b)},[e]),y=c.exports.useCallback(b=>{m(b)},[e]);return c.exports.useEffect(()=>{e.helpersPlugin.humanoidHelperRoot.visible=t},[e,t]),c.exports.useEffect(()=>{e.humanoidTransformPlugin.active=r},[e,r]),c.exports.useEffect(()=>{e.helpersPlugin.lookAtHelperRoot.visible=A},[e,A]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneJointHelperRoot.visible=a},[e,a]),c.exports.useEffect(()=>{e.helpersPlugin.springBoneColliderHelperRoot.visible=u},[e,u]),s(Q,v(w({},o),{children:R(L,{children:[s("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:d,children:"Enable All"}),s("button",{className:"ml-1 px-1 bg-gray-800 border border-gray-500",onClick:E,children:"Disable All"}),s(Y,{}),s(N,{callback:p,label:"Humanoid",checked:t}),s(N,{callback:B,label:"Humanoid Transform",checked:r}),s(N,{callback:x,label:"LookAt",checked:A}),s(N,{callback:C,label:"Spring Bones",checked:a}),s(N,{callback:y,label:"Spring Bone Colliders",checked:u})]})}))},In="modulepreload",Ne={},Pn="./",kn=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${Pn}${n}`,n in Ne)return;Ne[n]=!0;const r=n.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const A=document.createElement("link");if(A.rel=r?"stylesheet":In,r||(A.as="script",A.crossOrigin=""),A.href=n,document.head.appendChild(A),r)return new Promise((l,a)=>{A.addEventListener("load",l),A.addEventListener("error",a)})})).then(()=>e())};const Qn=`// Press Ctrl+S or Ctrl+R to apply
// The api will be changed without notice! Use at your own risk

export default ( { inspector, THREE } ) => {
  let isUnmounted = false;

  const vrm = inspector.model.vrm;

  // update
  const beginTime = Date.now();

  function update() {
    if ( isUnmounted ) { return; }

    const time = 0.001 * ( Date.now() - beginTime );

    const leftUpperArm = vrm.humanoid?.getBoneNode( 'leftUpperArm' );
    if ( leftUpperArm != null ) {
      leftUpperArm.rotation.z = Math.sin( time );
    }

    requestAnimationFrame( update );
  }
  requestAnimationFrame( update );

  // uninit
  return () => {
    isUnmounted = true;
  };
}
`,Ln=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(Qn),[r,i]=c.exports.useState(!1),A=c.exports.useRef();c.exports.useEffect(()=>{window.addEventListener("beforeunload",m=>{if(r){const d="You will lose all of your changes on the editor!";return m.returnValue=d,d}})},[r]);const l=c.exports.useCallback(m=>{var p;(p=A.current)==null||p.call(A);const d=new Blob([m],{type:"text/javascript"}),E=URL.createObjectURL(d);kn(()=>import(E),[]).then(B=>{A.current=B.default({inspector:e,THREE:Ce}),URL.revokeObjectURL(E)})},[e]),a=c.exports.useCallback(m=>{m.addKeyMap({"Ctrl-S":()=>{l(m.getValue())},"Ctrl-R":()=>{l(m.getValue())}})},[l]),h=c.exports.useCallback((m,d,E)=>{n(E),i(!0)},[]),u=c.exports.useCallback(()=>{},[]);return s(Q,v(w({},o),{children:s(L,{className:"w-120 h-80",paddingClass:"p-0",children:s(It,{value:t,options:{mode:"text/javascript",keyMap:"sublime",theme:"monokai-sharp",lineNumbers:!0},editorDidMount:a,onBeforeChange:h,onChange:u,className:"h-full leading-tight"})})}))},te=({children:o,onClick:e,onMouseEnter:t,onMouseLeave:n})=>s("span",{className:"select-none cursor-pointer",onClick:e,onMouseEnter:t,onMouseLeave:n,children:o}),Ve=({children:o})=>s("div",{style:{marginLeft:"1.13em"},children:o}),Ae=({name:o,value:e,fullPath:t=""})=>{const{highlighter:n}=c.exports.useContext(P),[r,i]=c.exports.useState(!1),[A,l]=c.exports.useState(!1),[a,h]=c.exports.useState([void 0]),u=c.exports.useCallback(M=>{M.stopPropagation(),i(!r)},[i,r]),m=c.exports.useCallback(()=>{l(!0),h([n.highlight(t)])},[l,h,n,t]),d=c.exports.useCallback(()=>{var M;l(!1),(M=a[0])==null||M.call(a)},[l,a]),E=Array.isArray(e),p=e==null,B=typeof e=="number",x=typeof e=="boolean",C=typeof e=="string",y=!E&&!p&&!B&&!x&&!C,b={onClick:u,onMouseEnter:m,onMouseLeave:d,isHovering:A};return R("div",{className:"select-auto",children:[s("span",v(w({className:`cursor-pointer ${A&&"text-sky-500"}`},b),{children:o?`${o}: `:""})),E&&R(_,{children:[s(te,v(w({},b),{children:"["})),r&&s(Ve,{children:e.map((M,k)=>s("div",{children:s(Ae,{name:k.toString()+((M==null?void 0:M.name)?` (${M.name})`:""),value:M,fullPath:`${t}/${k}`})},k))}),s(te,v(w({},b),{children:` ${r?"":e.length} ]`}))]}),y&&R(_,{children:[s(te,v(w({},b),{children:"{"})),r&&s(Ve,{children:Object.keys(e).map((M,k)=>s("div",{children:s(Ae,{name:M,value:e[M],fullPath:`${t}/${M}`})},k))}),s(te,v(w({},b),{children:` ${r?"":Object.keys(e).join(", ")} }`}))]}),p&&s(_,{children:s("span",v(w({className:"text-pink-500"},b),{children:e}))}),B&&s(_,{children:s("span",v(w({className:"text-indigo-400"},b),{children:e}))}),x&&s(_,{children:s("span",v(w({className:"text-indigo-400"},b),{children:String(e)}))}),C&&s(_,{children:R("span",v(w({className:"text-yellow-300"},b),{children:['"',e,'"']}))})]})},_n=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(void 0);return c.exports.useEffect(()=>{const r=()=>{var i;n((i=e.model)==null?void 0:i.originalGLTFJSON)};return e.on("load",r),()=>{e.off("load",r)}},[e]),s(Q,v(w({},o),{children:s(L,{className:"w-120 h-80 overflow-scroll whitespace-nowrap resize font-mono text-xs leading-tight",paddingClass:"p-0",children:s(Ae,{value:t})})}))},zn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!0),r=c.exports.useCallback(i=>{n(i),e.lookAtPlugin.enableLookAt=i},[e]);return s(Q,v(w({},o),{children:s(L,{children:s(N,{callback:r,label:"Enable LookAt",checked:t})})}))},Sn=o=>{const{materialDebugger:e}=c.exports.useContext(P),t=c.exports.useCallback(n=>{const r=parseInt(n.target.value);e.applyMode(r)},[e]);return s(Q,v(w({},o),{children:s(L,{children:R("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:[s("option",{value:H.None,children:"None"}),s("option",{value:H.MToonNormal,children:"MToon Normal"}),s("option",{value:H.MToonLitShadeRate,children:"MToon LitShadeRate"}),s("option",{value:H.MToonUV,children:"MToon UV"}),s("option",{value:H.UVGrid,children:"UV Grid"})]})})}))},g=({name:o,value:e,href:t})=>R("div",{children:[o,":"," ",e!=null&&s("span",{className:"font-bold",children:e}),t&&s(De,{href:t})]}),Hn=({meta:o})=>R(_,{children:[s(g,{name:"Title",value:o.title}),s(g,{name:"Author",value:o.author}),s(g,{name:"Version",value:o.version}),s(g,{name:"Reference",value:o.reference}),s(g,{name:"Contact Information",value:o.contactInformation}),s(g,{name:"Allowed User Name",value:o.allowedUserName}),s(g,{name:"Violent Ussage Name",value:o.violentUssageName}),s(g,{name:"Sexual Ussage Name",value:o.sexualUssageName}),s(g,{name:"Commercial Ussage Name",value:o.commercialUssageName}),s(g,{name:"Other Permission URL",href:o.otherPermissionUrl}),s(g,{name:"License Name",value:o.licenseName}),s(g,{name:"Other License URL",href:o.otherLicenseUrl})]}),Dn=({meta:o})=>{var e;return R(_,{children:[s(g,{name:"Name",value:o.name}),s(g,{name:"Version",value:o.version}),s(g,{name:"Authors",value:o.authors.join(", ")}),s(g,{name:"Copyright Information",value:o.copyrightInformation}),s(g,{name:"Contact Information",value:o.contactInformation}),s(g,{name:"References",value:(e=o.references)==null?void 0:e.join(", ")}),s(g,{name:"Third Party Licenses",value:o.thirdPartyLicenses}),s(g,{name:"License URL",href:o.licenseUrl}),s(g,{name:"Avatar Permission",value:o.avatarPermission}),s(g,{name:"Allow Excessively Violent Usage",value:String(o.allowExcessivelyViolentUsage)}),s(g,{name:"Allow Excessively Sexual Usage",value:String(o.allowExcessivelySexualUsage)}),s(g,{name:"Commercial Usage Name",value:o.commercialUsage}),s(g,{name:"Allow Political or Religious Usage",value:String(o.allowPoliticalOrReligiousUsage)}),s(g,{name:"Allow Antisocial or Hate Usage",value:String(o.allowAntisocialOrHateUsage)}),s(g,{name:"Credit Notation",value:o.creditNotation}),s(g,{name:"Allow Redistribution",value:String(o.allowRedistribution)}),s(g,{name:"Modification",value:o.modification}),s(g,{name:"Other License URL",href:o.otherLicenseUrl})]})},Tn=o=>{var r,i;const{inspector:e}=c.exports.useContext(P),t=(i=(r=e.model)==null?void 0:r.vrm)==null?void 0:i.meta;let n=s(_,{children:"No meta detected."});return(t==null?void 0:t.metaVersion)==="1"?n=s(Dn,{meta:t}):(t==null?void 0:t.metaVersion)==="0"&&(n=s(Hn,{meta:t})),s(Q,v(w({},o),{children:s(L,{children:n})}))};var Un="./assets/dancing.2665f039.fbx",Nn="./assets/gangnam-style.119f68a4.fbx",Vn="./assets/jump.a8a08f02.fbx",Gn="./assets/running.c854d669.fbx",Fn="./assets/standing-clap.9fc941e1.fbx",On="./assets/walking.ed38b4d6.fbx";const jn=[{name:"(No Animation)",url:"-"},{name:"Walking",url:On},{name:"Running",url:Gn},{name:"Jump",url:Vn},{name:"Dancing",url:Un},{name:"Standing Clap",url:Fn},{name:"Gangnam Style",url:Nn}],Wn=o=>{const{inspector:e}=c.exports.useContext(P),t=c.exports.useCallback(n=>{const r=n.target.value;r==="-"?e.animationPlugin.clearMixamoAnimation():e.animationPlugin.loadMixamoAnimation(r)},[e]);return s(Q,v(w({},o),{children:s(L,{children:s("select",{className:"bg-gray-800 border border-gray-500 w-full",onChange:t,children:jn.map(({name:n,url:r})=>s("option",{value:r,children:n},r))})})}))},Ge=({label:o,onChange:e,defaultChecked:t,disabled:n})=>{const r=c.exports.useCallback(i=>{const A=i.currentTarget.checked;e(A)},[]);return R("div",{className:"flex items-center",children:[s("input",{className:"mr-2",type:"checkbox",disabled:n,defaultChecked:t,onChange:r}),n?s("span",{className:"text-gray-500",children:o}):o]})},Zn=o=>{const{inspector:e}=c.exports.useContext(P),[t,n]=c.exports.useState(!1),r=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.enabled=d,n(d)},[e]),i=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.strength=4*d},[e]),A=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.radius=d},[e]),l=c.exports.useCallback(d=>{e.postProcessingPlugin.bloomPass.threshold=4*d},[e]),[a,h]=c.exports.useState(!1),u=c.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.enabled=d,h(d)},[e]),m=c.exports.useCallback(d=>{e.postProcessingPlugin.toneMappingPass.uniforms.exposure.value=2*d},[e]);return s(Q,v(w({},o),{children:R(L,{children:[s("h3",{className:"text-lg font-bold",children:"Bloom"}),s(Ge,{label:"Enabled",defaultChecked:!1,onChange:r}),s(Z,{label:"Strength",defaultValue:.25,disabled:!t,onChange:i}),s(Z,{label:"Radius",defaultValue:.5,disabled:!t,onChange:A}),s(Z,{label:"Threshold",defaultValue:.25,disabled:!t,onChange:l}),s(Y,{}),s("h3",{className:"text-lg font-bold",children:"ACES Tone Mapping"}),s(Ge,{label:"Enabled",defaultChecked:!1,onChange:u}),s(Z,{label:"Exposure",defaultValue:.5,disabled:!a,onChange:m})]})}))},Yn=({name:o,url:e})=>{const{inspector:t}=c.exports.useContext(P),n=c.exports.useCallback(()=>{t.loadVRM(e)},[t]);return s("button",{value:o,className:"bg-gray-800 border border-gray-500 px-1 py-0 block",onClick:n,children:o})};var Kn="./assets/three-vrm-girl.0525ec01.vrm";const Jn=[{name:"three-vrm-girl (VRM0.X)",url:Se},{name:"three-vrm-girl (VRM1.0-beta)",url:Kn}],Xn=o=>s(Q,v(w({},o),{children:s(L,{children:Jn.map(({name:e,url:t})=>s(Yn,{name:e,url:t},e))})})),qn=o=>{var r,i,A,l,a,h,u,m,d,E;const{inspector:e}=c.exports.useContext(P),t=(r=e.stats)==null?void 0:r.dimension.map(p=>p.toFixed(3)),n=`( ${(i=t==null?void 0:t[0])!=null?i:0}, ${(A=t==null?void 0:t[1])!=null?A:0}, ${(l=t==null?void 0:t[2])!=null?l:0} )`;return s(Q,v(w({},o),{children:R(L,{children:[s(g,{name:"Dimension",value:n}),s(g,{name:"Vertices",value:(a=e.stats)==null?void 0:a.vertices}),s(g,{name:"Polygons",value:(h=e.stats)==null?void 0:h.polygons}),s(g,{name:"Meshes",value:(u=e.stats)==null?void 0:u.meshes}),s(g,{name:"Primitives",value:(m=e.stats)==null?void 0:m.primitives}),s(g,{name:"Materials",value:(d=e.stats)==null?void 0:d.materials}),s(g,{name:"Spring Bone Joints",value:(E=e.stats)==null?void 0:E.joints})]})}))},$n=({children:o})=>s("div",{style:{marginLeft:"1.13em"},children:o}),eo=o=>{const[e,t]=c.exports.useState(!1),n=o.severity===0?j.error:o.severity===1?j.warning:j.severityInfo,r=c.exports.useCallback(()=>{t(!e)},[e]);return R("div",{className:"group cursor-pointer",onClick:r,children:[s("span",{className:"group-hover:text-sky-500",children:e?"- ":"+ "}),s("span",{style:{color:n},children:o.code}),s("span",{className:"text-gray-500",children:" - "+o.pointer}),e&&s($n,{children:o.message})]})},ne=({count:o,colorClass:e})=>s("span",{className:o?e:"text-gray-500",children:o}),to=o=>{var A,l;const{inspector:e}=c.exports.useContext(P),t=(A=e.gltfValidatorPlugin.validationReport)==null?void 0:A.issues,[n,r]=c.exports.useReducer(a=>a+1,0),i=c.exports.useCallback(()=>{const a=2*t.messages.length;e.gltfValidatorPlugin.validate(a).then(()=>r())},[t]);return s(Q,v(w({},o),{children:R(L,{className:"w-120 h-80 resize overflow-y-scroll",children:[s(g,{name:"Validator Version",value:(l=e.gltfValidatorPlugin.validationReport)==null?void 0:l.validatorVersion}),s(g,{name:"Errors",value:s(ne,{count:t==null?void 0:t.numErrors,colorClass:"text-red-500"})}),s(g,{name:"Warnings",value:s(ne,{count:t==null?void 0:t.numWarnings,colorClass:"text-yellow-300"})}),s(g,{name:"Infos",value:s(ne,{count:t==null?void 0:t.numInfos,colorClass:"text-sky-500"})}),s(g,{name:"Hints",value:s(ne,{count:t==null?void 0:t.numHints,colorClass:"text-sky-500"})}),s(Y,{}),(t==null?void 0:t.truncated)&&R("div",{className:"m-1 font-bold",children:["There are too many issues! Showing only ",t==null?void 0:t.messages.length," entries.",s("span",{onClick:i,className:"pl-2 text-sky-500 font-bold cursor-pointer",children:"See all"})]}),s("div",{className:"w-full font-mono leading-tight text-xs",children:t==null?void 0:t.messages.map((a,h)=>s(eo,{code:a.code,message:a.message,severity:a.severity,pointer:a.pointer},h))})]})}))},K=o=>(o/1048576).toFixed(3)+" MB",no=o=>{var n,r,i,A,l,a,h,u,m,d,E,p,B,x,C,y,b,M,k,T,z,S,J,V,G,U,ae,le,ce,de;const{inspector:e}=c.exports.useContext(P),t=e.webglMemoryInfo;return s(Q,v(w({},o),{children:R(L,{children:[s(g,{name:"Buffer",value:K((r=(n=t==null?void 0:t.memory)==null?void 0:n.buffer)!=null?r:0)}),s(g,{name:"Texture",value:K((A=(i=t==null?void 0:t.memory)==null?void 0:i.texture)!=null?A:0)}),s(g,{name:"Render Buffer",value:K((a=(l=t==null?void 0:t.memory)==null?void 0:l.renderbuffer)!=null?a:0)}),s(g,{name:"Drawing Buffer",value:K((u=(h=t==null?void 0:t.memory)==null?void 0:h.drawingbuffer)!=null?u:0)}),s(g,{name:"Total",value:K((d=(m=t==null?void 0:t.memory)==null?void 0:m.total)!=null?d:0)}),s(Y,{}),s(g,{name:"Buffer",value:(p=(E=t==null?void 0:t.resources)==null?void 0:E.buffer)!=null?p:0}),s(g,{name:"Render Buffer",value:(x=(B=t==null?void 0:t.resources)==null?void 0:B.renderbuffer)!=null?x:0}),s(g,{name:"Program",value:(y=(C=t==null?void 0:t.resources)==null?void 0:C.program)!=null?y:0}),s(g,{name:"Query",value:(M=(b=t==null?void 0:t.resources)==null?void 0:b.query)!=null?M:0}),s(g,{name:"Sampler",value:(T=(k=t==null?void 0:t.resources)==null?void 0:k.sampler)!=null?T:0}),s(g,{name:"Shader",value:(S=(z=t==null?void 0:t.resources)==null?void 0:z.shader)!=null?S:0}),s(g,{name:"Sync",value:(V=(J=t==null?void 0:t.resources)==null?void 0:J.sync)!=null?V:0}),s(g,{name:"Texture",value:(U=(G=t==null?void 0:t.resources)==null?void 0:G.texture)!=null?U:0}),s(g,{name:"Transform Feedback",value:(le=(ae=t==null?void 0:t.resources)==null?void 0:ae.transformFeedback)!=null?le:0}),s(g,{name:"Vertex Array",value:(de=(ce=t==null?void 0:t.resources)==null?void 0:ce.vertexArray)!=null?de:0})]})}))},oo=()=>{const[o,e]=c.exports.useState(["jsonTree","materialDebugger","meta","stats","webglMemory","blendShape","lookAt","validationReport","sampleModels","helpers","exportBufferView","mixamoAnimations","postProcessing","jsEditor","about"]),t=c.exports.useCallback((A,l)=>{const a=o.concat();a.splice(o.indexOf(l),1),a.push(l),e(a)},[o]);let n=0;const r=()=>{const A=0,l=n;return n+=20,{left:A,top:l}},i={jsonTree:s(_n,{paneKey:"jsonTree",title:"JSON Tree",onClick:t,initPosition:r()},"jsonTree"),materialDebugger:s(Sn,{paneKey:"materialDebugger",title:"MToon Material Debugger",onClick:t,initPosition:r()},"materialDebugger"),meta:s(Tn,{paneKey:"meta",title:"Meta",onClick:t,initPosition:r()},"meta"),stats:s(qn,{paneKey:"stats",title:"Stats",onClick:t,initPosition:r()},"stats"),webglMemory:s(no,{paneKey:"webglMemory",title:"WebGL Memory",onClick:t,initPosition:r()},"webglMemory"),blendShape:s(Rn,{paneKey:"blendShape",title:"Blend Shape Proxy",onClick:t,initPosition:r()},"blendShape"),lookAt:s(zn,{paneKey:"lookAt",title:"Look At",onClick:t,initPosition:r()},"lookAt"),validationReport:s(to,{paneKey:"validationReport",title:"Validation Report",onClick:t,initPosition:r()},"validationReport"),sampleModels:s(Xn,{paneKey:"sampleModels",title:"Sample Models",onClick:t,initPosition:r()},"sampleModels"),helpers:s(yn,{paneKey:"helpers",title:"Helpers",onClick:t,initPosition:r()},"helpers"),exportBufferView:s(Mn,{paneKey:"exportBufferView",title:"Export Buffer View",onClick:t,initPosition:r()},"exportBufferView"),mixamoAnimations:s(Wn,{paneKey:"mixamoAnimations",title:"Mixamo Animations",onClick:t,initPosition:r()},"mixamoAnimations"),postProcessing:s(Zn,{paneKey:"postProcessing",title:"Post Processing",onClick:t,initPosition:r()},"postProcessing"),jsEditor:s(Ln,{paneKey:"jsEditor",title:"JavaScript Editor",onClick:t,initPosition:r()},"jsEditor"),about:s(wn,{paneKey:"about",title:"About",onClick:t,initPosition:r()},"about")};return s(_,{children:o.map(A=>i[A])})},so=()=>{const{inspector:o}=c.exports.useContext(P),[e,t]=c.exports.useState(null);c.exports.useEffect(()=>{const r=()=>{t(null)},i=A=>{t(A)};return o.on("load",r),o.on("progress",i),()=>{o.off("load",r),o.off("progress",i)}});const n=c.exports.useMemo(()=>e?e.loaded/e.total:null,[e]);return s(_,{children:s("div",{className:"w-full h-full absolute text-center pointer-events-none",children:s("div",{children:n?(100*n).toFixed(2):"yay"})})})},ro=()=>{const{inspector:o}=c.exports.useContext(P),e=c.exports.useCallback(t=>{t&&o.setup(t)},[]);return s(_,{children:R("div",{className:"w-full h-full text-sm absolute overflow-hidden text-gray-100",children:[s("canvas",{ref:e,className:"w-full h-full absolute"}),s(oo,{}),s(so,{})]})})},io=()=>s(_,{children:s(ro,{})});Pt.render(s(we.StrictMode,{children:s(io,{})}),document.getElementById("root"));
